(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,r)=>{t.exports=e.r(76562)},72547,79724,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(22016);function n(e,t=!0){let a=(0,r.useRef)(null);return(0,r.useEffect)(()=>{if(!t)return;let r=t=>{a.current&&!a.current.contains(t.target)&&e()},n=t=>{"Escape"===t.key&&e()};return document.addEventListener("mousedown",r),document.addEventListener("touchstart",r),document.addEventListener("keydown",n),()=>{document.removeEventListener("mousedown",r),document.removeEventListener("touchstart",r),document.removeEventListener("keydown",n)}},[e,t]),a}function s({items:e,trigger:s,align:l="right",className:i="",label:o="More options"}){let[c,d]=(0,r.useState)(!1),u=n((0,r.useCallback)(()=>{d(!1)},[]),c),h=e=>{e.disabled||(e.onClick?.(),d(!1))};return 0===e.length?null:(0,t.jsxs)("div",{ref:u,className:`relative ${i}`,children:[(0,t.jsx)("button",{onClick:()=>{d(!c)},className:"touch-target flex items-center justify-center p-2 text-gray-400 hover:text-retro-cyan transition-colors rounded-md hover:bg-retro-purple/30","aria-label":o,"aria-expanded":c,"aria-haspopup":"menu",children:s||(0,t.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})})}),c&&(0,t.jsx)("div",{className:`absolute top-full mt-2 z-50 min-w-[180px] bg-retro-navy/95 backdrop-blur-md border border-retro-grid/50 rounded-lg py-1 shadow-xl shadow-black/50 ${"right"===l?"right-0":"left-0"}`,role:"menu","aria-orientation":"vertical",children:e.map(e=>{let r=`
              w-full flex items-center gap-3 px-4 py-3 text-sm text-left
              transition-colors touch-target
              ${e.disabled?"text-gray-500 cursor-not-allowed":"danger"===e.variant?"text-red-400 hover:bg-red-500/20 hover:text-red-300":"text-gray-200 hover:bg-retro-purple/40 hover:text-retro-cyan"}
            `;return e.href&&!e.disabled?(0,t.jsxs)(a.default,{href:e.href,className:r,role:"menuitem",onClick:()=>d(!1),children:[e.icon&&(0,t.jsx)("span",{className:"w-5 h-5 flex-shrink-0",children:e.icon}),(0,t.jsx)("span",{children:e.label})]},e.id):(0,t.jsxs)("button",{className:r,role:"menuitem",disabled:e.disabled,onClick:()=>h(e),onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),h(e))},children:[e.icon&&(0,t.jsx)("span",{className:"w-5 h-5 flex-shrink-0",children:e.icon}),(0,t.jsx)("span",{children:e.label})]},e.id)})})]})}e.s(["useOutsideClick",()=>n],79724),e.s(["OverflowMenu",()=>s],72547)},16015,(e,t,r)=>{},98547,(e,t,r)=>{var a=e.i(47167);e.r(16015);var n=e.r(71645),s=n&&"object"==typeof n&&"default"in n?n:{default:n},l=void 0!==a.default&&a.default.env&&!0,i=function(e){return"[object String]"===Object.prototype.toString.call(e)},o=function(){function e(e){var t=void 0===e?{}:e,r=t.name,a=void 0===r?"stylesheet":r,n=t.optimizeForSpeed,s=void 0===n?l:n;c(i(a),"`name` must be a string"),this._name=a,this._deletedRulePlaceholder="#"+a+"-deleted-rule____{}",c("boolean"==typeof s,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=s,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var o="undefined"!=typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=o?o.getAttribute("content"):null}var t,r=e.prototype;return r.setOptimizeForSpeed=function(e){c("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),c(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},r.isOptimizeForSpeed=function(){return this._optimizeForSpeed},r.inject=function(){var e=this;if(c(!this._injected,"sheet already injected"),this._injected=!0,"undefined"!=typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(l||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,r){return"number"==typeof r?e._serverSheet.cssRules[r]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),r},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},r.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},r.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},r.insertRule=function(e,t){if(c(i(e),"`insertRule` accepts only strings"),"undefined"==typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var r=this.getSheet();"number"!=typeof t&&(t=r.cssRules.length);try{r.insertRule(e,t)}catch(t){return l||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var a=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,a))}return this._rulesCount++},r.replaceRule=function(e,t){if(this._optimizeForSpeed||"undefined"==typeof window){var r="undefined"!=typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!r.cssRules[e])return e;r.deleteRule(e);try{r.insertRule(t,e)}catch(a){l||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),r.insertRule(this._deletedRulePlaceholder,e)}}else{var a=this._tags[e];c(a,"old rule at index `"+e+"` not found"),a.textContent=t}return e},r.deleteRule=function(e){if("undefined"==typeof window)return void this._serverSheet.deleteRule(e);if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];c(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},r.flush=function(){this._injected=!1,this._rulesCount=0,"undefined"!=typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},r.cssRules=function(){var e=this;return"undefined"==typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,r){return r?t=t.concat(Array.prototype.map.call(e.getSheetForTag(r).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},r.makeStyleTag=function(e,t,r){t&&c(i(t),"makeStyleTag accepts only strings as second parameter");var a=document.createElement("style");this._nonce&&a.setAttribute("nonce",this._nonce),a.type="text/css",a.setAttribute("data-"+e,""),t&&a.appendChild(document.createTextNode(t));var n=document.head||document.getElementsByTagName("head")[0];return r?n.insertBefore(a,r):n.appendChild(a),a},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(e.prototype,t),e}();function c(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var d=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return t>>>0},u={};function h(e,t){if(!t)return"jsx-"+e;var r=String(t),a=e+r;return u[a]||(u[a]="jsx-"+d(e+"-"+r)),u[a]}function x(e,t){"undefined"==typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var r=e+t;return u[r]||(u[r]=t.replace(/__jsx-style-dynamic-selector/g,e)),u[r]}var m=function(){function e(e){var t=void 0===e?{}:e,r=t.styleSheet,a=void 0===r?null:r,n=t.optimizeForSpeed,s=void 0!==n&&n;this._sheet=a||new o({name:"styled-jsx",optimizeForSpeed:s}),this._sheet.inject(),a&&"boolean"==typeof s&&(this._sheet.setOptimizeForSpeed(s),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"undefined"==typeof window||this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var r=this.getIdAndRules(e),a=r.styleId,n=r.rules;if(a in this._instancesCounts){this._instancesCounts[a]+=1;return}var s=n.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[a]=s,this._instancesCounts[a]=1},t.remove=function(e){var t=this,r=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(r in this._instancesCounts,"styleId: `"+r+"` not found"),this._instancesCounts[r]-=1,this._instancesCounts[r]<1){var a=this._fromServer&&this._fromServer[r];a?(a.parentNode.removeChild(a),delete this._fromServer[r]):(this._indices[r].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[r]),delete this._instancesCounts[r]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],r=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return r[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,r;return t=this.cssRules(),void 0===(r=e)&&(r={}),t.map(function(e){var t=e[0],a=e[1];return s.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:r.nonce?r.nonce:void 0,dangerouslySetInnerHTML:{__html:a}})})},t.getIdAndRules=function(e){var t=e.children,r=e.dynamic,a=e.id;if(r){var n=h(a,r);return{styleId:n,rules:Array.isArray(t)?t.map(function(e){return x(n,e)}):[x(n,t)]}}return{styleId:h(a),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),f=n.createContext(null);function p(){return new m}function g(){return n.useContext(f)}f.displayName="StyleSheetContext";var b=s.default.useInsertionEffect||s.default.useLayoutEffect,y="undefined"!=typeof window?p():void 0;function v(e){var t=y||g();return t&&("undefined"==typeof window?t.add(e):b(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}v.dynamic=function(e){return e.map(function(e){return h(e[0],e[1])}).join(" ")},r.StyleRegistry=function(e){var t=e.registry,r=e.children,a=n.useContext(f),l=n.useState(function(){return a||t||p()})[0];return s.default.createElement(f.Provider,{value:l},r)},r.createStyleRegistry=p,r.style=v,r.useStyleRegistry=g},37902,(e,t,r)=>{t.exports=e.r(98547).style},89043,49738,7506,32267,29493,e=>{"use strict";var t=e.i(43476),r=e.i(71645);function a({pixels:e,scale:a=1,showGrid:n=!1,gridColor:s="#333333",gridThickness:l=1,foregroundColor:i="#ffffff",backgroundColor:o="#000000",onPixelClick:c,onPixelDrag:d,onDragEnd:u,onPixelHover:h,onPixelLeave:x,className:m="",interactive:f=!0,mixedPixels:p,mixedColor:g="#666666"}){let b=(0,r.useRef)(null),[y,v]=(0,r.useState)(!1),w=(0,r.useRef)(null),j=e.length,C=e[0]?.length||0,k=n?l:0,N=C*a+(n?(C+1)*l:0),S=j*a+(n?(j+1)*l:0);(0,r.useEffect)(()=>{let t=b.current;if(!t)return;let r=t.getContext("2d");if(r){r.fillStyle=n?s:o,r.fillRect(0,0,N,S);for(let t=0;t<j;t++)for(let s=0;s<C;s++){let c=n?s*(a+l)+l:s*a,d=n?t*(a+l)+l:t*a,u=`${t},${s}`,h=p?.has(u),x=e[t]?.[s]||!1;if(h){let e=Math.floor(a/2);r.fillStyle=i,r.fillRect(c,d,e,e),r.fillRect(c+e,d+e,a-e,a-e),r.fillStyle=o,r.fillRect(c+e,d,a-e,e),r.fillRect(c,d+e,e,a-e)}else r.fillStyle=x?i:o,r.fillRect(c,d,a,a)}}},[e,a,n,s,l,i,o,N,S,C,j,p,g]);let M=(0,r.useCallback)(e=>{let t,r,s=b.current;if(!s)return null;let i=s.getBoundingClientRect();if("touches"in e){if(0===e.touches.length)return null;t=e.touches[0].clientX,r=e.touches[0].clientY}else t=e.clientX,r=e.clientY;let o=t-i.left,c=r-i.top,d=s.width/i.width,u=s.height/i.height,h=a+(n?l:0),x=Math.floor((o*d-k)/h),m=Math.floor((c*u-k)/h);return m>=0&&m<j&&x>=0&&x<C?{row:m,col:x}:null},[a,n,l,k,j,C]),R=(0,r.useCallback)(e=>{if(!f)return;2===e.button&&e.preventDefault();let t=M(e);t&&c&&(c(t.row,t.col,2===e.button),w.current=t,v(!0))},[f,M,c]),L=(0,r.useCallback)(e=>{f&&e.preventDefault()},[f]),E=(0,r.useCallback)(e=>{if(!f)return;let t=M(e);t&&h&&h(t.row,t.col),y&&d&&t&&(!w.current||w.current.row!==t.row||w.current.col!==t.col)&&(d(t.row,t.col),w.current=t)},[f,y,M,d,h]),A=(0,r.useCallback)(()=>{y&&(v(!1),w.current=null,u?.())},[y,u]),D=(0,r.useCallback)(()=>{y&&(v(!1),w.current=null,u?.()),x?.()},[y,u,x]),I=(0,r.useCallback)(e=>{if(!f)return;e.preventDefault();let t=M(e);t&&c&&(c(t.row,t.col),w.current=t,v(!0))},[f,M,c]),z=(0,r.useCallback)(e=>{if(!f||!y||!d)return;e.preventDefault();let t=M(e);t&&(!w.current||w.current.row!==t.row||w.current.col!==t.col)&&(d(t.row,t.col),w.current=t)},[f,y,M,d]),B=(0,r.useCallback)(()=>{y&&(v(!1),w.current=null,u?.())},[y,u]);return(0,t.jsx)("canvas",{ref:b,width:N,height:S,className:`${f?"cursor-crosshair":""} ${m}`,style:{imageRendering:"pixelated",touchAction:"none"},onMouseDown:R,onMouseMove:E,onMouseUp:A,onMouseLeave:D,onContextMenu:L,onTouchStart:I,onTouchMove:z,onTouchEnd:B})}function n({character:e,mode:n="small",scale:s=20,smallScale:l=2,selected:i=!1,batchSelected:o=!1,onClick:c,onPixelClick:d,onPixelDrag:u,onDragEnd:h,onPixelHover:x,onPixelLeave:m,foregroundColor:f="#ffffff",backgroundColor:p="#000000",gridColor:g="#333333",gridThickness:b=1,interactive:y=!0,className:v="",mixedPixels:w,index:j,showIndex:C=!1}){let k="large"===n,N=k?s:l,S=["relative inline-block",!k&&y?"cursor-pointer":"",!k&&y?"hover:opacity-80 transition-opacity":"",(0,r.useMemo)(()=>i?"ring-2 ring-retro-cyan ring-offset-2 ring-offset-retro-dark":o?"ring-2 ring-retro-pink/50 ring-offset-1 ring-offset-retro-dark":"",[i,o]),v].filter(Boolean).join(" ");return(0,t.jsxs)("div",{className:S,onClick:e=>{c&&!k&&(e.stopPropagation(),c())},onKeyDown:e=>{c&&!k&&("Enter"===e.key||" "===e.key)&&(e.preventDefault(),c())},role:!k&&y?"button":void 0,tabIndex:!k&&y?0:void 0,"aria-pressed":i||o,"aria-label":void 0!==j?`Character ${j}`:"Character",children:[(0,t.jsx)(a,{pixels:e.pixels,scale:N,showGrid:k,gridColor:g,gridThickness:k?b:0,foregroundColor:f,backgroundColor:p,onPixelClick:k?d:void 0,onPixelDrag:k?u:void 0,onDragEnd:k?h:void 0,onPixelHover:k?x:void 0,onPixelLeave:k?m:void 0,interactive:k&&y,mixedPixels:w}),C&&void 0!==j&&(0,t.jsx)("div",{className:"absolute -top-1 -right-1 bg-retro-navy/90 text-[8px] text-gray-400 px-1 rounded font-mono",children:j})]})}function s({width:e,height:r,mode:a="small",scale:n=20,smallScale:s=2,onClick:l,className:i=""}){let o="large"===a,c=o?n:s;return(0,t.jsx)("div",{className:`relative inline-flex items-center justify-center bg-retro-navy/50 border border-dashed border-retro-grid/50 cursor-pointer hover:border-retro-cyan/50 transition-colors ${i}`,style:{width:e*c+(o?(e+1)*1:0),height:r*c+(o?(r+1)*1:0)},onClick:l,role:"button",tabIndex:0,onKeyDown:e=>{l&&("Enter"===e.key||" "===e.key)&&(e.preventDefault(),l())},"aria-label":"Add new character",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})}function l(e){let t=(0,r.useRef)(null),[a,n]=(0,r.useState)({width:0,height:0}),s=(0,r.useCallback)(t=>{for(let r of t){let{width:t,height:a}=r.contentRect,s={width:t,height:a};n(s),e?.(s)}},[e]);return(0,r.useEffect)(()=>{let e=t.current;if(!e)return;let r=new ResizeObserver(s);r.observe(e);let a=e.getBoundingClientRect();return n({width:a.width,height:a.height}),()=>{r.disconnect()}},[s]),{ref:t,size:a}}function i({characters:e,config:r,maxCharacters:a=16,foregroundColor:s="#ffffff",backgroundColor:l="#000000",smallScale:i=1,className:o=""}){let c=e.slice(0,a),d=e.length-a,u=Math.ceil(Math.sqrt(a)),h=r.width*i;return(0,t.jsxs)("div",{className:`relative ${o}`,children:[(0,t.jsx)("div",{className:"grid gap-0.5",style:{gridTemplateColumns:`repeat(${u}, ${h}px)`},children:c.map((e,r)=>(0,t.jsx)(n,{character:e,mode:"small",smallScale:i,foregroundColor:s,backgroundColor:l,interactive:!1},r))}),d>0&&(0,t.jsxs)("div",{className:"absolute bottom-0 right-0 bg-retro-navy/90 text-[10px] text-gray-400 px-1 rounded",children:["+",d]})]})}function o({characters:e,config:a,selectedIndex:i,batchSelection:o,onSelect:c,showAddButton:d=!1,onAdd:u,foregroundColor:h="#ffffff",backgroundColor:x="#000000",showIndices:m=!1,minColumns:f=8,maxColumns:p=32,gap:g=4,className:b="",smallScale:y=2,onContextMenu:v}){let w=(0,r.useRef)(null),{size:j}=l(),C=a.width*y,k=(0,r.useMemo)(()=>{if(!j.width)return f;let e=C+g+8;return Math.max(f,Math.min(p,Math.floor((j.width-g)/e)))},[j.width,C,g,f,p]);return(0,t.jsx)("div",{ref:w,className:`overflow-auto p-2 ${b}`,role:"listbox","aria-label":"Character selection grid",children:(0,t.jsxs)("div",{className:"grid",style:{gridTemplateColumns:`repeat(${k}, auto)`,gap:`${g}px`},children:[e.map((e,r)=>(0,t.jsx)("div",{onClick:e=>c?.(r,e.shiftKey,e.metaKey||e.ctrlKey),onContextMenu:e=>{v&&(e.preventDefault(),i===r||o?.has(r)||c?.(r,!1,!1),v(e.clientX,e.clientY,r))},onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),c?.(r,e.shiftKey,e.metaKey||e.ctrlKey))},role:"option","aria-selected":i===r||o?.has(r),tabIndex:0,className:"focus:outline-none focus-visible:ring-1 focus-visible:ring-retro-cyan rounded",children:(0,t.jsx)(n,{character:e,mode:"small",smallScale:y,selected:i===r,batchSelected:o?.has(r)&&i!==r,foregroundColor:h,backgroundColor:x,interactive:!1,index:r,showIndex:m})},r)),d&&(0,t.jsx)(s,{width:a.width,height:a.height,mode:"small",smallScale:y,onClick:u})]})})}function c({characters:e,config:n,maxCharacters:s=32,maxWidth:l=128,maxHeight:i=64,scale:o=1,foregroundColor:c="#ffffff",backgroundColor:d="#000000",className:u="",forceColumns:h,showCharacterBorders:x=!1,characterBorderColor:m="rgba(100, 100, 100, 0.5)"}){let{displayChars:f,columns:p,rows:g}=(0,r.useMemo)(()=>{let t=n.width*o,r=n.height*o;if(h){let t=Math.min(s,e.length),r=Math.ceil(t/h),a=Math.min(h*r,t);return{displayChars:e.slice(0,a),columns:h,rows:r}}let a=Math.floor(l/t),c=Math.floor(i/r),d=[64,32,16,8,4].find(e=>e<=a)||Math.min(a,4);d=Math.max(d,1);let u=Math.min(s,e.length),x=Math.ceil(u/d);if(x>c){let t=Math.ceil(u/(d=a)),r=Math.min(d*Math.min(t,c),u);return{displayChars:e.slice(0,r),columns:d,rows:Math.min(t,c)}}return{displayChars:e.slice(0,u),columns:d,rows:x}},[e,n,s,l,i,h,o]),b=(0,r.useMemo)(()=>{let{width:e,height:t}=n,r=p*e,a=Array.from({length:g*t},()=>Array(r).fill(!1));return f.forEach((r,n)=>{let s=n%p*e,l=Math.floor(n/p)*t;for(let n=0;n<t;n++)for(let t=0;t<e;t++)r.pixels[n]?.[t]&&(a[l+n][s+t]=!0)}),a},[f,n,p,g]),y=e.length-f.length,v=n.width*o,w=n.height*o;return(0,t.jsxs)("div",{className:`relative inline-block ${u}`,children:[(0,t.jsx)(a,{pixels:b,scale:o,showGrid:!1,foregroundColor:c,backgroundColor:d,interactive:!1}),x&&p>0&&g>0&&(0,t.jsx)("div",{className:"absolute inset-0 pointer-events-none",style:{display:"grid",gridTemplateColumns:`repeat(${p}, ${v}px)`,gridTemplateRows:`repeat(${g}, ${w}px)`},children:f.map((e,r)=>(0,t.jsx)("div",{style:{border:`1px solid ${m}`,boxSizing:"border-box"}},r))}),y>0&&(0,t.jsxs)("div",{className:"absolute bottom-0 right-0 bg-retro-dark/90 text-[9px] text-gray-400 px-1 rounded-tl font-mono",children:["+",y]})]})}e.s(["PixelGrid",()=>a],89043),e.s(["CharacterDisplay",()=>n,"EmptyCharacterDisplay",()=>s],49738),e.i(37902),e.s(["useResizeObserver",()=>l],7506),e.s(["CharacterPreviewGrid",()=>i,"InteractiveCharacterGrid",()=>o],32267),e.s(["CharacterPreview",()=>c],29493)},38794,33712,38152,92921,4941,93949,25544,47509,33140,88734,1978,73581,60441,59160,42187,82906,95879,87355,45835,93585,43237,20371,99401,87188,16244,46628,24111,38910,96935,56859,4246,45497,66811,83621,54750,69771,7259,78071,35052,55361,48026,64721,53444,1164,e=>{"use strict";let t;var r,a,n,s,l,i,o,c,d,u,h,x,m,f,p,g,b,y,v,w=e.i(43476),j=e.i(71645),C=e.i(29493),k=e.i(72547);function N(e){return Math.ceil(e/8)}function S(e){return N(e.width)*e.height}function M(e){let t=e.binaryData,r=0;t.endsWith("==")?r=2:t.endsWith("=")&&(r=1);let a=3*t.length/4-r,n=S(e.config);return n>0?Math.floor(a/n):0}function R(e,t){let r=[];for(let a=0;a<t;a++)r.push(Array(e).fill(!1));return{pixels:r}}function L(e){return{pixels:e.pixels.map(e=>[...e])}}function E(){return{width:8,height:8,padding:"right",bitDirection:"ltr"}}function A(){return crypto.randomUUID()}function D(e,t){let{width:r,height:a,padding:n,bitDirection:s}=t,l=N(r),i=new Uint8Array(a*l);for(let t=0;t<a;t++){let a=8*l,o=a-r,c=Array(a).fill(!1);if("left"===n)for(let a=0;a<r;a++)c[o+a]=e.pixels[t]?.[a]||!1;else for(let a=0;a<r;a++)c[a]=e.pixels[t]?.[a]||!1;for(let e=0;e<l;e++){let r=0;for(let t=0;t<8;t++)c[8*e+t]&&(r|=1<<("ltr"===s?7-t:t));i[t*l+e]=r}}return i}function I(e,t){let r=e instanceof Uint8Array?e:new Uint8Array(e),a=S(t),n=Math.floor(r.length/a),s=[];for(let e=0;e<n;e++){let n=r.slice(e*a,(e+1)*a);s.push(function(e,t){let{width:r,height:a,padding:n,bitDirection:s}=t,l=N(r),i=[];for(let t=0;t<a;t++){let a=[],o=t*l,c=[];for(let t=0;t<l;t++){let r=e[o+t]||0;for(let e=0;e<8;e++){let t=(r&1<<("ltr"===s?7-e:e))!=0;c.push(t)}}let d=8*l,u=d-r;if("left"===n)for(let e=u;e<d;e++)a.push(c[e]);else for(let e=0;e<r;e++)a.push(c[e]);i.push(a)}return{pixels:i}}(n,t))}return s}function z(e,t){let r=S(t),a=new Uint8Array(e.length*r);for(let n=0;n<e.length;n++){let s=D(e[n],t);a.set(s,n*r)}return a}function B(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function O(e){let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}function F(e){let t=z(e.characters,e.config);return{metadata:e.metadata,config:e.config,binaryData:B(t)}}function T(e){let t=I(O(e.binaryData),e.config);return{metadata:e.metadata,config:e.config,characters:t}}function $(e,t,r){return new Blob([z(e,{...t,...r}).buffer],{type:"application/octet-stream"})}function P(e,t){let r=URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}function W(e){return e<1024?`${e} B`:e<1048576?`${(e/1024).toFixed(1)} KB`:`${(e/1048576).toFixed(1)} MB`}function _(e){return`${e.width}x${e.height}`}function U(e){let t=e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");return`${t||"charset"}.bin`}function H(e){let t=e.name.toLowerCase().substring(e.name.lastIndexOf("."));return[".bin",".rom",".chr",".fnt",".dat"].includes(t)||!t||t===e.name.toLowerCase()}function K(e,t){return Math.floor(e/(Math.ceil(t.width/8)*t.height))}function V(e){let t=new Date(e),r=Math.floor((new Date().getTime()-e)/864e5);return 0===r?"Today":1===r?"Yesterday":r<7?`${r} days ago`:t.toLocaleDateString()}function G({characterSet:e,onEdit:t,onExport:r,onDelete:a,onDuplicate:n,onRename:s,onTogglePinned:l}){let{metadata:i,config:o}=e,c=(0,j.useMemo)(()=>{try{return T(e).characters}catch{return[]}},[e]),d=c.length,u=e=>new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}),h=(0,j.useMemo)(()=>{let e=[];return l&&e.push({id:"pin",label:i.isPinned?"Unpin":"Pin to top",onClick:l}),t&&e.push({id:"edit",label:"Edit",onClick:t}),s&&!i.isBuiltIn&&e.push({id:"rename",label:"Rename",onClick:s}),r&&e.push({id:"export",label:"Export",onClick:r}),n&&e.push({id:"duplicate",label:"Duplicate",onClick:n}),a&&!i.isBuiltIn&&e.push({id:"delete",label:"Delete",onClick:a,variant:"danger"}),e},[t,s,r,n,a,l,i.isBuiltIn,i.isPinned]);return(0,w.jsxs)("div",{className:`card-retro p-4 flex flex-col gap-3 hover-glow-cyan transition-all h-full relative has-[[aria-expanded=true]]:z-50 ${i.isPinned?"ring-1 ring-retro-yellow/50":""}`,children:[(0,w.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,w.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,w.jsxs)("h3",{className:"text-sm font-semibold text-retro-cyan truncate flex items-center gap-1.5",children:[i.isPinned&&(0,w.jsx)("svg",{className:"w-3.5 h-3.5 text-retro-yellow flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{d:"M16 12V4h1V2H7v2h1v8l-2 2v2h5.2v6h1.6v-6H18v-2l-2-2z"})}),i.name]}),(i.manufacturer||i.system||i.chip||i.locale)&&(0,w.jsxs)("p",{className:"text-[10px] text-gray-500 mt-0.5",children:[i.manufacturer,i.manufacturer&&i.system?" ":"",i.system,i.chip&&(i.manufacturer||i.system)?" · ":"",i.chip,i.locale&&(i.manufacturer||i.system||i.chip)?" · ":"",i.locale]}),i.description&&(0,w.jsx)("p",{className:"text-xs text-gray-400 line-clamp-2 mt-0.5",children:i.description})]}),(0,w.jsx)("div",{className:"flex-shrink-0",children:h.length>0&&(0,w.jsx)(k.OverflowMenu,{items:h,align:"right",label:"Character set actions"})})]}),(0,w.jsx)("div",{className:"flex justify-center py-2 bg-black/30 rounded",children:(0,w.jsx)(C.CharacterPreview,{characters:c,config:o,maxCharacters:512,maxWidth:256,maxHeight:4096})}),(0,w.jsxs)("div",{className:"flex flex-col gap-2 pt-2 border-t border-retro-grid/30 text-[10px] mt-auto",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)("span",{className:"px-1.5 py-0.5 bg-retro-purple/30 text-retro-pink rounded",children:_(o)}),(0,w.jsxs)("span",{className:"text-gray-500",children:[d," char",1!==d?"s":""]}),i.isBuiltIn&&(0,w.jsx)("span",{className:"px-1.5 py-0.5 bg-retro-navy text-gray-400 rounded",children:"Built-in"})]}),t&&(0,w.jsx)("button",{onClick:t,className:"px-2 py-1 text-xs bg-retro-cyan/20 text-retro-cyan rounded hover:bg-retro-cyan/30 transition-colors",children:"Edit"})]}),(0,w.jsxs)("div",{className:"flex items-center gap-3 text-gray-500",children:[(0,w.jsxs)("span",{title:"Date created",children:[(0,w.jsx)("span",{className:"text-[8px] text-gray-600",children:"Created:"})," ",u(i.createdAt)]}),(0,w.jsxs)("span",{title:"Date modified",children:[(0,w.jsx)("span",{className:"text-[8px] text-gray-600",children:"Modified:"})," ",u(i.updatedAt)]})]})]})]})}function X({characterSet:e,selected:t=!1,onClick:r}){let{metadata:a,config:n}=e,s=(0,j.useMemo)(()=>{try{return T(e).characters}catch{return[]}},[e]);return(0,w.jsx)("button",{onClick:r,className:`
        w-full p-3 rounded border text-left transition-all
        ${t?"border-retro-cyan bg-retro-cyan/10":"border-retro-grid/30 bg-retro-navy/30 hover:border-retro-grid/50"}
      `,children:(0,w.jsxs)("div",{className:"flex items-center gap-3",children:[(0,w.jsx)("div",{className:"flex-shrink-0 bg-black/30 p-1 rounded",children:(0,w.jsx)(C.CharacterPreview,{characters:s,config:n,maxCharacters:8,maxWidth:48,maxHeight:24})}),(0,w.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,w.jsx)("div",{className:"text-sm font-medium text-gray-200 truncate",children:a.name}),(0,w.jsxs)("div",{className:"text-[10px] text-gray-500",children:[_(n)," - ",s.length," chars"]})]}),t&&(0,w.jsx)("svg",{className:"w-4 h-4 text-retro-cyan flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})})]})})}function q({onImport:e,onCreate:t}){return(0,w.jsxs)("div",{className:"card-retro p-6 flex flex-col items-center justify-center gap-4 border-dashed",children:[(0,w.jsx)("div",{className:"w-12 h-12 rounded-full bg-retro-cyan/20 flex items-center justify-center",children:(0,w.jsx)("svg",{className:"w-6 h-6 text-retro-cyan",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),(0,w.jsxs)("div",{className:"text-center",children:[(0,w.jsx)("p",{className:"text-sm text-gray-300",children:"Add a character set"}),(0,w.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Import a ROM file or create from scratch"})]}),(0,w.jsxs)("div",{className:"flex gap-2",children:[t&&(0,w.jsxs)("button",{onClick:t,className:"px-3 py-1.5 text-xs bg-retro-pink/20 text-retro-pink rounded hover:bg-retro-pink/30 transition-colors flex items-center gap-1",children:[(0,w.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add"]}),e&&(0,w.jsxs)("button",{onClick:e,className:"px-3 py-1.5 text-xs bg-retro-cyan/20 text-retro-cyan rounded hover:bg-retro-cyan/30 transition-colors flex items-center gap-1",children:[(0,w.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Import"]})]})]})}function Y({characterSets:e,loading:t=!1,onEdit:r,onExport:a,onDelete:n,onDuplicate:s,onRename:l,onTogglePinned:i,onImport:o,onCreate:c,className:d=""}){return t?(0,w.jsx)("div",{className:`grid-fluid gap-4 ${d}`,children:Array.from({length:4}).map((e,t)=>(0,w.jsx)(J,{},t))}):0===e.length?(0,w.jsx)("div",{className:`flex flex-col items-center justify-center py-12 ${d}`,children:(0,w.jsx)(q,{onImport:o,onCreate:c})}):(0,w.jsx)("div",{className:`grid-fluid gap-4 ${d}`,children:e.map(e=>(0,w.jsx)(G,{characterSet:e,onEdit:r?()=>r(e.metadata.id):void 0,onExport:a?()=>a(e.metadata.id):void 0,onDelete:n?()=>n(e.metadata.id):void 0,onDuplicate:s?()=>s(e.metadata.id):void 0,onRename:l?()=>l(e.metadata.id):void 0,onTogglePinned:i?()=>i(e.metadata.id):void 0},e.metadata.id))})}function J(){return(0,w.jsxs)("div",{className:"card-retro p-4 animate-pulse",children:[(0,w.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-3",children:[(0,w.jsxs)("div",{className:"flex-1",children:[(0,w.jsx)("div",{className:"h-4 bg-retro-grid/30 rounded w-3/4"}),(0,w.jsx)("div",{className:"h-3 bg-retro-grid/20 rounded w-full mt-2"})]}),(0,w.jsx)("div",{className:"w-6 h-6 bg-retro-grid/20 rounded"})]}),(0,w.jsx)("div",{className:"h-16 bg-black/30 rounded mb-3"}),(0,w.jsxs)("div",{className:"flex gap-2 mb-3",children:[(0,w.jsx)("div",{className:"h-4 w-12 bg-retro-grid/20 rounded"}),(0,w.jsx)("div",{className:"h-4 w-16 bg-retro-grid/20 rounded"})]}),(0,w.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-retro-grid/30",children:[(0,w.jsx)("div",{className:"h-3 w-20 bg-retro-grid/20 rounded"}),(0,w.jsxs)("div",{className:"flex gap-1",children:[(0,w.jsx)("div",{className:"h-6 w-12 bg-retro-grid/20 rounded"}),(0,w.jsx)("div",{className:"h-6 w-14 bg-retro-grid/20 rounded"})]})]})]})}function Z({onClearFilters:e}){return(0,w.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,w.jsx)("div",{className:"w-16 h-16 rounded-full bg-retro-navy/50 flex items-center justify-center mb-4",children:(0,w.jsx)("svg",{className:"w-8 h-8 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,w.jsx)("h3",{className:"text-lg font-medium text-gray-300 mb-2",children:"No results found"}),(0,w.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"Try adjusting your search or filters"}),e&&(0,w.jsx)("button",{onClick:e,className:"px-4 py-2 text-sm bg-retro-cyan/20 text-retro-cyan rounded hover:bg-retro-cyan/30 transition-colors",children:"Clear all filters"})]})}function Q({error:e,onRetry:t}){return(0,w.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,w.jsx)("div",{className:"w-16 h-16 rounded-full bg-red-500/10 flex items-center justify-center mb-4",children:(0,w.jsx)("svg",{className:"w-8 h-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,w.jsx)("h3",{className:"text-lg font-medium text-red-400 mb-2",children:"Failed to load library"}),(0,w.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:e}),t&&(0,w.jsx)("button",{onClick:t,className:"px-4 py-2 text-sm bg-retro-cyan/20 text-retro-cyan rounded hover:bg-retro-cyan/30 transition-colors",children:"Try again"})]})}e.s(["bytesPerCharacter",()=>S,"bytesPerLine",()=>N,"cloneCharacter",()=>L,"createDefaultConfig",()=>E,"createEmptyCharacter",()=>R,"generateId",()=>A,"getCharacterCount",()=>M],33712),e.s(["base64ToBinary",()=>O,"binaryToBase64",()=>B,"characterToBytes",()=>D,"createDownloadBlob",()=>$,"deserializeCharacterSet",()=>T,"downloadBlob",()=>P,"parseCharacterRom",()=>I,"serializeCharacterRom",()=>z,"serializeCharacterSet",()=>F],38152),e.s(["calculateCharacterCount",()=>K,"formatFileSize",()=>W,"formatSize",()=>_,"formatTimestamp",()=>V,"getSuggestedFilename",()=>U,"isValidBinaryFile",()=>H],92921),e.s(["LibraryCard",()=>G,"LibraryCardCompact",()=>X,"LibraryCardEmpty",()=>q],38794),e.s(["LibraryGrid",()=>Y,"LibraryGridEmptyResults",()=>Z,"LibraryGridError",()=>Q],4941);var ee=e.i(79724);function et({label:e,options:t,selected:r,onChange:a,placeholder:n="All",className:s="",showAllOption:l=!0,allOptionLabel:i="All"}){let[o,c]=(0,j.useState)(!1),d=(0,ee.useOutsideClick)(()=>c(!1),o),u=(0,j.useCallback)(e=>{r.includes(e)?a(r.filter(t=>t!==e)):a([...r,e])},[r,a]),h=(0,j.useCallback)(()=>{a([])},[a]),x=(0,j.useCallback)((e,t)=>{t.stopPropagation(),a(r.filter(t=>t!==e))},[r,a]),m=e=>{let r=t.find(t=>t.value===e);return r?.label??String(e)},f=r.length>0;return(0,w.jsxs)("div",{className:`relative ${s}`,ref:d,children:[(0,w.jsxs)("button",{type:"button",onClick:()=>c(!o),className:`
          flex items-center justify-between gap-2 w-full px-3 py-1.5
          bg-retro-dark border rounded text-sm text-left
          transition-colors
          ${o?"border-retro-cyan":"border-retro-grid/50 hover:border-retro-grid"}
          ${f?"text-white":"text-gray-400"}
        `,"aria-expanded":o,"aria-haspopup":"listbox",children:[(0,w.jsx)("span",{className:"truncate",children:f?`${e} (${r.length})`:n}),(0,w.jsx)("svg",{className:`w-4 h-4 flex-shrink-0 transition-transform ${o?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),f&&(0,w.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:r.map(e=>(0,w.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-retro-cyan/20 text-retro-cyan rounded text-xs",children:[m(e),(0,w.jsx)("button",{type:"button",onClick:t=>x(e,t),className:"hover:text-white transition-colors","aria-label":`Remove ${m(e)}`,children:(0,w.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},String(e)))}),o&&(0,w.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl overflow-hidden",children:(0,w.jsxs)("div",{className:"max-h-60 overflow-y-auto py-1",children:[l&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)("button",{type:"button",onClick:h,className:`
                    w-full flex items-center gap-2 px-3 py-2 text-sm text-left
                    transition-colors
                    ${!f?"bg-retro-cyan/10 text-retro-cyan":"text-gray-300 hover:bg-retro-purple/20"}
                  `,children:[(0,w.jsx)("span",{className:"w-4 h-4 flex items-center justify-center",children:!f&&(0,w.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})})}),i]}),(0,w.jsx)("div",{className:"h-px bg-retro-grid/30 mx-2 my-1"})]}),t.map(e=>{let t=r.includes(e.value);return(0,w.jsxs)("button",{type:"button",onClick:()=>u(e.value),className:`
                    w-full flex items-center gap-2 px-3 py-2 text-sm text-left
                    transition-colors
                    ${t?"bg-retro-cyan/10 text-retro-cyan":"text-gray-300 hover:bg-retro-purple/20"}
                  `,role:"option","aria-selected":t,children:[(0,w.jsx)("span",{className:`
                      w-4 h-4 flex items-center justify-center rounded border
                      ${t?"bg-retro-cyan border-retro-cyan":"border-gray-500"}
                    `,children:t&&(0,w.jsx)("svg",{className:"w-3 h-3 text-retro-dark",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.label]},String(e.value))}),0===t.length&&(0,w.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500 text-center",children:"No options available"})]})})]})}let er=[{value:"updatedAt",label:"Date Modified"},{value:"createdAt",label:"Date Created"},{value:"name",label:"Name"},{value:"description",label:"Description"},{value:"source",label:"Source"},{value:"width",label:"Width"},{value:"height",label:"Height"},{value:"size",label:"Size (W×H)"},{value:"characters",label:"Count"},{value:"manufacturer",label:"Manufacturer"},{value:"system",label:"System"},{value:"chip",label:"Chip"},{value:"locale",label:"Locale"}];function ea({searchQuery:e,onSearchChange:t,availableSizes:r,widthFilters:a,heightFilters:n,onSizeFilterChange:s,availableCharacterCounts:l=[],characterCountFilters:i=[],onCharacterCountFilterChange:o,availableManufacturers:c=[],availableSystems:d=[],manufacturerFilters:u=[],systemFilters:h=[],onManufacturerFilterChange:x,onSystemFilterChange:m,availableChips:f=[],chipFilters:p=[],onChipFilterChange:g,availableLocales:b=[],localeFilters:y=[],onLocaleFilterChange:v,sortField:C="updatedAt",sortDirection:k="desc",onSortFieldChange:N,onSortDirectionToggle:S,totalCount:M,filteredCount:R}){let L=(0,j.useMemo)(()=>[...c].sort(),[c]),E=(0,j.useMemo)(()=>[...d].sort(),[d]),A=(0,j.useMemo)(()=>Array.from(new Set(r.map(e=>e.width))).sort((e,t)=>e-t),[r]),D=(0,j.useMemo)(()=>Array.from(new Set(r.map(e=>e.height))).sort((e,t)=>e-t),[r]),I=(0,j.useCallback)(()=>{t(""),s([],[]),o?.([]),x?.([]),m?.([]),g?.([]),v?.([])},[t,s,o,x,m,g,v]),z=e.length>0||a.length>0||n.length>0||i.length>0||u.length>0||h.length>0||p.length>0||y.length>0;return(0,w.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,w.jsxs)("div",{className:"flex gap-2",children:[(0,w.jsxs)("div",{className:"relative flex-1",children:[(0,w.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Search character sets...",className:"w-full px-4 py-2 pl-10 bg-retro-navy/50 border border-retro-grid/50 rounded-lg text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:border-retro-cyan/50 transition-colors","aria-label":"Search character sets"}),(0,w.jsx)("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e&&(0,w.jsx)("button",{type:"button",onClick:()=>t(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-300","aria-label":"Clear search",children:(0,w.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),N&&S&&(0,w.jsxs)("div",{className:"flex gap-1",children:[(0,w.jsx)("select",{value:C,onChange:e=>N(e.target.value),className:"px-3 py-2 bg-retro-navy/50 border border-retro-grid/50 rounded-lg text-sm text-gray-200 focus:outline-none focus:border-retro-cyan/50 transition-colors cursor-pointer","aria-label":"Sort by",children:er.map(e=>(0,w.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,w.jsx)("button",{type:"button",onClick:S,className:`px-3 py-2 border rounded-lg text-xs font-mono transition-colors ${"desc"===k?"bg-amber-500/20 border-amber-500/50 text-amber-400":"bg-retro-navy/50 border-retro-grid/50 text-gray-400 hover:text-gray-200 hover:border-retro-cyan/50"}`,"aria-label":"asc"===k?"Sort ascending (A to Z)":"Sort descending (Z to A)",title:"asc"===k?"Ascending (A→Z)":"Descending (Z→A)",children:"asc"===k?"abc":"cba"})]})]}),(0,w.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-7 gap-3",children:[(0,w.jsx)(et,{label:"Width",options:A.map(e=>({value:e,label:`${e}px`})),selected:a,onChange:e=>s(e,n),placeholder:"Width",allOptionLabel:"Any width"}),(0,w.jsx)(et,{label:"Height",options:D.map(e=>({value:e,label:`${e}px`})),selected:n,onChange:e=>s(a,e),placeholder:"Height",allOptionLabel:"Any height"}),o&&(0,w.jsx)(et,{label:"Count",options:l.map(e=>({value:e,label:`${e} chars`})),selected:i,onChange:o,placeholder:"Count",allOptionLabel:"Any count"}),x&&(0,w.jsx)(et,{label:"Manufacturer",options:L.map(e=>({value:e,label:e})),selected:u,onChange:x,placeholder:"Manufacturer",allOptionLabel:"Any manufacturer"}),m&&(0,w.jsx)(et,{label:"System",options:E.map(e=>({value:e,label:e})),selected:h,onChange:m,placeholder:"System",allOptionLabel:"Any system"}),g&&(0,w.jsx)(et,{label:"Chip",options:f.map(e=>({value:e,label:e})),selected:p,onChange:g,placeholder:"Chip",allOptionLabel:"Any chip"}),v&&(0,w.jsx)(et,{label:"Locale",options:b.map(e=>({value:e,label:e})),selected:y,onChange:v,placeholder:"Locale",allOptionLabel:"Any locale"})]}),(0,w.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,w.jsx)("span",{children:z?`Showing ${R} of ${M} character sets`:`${M} character set${1!==M?"s":""}`}),z&&(0,w.jsx)("button",{onClick:I,className:"text-retro-cyan hover:text-retro-pink transition-colors",children:"Clear filters"})]})]})}function en({onFileSelect:e,selectedFile:t,loading:r=!1,error:a=null,className:n=""}){let[s,l]=(0,j.useState)(!1),[i,o]=(0,j.useState)(null),c=(0,j.useRef)(null),d=a||i,u=(0,j.useCallback)(async t=>{if(o(null),!H(t))return void o("Invalid file type. Please select a binary ROM file (.bin, .rom, .chr, .fnt, .dat)");if(t.size>1048576)return void o("File too large. Maximum size is 1MB.");try{let r=await t.arrayBuffer();e(t,r)}catch{o("Failed to read file. Please try again.")}},[e]),h=(0,j.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),l(!1);let t=e.dataTransfer.files;t.length>0&&u(t[0])},[u]),x=(0,j.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),l(!0)},[]),m=(0,j.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),l(!1)},[]),f=(0,j.useCallback)(()=>{c.current?.click()},[]),p=(0,j.useCallback)(e=>{let t=e.target.files;t&&t.length>0&&u(t[0])},[u]),g=(0,j.useCallback)(e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),f())},[f]);return(0,w.jsxs)("div",{className:n,children:[(0,w.jsx)("input",{ref:c,type:"file",accept:".bin,.rom,.chr,.fnt,.dat",onChange:p,className:"hidden","aria-hidden":"true"}),(0,w.jsx)("div",{onClick:f,onDrop:h,onDragOver:x,onDragLeave:m,onKeyDown:g,role:"button",tabIndex:0,"aria-label":"Drop a ROM file or click to browse",className:`
          relative flex flex-col items-center justify-center
          p-8 sm:p-12
          border-2 border-dashed rounded-lg
          cursor-pointer
          transition-all
          ${s?"border-retro-cyan bg-retro-cyan/10":t?"border-retro-pink/50 bg-retro-pink/5":"border-retro-grid/50 hover:border-retro-cyan/50 bg-retro-navy/30"}
          ${d?"border-red-500/50 bg-red-500/5":""}
          ${r?"pointer-events-none opacity-50":""}
        `,children:r?(0,w.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,w.jsx)("div",{className:"w-12 h-12 border-2 border-retro-cyan border-t-transparent rounded-full animate-spin"}),(0,w.jsx)("span",{className:"text-sm text-gray-400",children:"Reading file..."})]}):t?(0,w.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,w.jsx)("div",{className:"w-16 h-16 rounded-lg bg-retro-pink/20 flex items-center justify-center",children:(0,w.jsx)("svg",{className:"w-8 h-8 text-retro-pink",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),(0,w.jsxs)("div",{className:"text-center",children:[(0,w.jsx)("p",{className:"text-sm font-medium text-gray-200 truncate max-w-[200px]",children:t.name}),(0,w.jsx)("p",{className:"text-xs text-gray-500",children:W(t.size)})]}),(0,w.jsx)("button",{type:"button",className:"text-xs text-retro-cyan hover:text-retro-pink transition-colors",children:"Choose a different file"})]}):(0,w.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,w.jsx)("div",{className:"w-16 h-16 rounded-full bg-retro-cyan/20 flex items-center justify-center",children:(0,w.jsx)("svg",{className:"w-8 h-8 text-retro-cyan",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,w.jsxs)("div",{className:"text-center",children:[(0,w.jsx)("p",{className:"text-sm text-gray-300",children:"Drag and drop a ROM file here"}),(0,w.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"or click to browse"})]}),(0,w.jsx)("div",{className:"text-[10px] text-gray-500",children:"Accepts: .bin, .rom, .chr, .fnt, .dat"})]})}),d&&(0,w.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-sm text-red-400",children:[(0,w.jsx)("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,w.jsx)("span",{children:d})]})]})}e.s(["LibraryFilters",()=>ea],93949),e.s(["ImportDropZone",()=>en],25544);let es=[{width:5,height:7,label:"5x7",examples:["Apple II","TRS-80 CoCo","Dragon 32","MC6847"],recommendedFontSize:6,priority:3},{width:5,height:8,label:"5x8",examples:["TRS-80 Model I","MCM6673"],recommendedFontSize:7,priority:2},{width:5,height:9,label:"5x9",examples:["BBC Micro Mode 7","Philips P2000","SAA5050 Teletext"],recommendedFontSize:8,priority:2},{width:6,height:8,label:"6x8",examples:["Custom"],recommendedFontSize:7,priority:0},{width:8,height:8,label:"8x8",examples:["C64","VIC-20","Atari 400/800","ZX Spectrum","TI-99/4A","MSX","ColecoVision"],recommendedFontSize:8,priority:3},{width:5,height:10,label:"5x10",examples:["HD44780U LCD"],recommendedFontSize:9,priority:1},{width:6,height:10,label:"6x10",examples:[],recommendedFontSize:9,priority:0},{width:5,height:12,label:"5x12",examples:[],recommendedFontSize:10,priority:0},{width:7,height:12,label:"7x12",examples:[],recommendedFontSize:11,priority:0},{width:8,height:12,label:"8x12",examples:["EGA 43-line mode"],recommendedFontSize:11,priority:0},{width:8,height:14,label:"8x14",examples:["IBM EGA","VGA 25-line"],recommendedFontSize:13,priority:1},{width:5,height:16,label:"5x16",examples:[],recommendedFontSize:14,priority:0},{width:8,height:16,label:"8x16",examples:["IBM VGA","PC BIOS"],recommendedFontSize:14,priority:2},{width:16,height:16,label:"16x16",examples:["CJK Characters","Icons"],recommendedFontSize:14,priority:1},{width:32,height:32,label:"32x32",examples:["Large Icons","Sprites"],recommendedFontSize:28,priority:0}];es.find(e=>"8x8"===e.label),es.find(e=>"8x16"===e.label),es.find(e=>"5x7"===e.label),es.find(e=>"8x8"===e.label),es.find(e=>"8x16"===e.label),es.find(e=>"6x8"===e.label),es.find(e=>"16x16"===e.label);let el=[{count:64,label:"64",examples:["Apple II","TRS-80 CoCo","Dragon 32","MC6847"],description:"Quarter ROM",priority:2},{count:96,label:"96",examples:["ZX Spectrum","BBC Micro Mode 7","SAA5050"],description:"Printable ASCII / Teletext",priority:2},{count:128,label:"128",examples:["Atari 400/800","TRS-80 Model I"],description:"Half ROM",priority:3},{count:213,label:"213",examples:["Intellivision GROM"],description:"Intellivision",priority:1},{count:256,label:"256",examples:["C64","VIC-20","TI-99/4A","MSX","ColecoVision"],description:"Full Set",priority:3},{count:512,label:"512",examples:["Extended ROM"],description:"Extended",priority:0}],ei=[{position:"tl",label:"Top Left",shortLabel:"TL"},{position:"tc",label:"Top Center",shortLabel:"TC"},{position:"tr",label:"Top Right",shortLabel:"TR"},{position:"ml",label:"Middle Left",shortLabel:"ML"},{position:"mc",label:"Middle Center",shortLabel:"MC"},{position:"mr",label:"Middle Right",shortLabel:"MR"},{position:"bl",label:"Bottom Left",shortLabel:"BL"},{position:"bc",label:"Bottom Center",shortLabel:"BC"},{position:"br",label:"Bottom Right",shortLabel:"BR"}];function eo(){return ei.map(e=>e.position)}function ec(e){let t=ei.find(t=>t.position===e);return t?.label??e}e.s(["CHARACTER_RANGE_PRESETS",0,[{name:"Printable ASCII",startCode:32,endCode:126,count:95,description:"Space through tilde (~)"},{name:"Extended ASCII",startCode:32,endCode:255,count:224,description:"Includes accented characters"},{name:"Uppercase Only",startCode:65,endCode:90,count:26,description:"A-Z"},{name:"Lowercase Only",startCode:97,endCode:122,count:26,description:"a-z"},{name:"Digits Only",startCode:48,endCode:57,count:10,description:"0-9"},{name:"Full 256",startCode:0,endCode:255,count:256,description:"All 256 codes with blanks"}],"UNIFIED_CHARACTER_COUNT_PRESETS",0,el,"UNIFIED_DIMENSION_PRESETS",0,es,"getAnchorPositionLabel",()=>ec,"getAnchorPositions",()=>eo],47509);let ed=[{system:"Acorn Atom",manufacturer:"Acorn",year:1980,characterRom:{width:5,height:7,characterCount:64},romChipIds:["mc6847"],notes:"64 ASCII characters from MC6847 internal ROM."},{system:"BBC Micro",manufacturer:"Acorn",year:1981,characterRom:{width:8,height:8,characterCount:256},romChipIds:["saa5050"],notes:"Modes 0-6 from OS ROM; Mode 7 Teletext uses SAA5050."},{system:"Amstrad CPC 464",manufacturer:"Amstrad",year:1984,characterRom:{width:8,height:8,characterCount:256},notes:"Font stored in firmware ROM, software-rendered to screen RAM."},{system:"Apple II",manufacturer:"Apple",year:1977,characterRom:{width:5,height:7,characterCount:64},romChipIds:["signetics-2513","gi-ro-3-2513"],notes:"Uppercase letters, numbers, and symbols only."},{system:"MSX",manufacturer:"ASCII/Microsoft",year:1983,characterRom:{width:8,height:8,characterCount:256},romChipIds:["tms9918"],notes:"Font in Main-ROM copied to VRAM. Regional variants available."},{system:"Atari 400",manufacturer:"Atari",year:1979,characterRom:{width:8,height:8,characterCount:128},romChipIds:["atari-os-rom"],notes:"Font stored within OS ROM. Allows redirection to RAM."},{system:"Atari 800",manufacturer:"Atari",year:1979,characterRom:{width:8,height:8,characterCount:128},romChipIds:["atari-os-rom"],notes:"Identical font storage to Atari 400."},{system:"ColecoVision",manufacturer:"Coleco",year:1982,characterRom:{width:8,height:8,characterCount:256},romChipIds:["colecovision-bios","tms9918"],notes:"Font stored in 8KB BIOS ROM, uses TMS9928A VDP."},{system:"VIC-20",manufacturer:"Commodore",year:1980,characterRom:{width:8,height:8,characterCount:256},romChipIds:["mos-901460-03"],notes:"Two character sets: Uppercase/Graphics and Upper/Lowercase."},{system:"C64",manufacturer:"Commodore",year:1982,characterRom:{width:8,height:8,characterCount:256},romChipIds:["mos-901225-01"],notes:"Two character sets: Uppercase/Graphics and Upper/Lowercase (PETSCII)."},{system:"PET 8032",manufacturer:"Commodore",year:1980,characterRom:{width:8,height:8,characterCount:256},romChipIds:["mos-901447-10"],notes:"Business and Graphics character sets."},{system:"Dragon 32",manufacturer:"Dragon Data",year:1982,characterRom:{width:5,height:7,characterCount:64},romChipIds:["mc6847"],notes:"Similar to TRS-80 CoCo, uses MC6847 VDG."},{system:"Intellivision",manufacturer:"Mattel",year:1979,characterRom:{width:8,height:8,characterCount:213},romChipIds:["intellivision-grom"],notes:"GROM contains 213 predefined 8x8 images including alphanumerics."},{system:"NEC PC-6001",manufacturer:"NEC",year:1981,characterRom:{width:5,height:7,characterCount:64},romChipIds:["mc6847"],notes:"Uses MC6847 VDG internal character set."},{system:"Philips P2000",manufacturer:"Philips",year:1980,characterRom:{width:5,height:9,characterCount:96},romChipIds:["saa5050"],notes:"Teletext character set with block graphics."},{system:"Sega SG-1000",manufacturer:"Sega",year:1983,characterRom:{width:8,height:8,characterCount:256},romChipIds:["tms9918"],notes:"No built-in font; patterns loaded from cartridge into VDP RAM."},{system:"Sega SC-3000",manufacturer:"Sega",year:1983,characterRom:{width:8,height:8,characterCount:256},romChipIds:["tms9918"],notes:"Font provided by BASIC cartridge, includes katakana."},{system:"ZX Spectrum",manufacturer:"Sinclair",year:1982,characterRom:{width:8,height:8,characterCount:96},romChipIds:["sinclair-spectrum-rom"],notes:"Printable ASCII (32-127). Font embedded in 16KB system ROM."},{system:"TRS-80 Model I",manufacturer:"Tandy",year:1977,characterRom:{width:5,height:8,characterCount:128},romChipIds:["mcm6673"],notes:"Uppercase only; lowercase via hardware modification."},{system:"TRS-80 CoCo",manufacturer:"Tandy",year:1980,characterRom:{width:5,height:7,characterCount:64},romChipIds:["mc6847"],notes:"MC6847 VDG. Lowercase rendered as inverse uppercase."},{system:"TI-99/4A",manufacturer:"Texas Instruments",year:1981,characterRom:{width:8,height:8,characterCount:256},romChipIds:["tms9918"],notes:"User-definable patterns stored in VDP RAM, loaded from GROM."}],eu=[{id:"atari-os-rom",partNumber:"Atari OS ROM",manufacturer:"Atari",type:"System ROM (embedded font)",glyph:{width:8,height:8},glyphCount:128,usedIn:["Atari 400","Atari 800"],notes:"Font in OS ROM; allows software redirection to RAM."},{id:"colecovision-bios",partNumber:"ColecoVision BIOS",manufacturer:"Coleco",type:"System BIOS (8KB)",glyph:{width:8,height:8},glyphCount:256,usedIn:["ColecoVision"],notes:"Contains startup code, bitmap fonts, and utility routines."},{id:"gi-ro-3-2513",partNumber:"RO-3-2513",manufacturer:"General Instrument",type:"Mask ROM",glyph:{width:5,height:7},glyphCount:64,usedIn:["Apple II"],notes:"Pin-compatible with Signetics 2513, used in Apple II clones."},{id:"intellivision-grom",partNumber:"GROM",manufacturer:"General Instrument",type:"Graphics ROM (part of STIC)",glyph:{width:8,height:8},glyphCount:213,usedIn:["Intellivision"],notes:"Contains 213 predefined 8x8 images including alphanumerics."},{id:"mos-901225-01",partNumber:"901225-01",manufacturer:"MOS Technology",type:"Mask ROM (2332-type)",glyph:{width:8,height:8},glyphCount:256,usedIn:["C64"],notes:"Commonly replaced via EPROM adapters for custom fonts."},{id:"mos-901447-10",partNumber:"901447-10",manufacturer:"MOS Technology",type:"Mask ROM (2316-type)",glyph:{width:8,height:8},glyphCount:256,usedIn:["PET 8032"],notes:"Reversed characters generated by hardware logic."},{id:"mos-901460-03",partNumber:"901460-03",manufacturer:"MOS Technology",type:"Mask ROM (2332-type)",glyph:{width:8,height:8},glyphCount:256,usedIn:["VIC-20"],notes:"4K×8 mask ROM; byte-wide organization."},{id:"mc6847",partNumber:"MC6847",manufacturer:"Motorola",type:"Video Display Generator (VDG)",glyph:{width:5,height:7},glyphCount:64,usedIn:["TRS-80 CoCo","Dragon 32","Acorn Atom","NEC PC-6001"],notes:"All-in-one VDG with internal 64-character ROM."},{id:"mc6847t1",partNumber:"MC6847T1",manufacturer:"Motorola",type:"Video Display Generator (enhanced)",glyph:{width:5,height:7},glyphCount:96,usedIn:[],notes:"Enhanced version with 96 characters including lowercase."},{id:"mcm6673",partNumber:"MCM6673",manufacturer:"Motorola",type:"Mask ROM (custom)",glyph:{width:5,height:8},glyphCount:128,usedIn:["TRS-80 Model I"],notes:"Custom for Radio Shack. Outputs 5 bits per row."},{id:"mcm6674",partNumber:"MCM6674",manufacturer:"Motorola",type:"Mask ROM",glyph:{width:5,height:8},glyphCount:128,usedIn:[],notes:"General-purpose character generator for terminals."},{id:"saa5050",partNumber:"SAA5050",manufacturer:"Mullard/Philips",type:"Teletext Character Generator",glyph:{width:5,height:9},glyphCount:96,usedIn:["BBC Micro","Philips P2000"],notes:"Teletext IC. Internal 5x9 font interpolated to 10x18."},{id:"signetics-2513",partNumber:"2513",manufacturer:"Signetics",type:"Mask ROM",glyph:{width:5,height:7},glyphCount:64,usedIn:["Apple II"],notes:"One of the earliest character generator ROMs."},{id:"sinclair-spectrum-rom",partNumber:"Spectrum ROM",manufacturer:"Sinclair",type:"System ROM (embedded font)",glyph:{width:8,height:8},glyphCount:96,usedIn:["ZX Spectrum"],notes:"Font at end of 16KB ROM; 768 bytes for custom fonts."},{id:"tms9918",partNumber:"TMS9918A",manufacturer:"Texas Instruments",type:"Video Display Processor (VDP)",glyph:{width:8,height:8},glyphCount:256,usedIn:["TI-99/4A","ColecoVision","MSX","Sega SG-1000","Sega SC-3000"],notes:"No internal font; patterns stored in 16KB VRAM."}],eh=(()=>{let e=new Map;for(let t of ed)e.has(t.manufacturer)||e.set(t.manufacturer,[]),e.get(t.manufacturer).push(t.system);return Array.from(e.entries()).map(([e,t])=>({manufacturer:e,systems:t}))})(),ex=ed.filter(e=>void 0!==e.characterRom),em=ex.map(e=>({system:e.system,manufacturer:e.manufacturer,width:e.characterRom.width,height:e.characterRom.height})),ef=ex.map(e=>({system:e.system,manufacturer:e.manufacturer,count:e.characterRom.characterCount}));function ep(e,t){return ex.filter(r=>r.characterRom.width===e&&r.characterRom.height===t).map(e=>e.system)}function eg(e){return ex.filter(t=>t.characterRom.characterCount===e).map(e=>e.system)}ep(8,8),ep(5,7),ep(5,8),ep(5,9),eg(64),eg(96),eg(128),eg(213),eg(256);let eb=eu.map(e=>({id:e.id,partNumber:e.partNumber,manufacturer:e.manufacturer,width:e.glyph.width,height:e.glyph.height,usedIn:e.usedIn})),ey=eu.map(e=>({id:e.id,partNumber:e.partNumber,manufacturer:e.manufacturer,count:e.glyphCount,usedIn:e.usedIn}));function ev({currentWidth:e,currentHeight:t,onSelect:r,presets:a=es,includeFontSize:n=!1,disabled:s=!1,className:l=""}){let i=(0,j.useRef)(null),[o,c]=(0,j.useState)(a.length),[d,u]=(0,j.useState)(!1),h=(0,j.useRef)(null),x=[...a].sort((e,t)=>t.priority-e.priority),m=(0,j.useCallback)(()=>{i.current&&c(Math.max(2,Math.min(Math.floor((i.current.offsetWidth-56-8+8)/56),a.length)))},[a.length]);(0,j.useEffect)(()=>{m();let e=new ResizeObserver(()=>{m()});return i.current&&e.observe(i.current),()=>e.disconnect()},[m]),(0,j.useEffect)(()=>{function e(e){h.current&&!h.current.contains(e.target)&&u(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let f=function(){let e={};for(let t of em)e[t.manufacturer]||(e[t.manufacturer]=[]),e[t.manufacturer].push(t);return e}(),p=function(){let e={};for(let t of eb)e[t.manufacturer]||(e[t.manufacturer]=[]),e[t.manufacturer].push(t);return e}(),g=r=>e===r.width&&t===r.height,b=(r,a)=>e===r&&t===a,y=e=>{n&&e.recommendedFontSize?r(e.width,e.height,e.recommendedFontSize):r(e.width,e.height),u(!1)},v=[],C=[],k=new Set(x.slice(0,o).map(e=>e.label));for(let e of a)k.has(e.label)?v.push(e):C.push(e);return(0,w.jsx)("div",{ref:i,className:`relative ${l}`,children:(0,w.jsxs)("div",{className:"flex flex-wrap gap-2",children:[v.map(e=>(0,w.jsx)("button",{type:"button",onClick:()=>y(e),disabled:s,title:e.examples.length>0?e.examples.join(", "):void 0,className:`
              px-3 py-1 text-xs rounded border transition-colors
              ${g(e)?"border-retro-pink bg-retro-pink/10 text-retro-pink":"border-retro-grid/50 text-gray-400 hover:border-retro-grid"}
              disabled:opacity-50
            `,children:e.label},e.label)),(0,w.jsxs)("div",{ref:h,className:"relative",children:[(0,w.jsxs)("button",{type:"button",onClick:()=>u(!d),disabled:s,className:"px-3 py-1 text-xs rounded border border-retro-grid/50 text-gray-400 hover:border-retro-grid flex items-center gap-1 disabled:opacity-50",children:["More",(0,w.jsx)("svg",{className:`w-3 h-3 transition-transform ${d?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),d&&(0,w.jsxs)("div",{className:"absolute z-50 left-0 top-full mt-1 w-72 max-h-96 overflow-y-auto bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl",children:[C.length>0&&(0,w.jsxs)("div",{className:"p-2 border-b border-retro-grid/30",children:[(0,w.jsx)("div",{className:"text-[10px] text-gray-500 uppercase mb-1",children:"Other Sizes"}),(0,w.jsx)("div",{className:"flex flex-wrap gap-1",children:C.map(e=>(0,w.jsx)("button",{onClick:()=>y(e),disabled:s,title:e.examples.length>0?e.examples.join(", "):void 0,className:`
                          px-2 py-1 text-xs rounded transition-colors
                          ${g(e)?"bg-retro-pink/20 text-retro-pink":"text-gray-400 hover:bg-retro-grid/20"}
                          disabled:opacity-50
                        `,children:e.label},e.label))})]}),Object.keys(f).length>0&&(0,w.jsx)("div",{className:"px-2 pt-2 pb-1",children:(0,w.jsx)("div",{className:"text-[10px] text-retro-cyan uppercase font-medium",children:"Systems"})}),Object.entries(f).filter(([,e])=>e.length>0).map(([e,t])=>(0,w.jsxs)("div",{className:"px-2 pb-2",children:[(0,w.jsx)("div",{className:"text-[10px] text-gray-500 uppercase mb-1",children:e}),(0,w.jsx)("div",{className:"flex flex-wrap gap-1",children:t.map(e=>(0,w.jsx)("button",{onClick:()=>{r(e.width,e.height),u(!1)},disabled:s,title:`${e.width}x${e.height}`,className:`
                            px-2 py-1 text-xs rounded transition-colors
                            ${b(e.width,e.height)?"bg-retro-amber/20 text-retro-amber":"text-gray-400 hover:bg-retro-grid/20"}
                            disabled:opacity-50
                          `,children:e.system},`${e.system}-${e.width}x${e.height}`))})]},e)),Object.keys(p).length>0&&(0,w.jsx)("div",{className:"border-t border-retro-grid/30"}),Object.keys(p).length>0&&(0,w.jsx)("div",{className:"px-2 pt-2 pb-1",children:(0,w.jsx)("div",{className:"text-[10px] text-retro-cyan uppercase font-medium",children:"Character ROM ICs"})}),Object.entries(p).filter(([,e])=>e.length>0).map(([e,t])=>(0,w.jsxs)("div",{className:"px-2 pb-2",children:[(0,w.jsx)("div",{className:"text-[10px] text-gray-500 uppercase mb-1",children:e}),(0,w.jsx)("div",{className:"flex flex-wrap gap-1",children:t.map(e=>(0,w.jsx)("button",{onClick:()=>{r(e.width,e.height),u(!1)},disabled:s,title:e.usedIn.length>0?`${e.width}x${e.height} - Used in: ${e.usedIn.join(", ")}`:`${e.width}x${e.height}`,className:`
                            px-2 py-1 text-xs rounded transition-colors
                            ${b(e.width,e.height)?"bg-retro-purple/20 text-retro-purple":"text-gray-400 hover:bg-retro-grid/20"}
                            disabled:opacity-50
                          `,children:e.partNumber},`${e.id}-${e.width}x${e.height}`))})]},`rom-${e}`))]})]})]})})}function ew({value:e,onChange:t,disabled:r=!1,className:a=""}){return(0,w.jsxs)("div",{className:`flex gap-2 ${a}`,children:[(0,w.jsx)("button",{type:"button",onClick:()=>t("right"),disabled:r,className:`
          flex-1 px-3 py-2 text-xs rounded border transition-colors
          ${"right"===e?"border-retro-cyan bg-retro-cyan/10 text-retro-cyan":"border-retro-grid/50 text-gray-400 hover:border-retro-grid"}
          disabled:opacity-50
        `,children:"Right"}),(0,w.jsx)("button",{type:"button",onClick:()=>t("left"),disabled:r,className:`
          flex-1 px-3 py-2 text-xs rounded border transition-colors
          ${"left"===e?"border-retro-cyan bg-retro-cyan/10 text-retro-cyan":"border-retro-grid/50 text-gray-400 hover:border-retro-grid"}
          disabled:opacity-50
        `,children:"Left"})]})}function ej({value:e,onChange:t,disabled:r=!1,className:a=""}){return(0,w.jsxs)("div",{className:`flex gap-2 ${a}`,children:[(0,w.jsx)("button",{type:"button",onClick:()=>t("ltr"),disabled:r,className:`
          flex-1 px-3 py-2 text-xs rounded border transition-colors
          ${"ltr"===e?"border-retro-cyan bg-retro-cyan/10 text-retro-cyan":"border-retro-grid/50 text-gray-400 hover:border-retro-grid"}
          disabled:opacity-50
        `,children:"MSB First"}),(0,w.jsx)("button",{type:"button",onClick:()=>t("rtl"),disabled:r,className:`
          flex-1 px-3 py-2 text-xs rounded border transition-colors
          ${"rtl"===e?"border-retro-cyan bg-retro-cyan/10 text-retro-cyan":"border-retro-grid/50 text-gray-400 hover:border-retro-grid"}
          disabled:opacity-50
        `,children:"LSB First"})]})}e.s(["DimensionPresetSelector",()=>ev],33140),e.s(["PaddingDirectionSelector",()=>ew],88734),e.s(["BitDirectionSelector",()=>ej],1978),e.s([],73581);var eC=e.i(49738);function ek({character:e,config:t,onPixelToggle:r,onPixelSet:a,onDragStart:n,onDragEnd:s,getPixelState:l,batchMode:i=!1,foregroundColor:o="#ffffff",backgroundColor:c="#000000",gridColor:d="#333333",gridThickness:u=1,zoom:h=20,minZoom:x=8,maxZoom:m=40,onZoomChange:f,onPixelHover:p,onPixelLeave:g,className:b="",overlayCharacter:y,overlayConfig:v,overlayMode:C="pixel"}){let k,N,S,M=(0,j.useRef)(null),R=(0,j.useRef)(null),[L,E]=(0,j.useState)(!1),[A,D]=(0,j.useState)(null),I=(0,j.useRef)(null),z=(0,j.useMemo)(()=>{if(!i||!l||!e)return;let r=new Set;for(let e=0;e<t.height;e++)for(let a=0;a<t.width;a++)"mixed"===l(e,a)&&r.add(`${e},${a}`);return r.size>0?r:void 0},[i,l,e,t.height,t.width]);(0,j.useEffect)(()=>{let e=R.current;if(!e||!v)return;let r=e.getContext("2d");if(!r)return;let a=t.width,n=t.height,s=v.width,l=v.height,i=h+u,o=a*i+u,c=n*i+u;if(e.width=o,e.height=c,r.clearRect(0,0,o,c),y)if(r.fillStyle="rgba(255, 0, 128, 0.5)","stretch"===C){let e=a*i/s,t=n*i/l;for(let a=0;a<l;a++)for(let n=0;n<s;n++)if(y.pixels[a]?.[n]){let s=u+n*e,l=u+a*t;r.fillRect(s,l,e,t)}}else{let e=Math.min(l,n),t=Math.min(s,a);for(let a=0;a<e;a++)for(let e=0;e<t;e++)if(y.pixels[a]?.[e]){let t=e*i+u,n=a*i+u;r.fillRect(t,n,h,h)}}},[y,v,C,t.width,t.height,h,u]);let B=(0,j.useCallback)((t,s,l)=>{L||(n?.(),l?(a?.(t,s,!1),D(!1)):(r?.(t,s),D(!e?.pixels[t]?.[s])),E(!0))},[L,r,a,n,e]),O=(0,j.useCallback)((e,t)=>{L&&null!==A&&a&&a(e,t,A)},[L,A,a]),F=(0,j.useCallback)(()=>{L&&(E(!1),D(null),s?.())},[L,s]),T=(0,j.useCallback)(e=>{if((e.ctrlKey||e.metaKey)&&(e.preventDefault(),f)){let t=Math.min(m,Math.max(x,h+(e.deltaY>0?-4:4)));t!==h&&f(t)}},[h,x,m,f]),$=(0,j.useCallback)(e=>{if(e.length<2)return null;let t=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(t*t+r*r)},[]),P=(0,j.useCallback)(e=>{2===e.touches.length&&(e.preventDefault(),I.current=$(e.touches))},[$]),W=(0,j.useCallback)(e=>{if(2===e.touches.length&&null!==I.current&&f){e.preventDefault();let t=$(e.touches);if(null!==t){let e=Math.min(m,Math.max(x,h+(t-I.current)/20));Math.abs(e-h)>=1&&(f(Math.round(e)),I.current=t)}}},[$,h,x,m,f]),_=(0,j.useCallback)(()=>{I.current=null},[]);return((0,j.useEffect)(()=>{let e=M.current;if(!e)return;let t=e=>{2===e.touches.length&&e.preventDefault()};return e.addEventListener("touchmove",t,{passive:!1}),()=>{e.removeEventListener("touchmove",t)}},[]),e)?(0,w.jsx)("div",{ref:M,className:`flex items-center justify-center w-full h-full overflow-hidden bg-black/20 ${b}`,tabIndex:0,onWheel:T,onTouchStart:P,onTouchMove:W,onTouchEnd:_,children:(0,w.jsx)("div",{className:"inline-block",onMouseLeave:F,onMouseUp:F,children:(0,w.jsxs)("div",{className:"relative",children:[(0,w.jsx)(eC.CharacterDisplay,{character:e,mode:"large",scale:h,foregroundColor:o,backgroundColor:c,gridColor:d,gridThickness:u,onPixelClick:B,onPixelDrag:O,onDragEnd:F,onPixelHover:p,onPixelLeave:g,interactive:!0,mixedPixels:z}),v&&"side-by-side"!==C&&(k=h+u,N=t.width*k+u,S=t.height*k+u,(0,w.jsx)("canvas",{ref:R,className:"absolute top-0 left-0 pointer-events-none",style:{imageRendering:"pixelated",zIndex:10,width:N,height:S}}))]})})}):(0,w.jsx)("div",{className:`flex items-center justify-center h-full ${b}`,children:(0,w.jsxs)("div",{className:"text-center text-gray-500",children:[(0,w.jsx)("svg",{className:"w-16 h-16 mx-auto mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6z"})}),(0,w.jsx)("p",{children:"No character selected"})]})})}e.s(["EditorCanvas",()=>ek],60441);var eN=e.i(32267);function eS({characters:e,config:t,selectedIndex:r,batchSelection:a,onSelect:n,foregroundColor:s="#ffffff",backgroundColor:l="#000000",selectionColor:i="#00ffff",batchSelectionColor:o="#ff69b4",maxWidth:c=200,pixelScale:d=1,gap:u=1,collapsible:h=!0,defaultCollapsed:x=!1,className:m=""}){let f=(0,j.useRef)(null),p=(0,j.useRef)(null),[g,b]=(0,j.useState)(x),[y,v]=(0,j.useState)(null),C=t.width*d,k=t.height*d,N=C+u,S=k+u,M=Math.max(1,Math.floor(c/N)),R=Math.ceil(e.length/M),L=M*N-u,E=R*S-u;(0,j.useEffect)(()=>{let t=f.current;if(!t||g)return;let n=t.getContext("2d");n&&(t.width=L,t.height=E,n.fillStyle=l,n.fillRect(0,0,L,E),e.forEach((e,t)=>{let c=t%M*N,u=Math.floor(t/M)*S;n.fillStyle=l,n.fillRect(c,u,C,k),n.fillStyle=s,e.pixels.forEach((e,t)=>{e.forEach((e,r)=>{e&&n.fillRect(c+r*d,u+t*d,d,d)})}),a?.has(t)&&t!==r&&(n.strokeStyle=o,n.lineWidth=1,n.globalAlpha=.7,n.strokeRect(c+.5,u+.5,C-1,k-1),n.globalAlpha=1),t===r?(n.strokeStyle=i,n.lineWidth=2,n.strokeRect(c+1,u+1,C-2,k-2)):t!==y||a?.has(t)||(n.strokeStyle=i,n.lineWidth=1,n.globalAlpha=.5,n.strokeRect(c+.5,u+.5,C-1,k-1),n.globalAlpha=1)}))},[e,t,r,a,y,s,l,i,o,d,u,M,L,E,C,k,N,S,g]);let A=(0,j.useCallback)(t=>{if(!n)return;let r=f.current;if(!r)return;let a=r.getBoundingClientRect(),s=t.clientX-a.left,l=t.clientY-a.top,i=r.width/a.width,o=Math.floor(l*(r.height/a.height)/S)*M+Math.floor(s*i/N);o>=0&&o<e.length&&n(o)},[n,N,S,M,e.length]),D=(0,j.useCallback)(t=>{let r=f.current;if(!r)return;let a=r.getBoundingClientRect(),n=t.clientX-a.left,s=t.clientY-a.top,l=r.width/a.width,i=Math.floor(s*(r.height/a.height)/S)*M+Math.floor(n*l/N);i>=0&&i<e.length?v(i):v(null)},[N,S,M,e.length]),I=(0,j.useCallback)(()=>{v(null)},[]),z=(0,j.useCallback)(()=>{b(e=>!e)},[]);return(0,w.jsxs)("div",{className:`${m}`,ref:p,children:[h&&(0,w.jsxs)("button",{onClick:z,className:"w-full flex items-center justify-between p-2 text-sm text-gray-300 hover:text-retro-cyan transition-colors",children:[(0,w.jsx)("span",{className:"font-medium",children:"Overview"}),(0,w.jsx)("svg",{className:`w-4 h-4 transition-transform ${g?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),!g&&(0,w.jsx)("div",{className:"p-2 bg-black/30 rounded overflow-auto",style:{maxHeight:"150px"},children:(0,w.jsx)("canvas",{ref:f,onClick:A,onMouseMove:D,onMouseLeave:I,className:"cursor-pointer",style:{width:L,height:E,imageRendering:"pixelated"}})})]})}function eM({characters:e,config:t,selectedIndex:r,batchSelection:a,onSelect:n,onAddCharacter:s,onDeleteSelected:l,onSelectAll:i,onSelectNone:o,onContextMenu:c,showAddButton:d=!0,foregroundColor:u="#ffffff",backgroundColor:h="#000000",className:x=""}){let m=a.size+1,f=m>1,[p,g]=(0,j.useState)(!1),b=(0,j.useCallback)(t=>{let a=e.length;if(0!==a)switch(t.key){case"ArrowUp":case"ArrowLeft":t.preventDefault(),n(r>0?r-1:a-1,t.shiftKey,t.metaKey||t.ctrlKey);break;case"ArrowDown":case"ArrowRight":t.preventDefault(),n(r<a-1?r+1:0,t.shiftKey,t.metaKey||t.ctrlKey);break;case"Delete":case"Backspace":t.preventDefault(),l?.();break;case"a":case"A":(t.ctrlKey||t.metaKey)&&t.preventDefault()}},[e.length,r,n,l]);return(0,w.jsxs)("div",{className:`flex flex-col ${x}`,onKeyDown:b,children:[(0,w.jsxs)("div",{className:"p-3 border-b border-retro-grid/30",children:[(0,w.jsx)("div",{className:"flex items-center justify-between",children:(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Characters"}),(0,w.jsxs)("span",{className:"text-xs text-gray-500",children:["(",e.length,")"]})]})}),f&&(0,w.jsxs)("div",{className:"mt-1 text-xs text-retro-pink",children:[m," characters selected"]})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{className:"border-b border-retro-grid/30",children:(0,w.jsx)(eS,{characters:e,config:t,selectedIndex:r,batchSelection:a,onSelect:e=>n(e,!1),foregroundColor:u,backgroundColor:h,maxWidth:200,pixelScale:1,collapsible:!0,defaultCollapsed:!1})}),(0,w.jsxs)("div",{className:"border-b border-retro-grid/30",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between p-2",children:[(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)("span",{className:"font-medium text-sm text-gray-300",children:"Characters"}),i&&(0,w.jsx)("button",{onClick:e=>{e.stopPropagation(),i()},className:"text-[10px] text-gray-500 hover:text-retro-cyan transition-colors",children:"All"}),o&&f&&(0,w.jsx)("button",{onClick:e=>{e.stopPropagation(),o()},className:"text-[10px] text-gray-500 hover:text-retro-pink transition-colors",children:"None"})]}),(0,w.jsx)("button",{onClick:()=>g(!p),className:"p-1 text-gray-400 hover:text-retro-cyan transition-colors","aria-label":p?"Expand characters":"Collapse characters",children:(0,w.jsx)("svg",{className:`w-4 h-4 transition-transform ${p?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!p&&(0,w.jsx)("div",{className:"p-2",children:(0,w.jsx)(eN.InteractiveCharacterGrid,{characters:e,config:t,selectedIndex:r,batchSelection:a,onSelect:n,showAddButton:d&&!!s,onAdd:s,foregroundColor:u,backgroundColor:h,showIndices:!1,smallScale:2,minColumns:8,maxColumns:10,gap:4,onContextMenu:c})})]})]})]})}e.s(["CharacterSetOverview",()=>eS],59160),e.s(["EditorSidebar",()=>eM],42187);let eR=[{id:"classic",name:"White Phosphor",foreground:"#ffffff",background:"#000000",gridColor:"#333333"},{id:"green",name:"Green Phosphor",foreground:"#33ff33",background:"#001100",gridColor:"#004400"},{id:"amber",name:"Amber Phosphor",foreground:"#ffb000",background:"#1a0a00",gridColor:"#4d2e00"},{id:"c64-blue",name:"C64 Blue",foreground:"#6c5eb5",background:"#40318d",gridColor:"#2e2266"},{id:"c64-cyan",name:"C64 Light Blue",foreground:"#70a4b2",background:"#352879",gridColor:"#493f99"},{id:"apple-green",name:"Apple II Green",foreground:"#14f53c",background:"#000000",gridColor:"#0a4d15"},{id:"zx-spectrum",name:"ZX Spectrum",foreground:"#ffffff",background:"#0000d7",gridColor:"#0000aa"},{id:"ibm-cga",name:"IBM CGA Cyan",foreground:"#55ffff",background:"#000000",gridColor:"#005555"},{id:"vt100",name:"VT100",foreground:"#00ff00",background:"#000000",gridColor:"#003300"},{id:"custom",name:"Custom...",foreground:"",background:"",gridColor:""}],eL="character-editor-color-preset",eE="character-editor-custom-colors";function eA(e){return eR.find(t=>t.id===e)}function eD(e){try{localStorage.setItem(eL,e)}catch{}}function eI(){try{return localStorage.getItem(eL)||"classic"}catch{return"classic"}}function ez(e){try{localStorage.setItem(eE,JSON.stringify(e))}catch{}}function eB(){try{let e=localStorage.getItem(eE);if(e)return JSON.parse(e)}catch{}return{foreground:"#ffffff",background:"#000000",gridColor:"#333333"}}function eO(){let e=eI();if("custom"===e)return eB();let t=eA(e);return t?{foreground:t.foreground,background:t.background,gridColor:t.gridColor}:{foreground:"#ffffff",background:"#000000",gridColor:"#333333"}}function eF({colors:e,onColorsChange:t,className:r="",dropUp:a=!1}){let[n,s]=(0,j.useState)(!1),[l,i]=(0,j.useState)(()=>eI()),[o,c]=(0,j.useState)(()=>eB()),[d,u]=(0,j.useState)(!1),h=(0,ee.useOutsideClick)(()=>{s(!1),u(!1)},n),x=(0,j.useCallback)(e=>{"custom"===e.id?u(!0):(i(e.id),eD(e.id),t({foreground:e.foreground,background:e.background,gridColor:e.gridColor}),s(!1))},[t]),m=(0,j.useCallback)((e,r)=>{let a={...o,[e]:r};c(a),ez(a),i("custom"),eD("custom"),t(a)},[o,t]),f=eA(l),p=f?.name||"Custom";return(0,w.jsxs)("div",{className:`relative ${r}`,ref:h,children:[(0,w.jsxs)("button",{onClick:()=>s(!n),className:"flex items-center gap-2 px-3 py-1.5 bg-retro-navy/50 border border-retro-grid/50 rounded text-sm text-gray-300 hover:border-retro-grid transition-colors","aria-expanded":n,"aria-haspopup":"listbox",children:[(0,w.jsxs)("div",{className:"flex gap-0.5",children:[(0,w.jsx)("div",{className:"w-3 h-3 rounded-sm border border-white/20",style:{backgroundColor:e.foreground}}),(0,w.jsx)("div",{className:"w-3 h-3 rounded-sm border border-white/20",style:{backgroundColor:e.background}})]}),(0,w.jsx)("span",{className:"hidden sm:inline",children:p}),(0,w.jsx)("svg",{className:`w-3 h-3 transition-transform ${n?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),n&&(0,w.jsx)("div",{className:`absolute right-0 w-64 bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl z-50 overflow-hidden ${a?"bottom-full mb-1":"mt-1"}`,children:d?(0,w.jsxs)("div",{className:"p-3 space-y-3",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsx)("span",{className:"text-sm text-gray-300",children:"Custom Colors"}),(0,w.jsx)("button",{onClick:()=>u(!1),className:"text-xs text-gray-500 hover:text-gray-300",children:"Back"})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Foreground"}),(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)("input",{type:"color",value:o.foreground,onChange:e=>m("foreground",e.target.value),className:"w-8 h-8 rounded cursor-pointer border-0 bg-transparent"}),(0,w.jsx)("input",{type:"text",value:o.foreground,onChange:e=>m("foreground",e.target.value),className:"flex-1 px-2 py-1 bg-retro-dark border border-retro-grid/50 rounded text-xs text-gray-300 font-mono"})]})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Background"}),(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)("input",{type:"color",value:o.background,onChange:e=>m("background",e.target.value),className:"w-8 h-8 rounded cursor-pointer border-0 bg-transparent"}),(0,w.jsx)("input",{type:"text",value:o.background,onChange:e=>m("background",e.target.value),className:"flex-1 px-2 py-1 bg-retro-dark border border-retro-grid/50 rounded text-xs text-gray-300 font-mono"})]})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Grid Lines"}),(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)("input",{type:"color",value:o.gridColor,onChange:e=>m("gridColor",e.target.value),className:"w-8 h-8 rounded cursor-pointer border-0 bg-transparent"}),(0,w.jsx)("input",{type:"text",value:o.gridColor,onChange:e=>m("gridColor",e.target.value),className:"flex-1 px-2 py-1 bg-retro-dark border border-retro-grid/50 rounded text-xs text-gray-300 font-mono"})]})]})]}):(0,w.jsx)("div",{className:"py-1 max-h-80 overflow-y-auto",children:eR.map(e=>(0,w.jsxs)("button",{onClick:()=>x(e),className:`
                    w-full flex items-center gap-3 px-3 py-2 text-left text-sm
                    transition-colors
                    ${l===e.id?"bg-retro-cyan/10 text-retro-cyan":"text-gray-300 hover:bg-retro-purple/20"}
                  `,role:"option","aria-selected":l===e.id,children:["custom"!==e.id?(0,w.jsxs)("div",{className:"flex gap-0.5 flex-shrink-0",children:[(0,w.jsx)("div",{className:"w-4 h-4 rounded-sm border border-white/20",style:{backgroundColor:e.foreground}}),(0,w.jsx)("div",{className:"w-4 h-4 rounded-sm border border-white/20",style:{backgroundColor:e.background}})]}):(0,w.jsx)("div",{className:"w-[34px] h-4 flex items-center justify-center",children:(0,w.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})}),(0,w.jsx)("span",{className:"flex-1",children:e.name}),l===e.id&&(0,w.jsx)("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})})]},e.id))})})]})}e.s(["COLOR_PRESETS",0,eR,"getActiveColors",()=>eO,"getCustomColors",()=>eB,"getPresetById",()=>eA,"getSavedPresetId",()=>eI,"saveCustomColors",()=>ez,"saveSelectedPreset",()=>eD],82906),e.s(["ColorPresetSelector",()=>eF],95879);let eT={0:"NUL",1:"SOH",2:"STX",3:"ETX",4:"EOT",5:"ENQ",6:"ACK",7:"BEL",8:"BS",9:"HT",10:"LF",11:"VT",12:"FF",13:"CR",14:"SO",15:"SI",16:"DLE",17:"DC1",18:"DC2",19:"DC3",20:"DC4",21:"NAK",22:"SYN",23:"ETB",24:"CAN",25:"EM",26:"SUB",27:"ESC",28:"FS",29:"GS",30:"RS",31:"US",127:"DEL"};function e$(e){return eT[e]||null}function eP(e){return e>=32&&e<=126}var eW=e.i(21745);function e_({characterSetName:e,isDirty:t,characterIndex:r,totalCharacters:a,batchMode:n=!1,zoom:s,minZoom:l=8,maxZoom:i=40,zoomStep:o=4,onZoomChange:c,colors:d,onColorsChange:u,onBack:h,className:x=""}){let m=eP(r),f=e$(r);return(0,w.jsxs)("div",{className:`flex items-center gap-4 px-4 py-2 bg-retro-navy/50 border-b border-retro-grid/50 ${x}`,children:[(0,w.jsxs)("button",{onClick:h,className:"flex items-center gap-1 text-xs text-gray-400 hover:text-retro-cyan transition-colors whitespace-nowrap",children:[(0,w.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),(0,w.jsx)("span",{className:"hidden sm:inline",children:"Back"})]}),(0,w.jsx)("div",{className:"w-px h-4 bg-retro-grid/50"}),(0,w.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-300 min-w-0",children:[(0,w.jsx)("span",{className:"truncate max-w-[150px] sm:max-w-[200px]",title:e,children:e}),t&&(0,w.jsxs)("span",{className:"flex items-center gap-1.5 flex-shrink-0",title:"Unsaved changes",children:[(0,w.jsxs)("span",{className:"relative flex h-2 w-2",children:[(0,w.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-retro-pink opacity-75"}),(0,w.jsx)("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-retro-pink"})]}),(0,w.jsx)("span",{className:"hidden sm:inline text-xs text-retro-pink font-medium",children:"Unsaved"})]})]}),(0,w.jsx)("div",{className:"w-px h-4 bg-retro-grid/50 hidden sm:block"}),(0,w.jsxs)("div",{className:"hidden sm:flex items-center gap-2 text-sm text-gray-400",children:[(0,w.jsxs)("span",{className:"whitespace-nowrap",children:["Char ",(0,w.jsx)("span",{className:"text-retro-cyan",children:r}),(0,w.jsxs)("span",{className:"text-gray-500",children:["/",a]})]}),m&&(0,w.jsxs)("span",{className:"px-1.5 py-0.5 bg-retro-purple/30 text-retro-cyan rounded text-xs font-mono",title:"Printable ASCII Character",children:["'",String.fromCharCode(r),"'"]}),f&&(0,w.jsxs)("span",{className:"px-1.5 py-0.5 text-xs bg-retro-pink/20 text-retro-pink rounded",title:"ASCII Control Character",children:[" ","(",f,")"]}),n&&(0,w.jsx)("span",{className:"px-1.5 py-0.5 text-xs bg-retro-pink/20 text-retro-pink rounded",children:"Batch"})]}),(0,w.jsx)("div",{className:"flex-1"}),(0,w.jsxs)("div",{className:"flex items-center gap-1",children:[(0,w.jsx)(eW.Tooltip,{content:"Zoom out",shortcut:"-",children:(0,w.jsx)("button",{onClick:()=>{s>l&&c(Math.max(s-o,l))},disabled:s<=l,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed",children:(0,w.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})})}),(0,w.jsxs)("span",{className:"text-xs text-gray-500 w-10 text-center",children:[s,"x"]}),(0,w.jsx)(eW.Tooltip,{content:"Zoom in",shortcut:"+",children:(0,w.jsx)("button",{onClick:()=>{s<i&&c(Math.min(s+o,i))},disabled:s>=i,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed",children:(0,w.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})})]}),(0,w.jsx)("div",{className:"w-px h-4 bg-retro-grid/50"}),(0,w.jsx)(eF,{colors:d,onColorsChange:u})]})}function eU({hoverCoords:e,className:t=""}){return(0,w.jsxs)("div",{className:`flex-shrink-0 flex items-center px-4 py-1.5 bg-retro-navy/50 border-t border-retro-grid/50 ${t}`,children:[(0,w.jsx)("div",{className:"w-24 flex-shrink-0"}),(0,w.jsx)("div",{className:"flex-1 flex justify-center",children:(0,w.jsx)("div",{className:"flex flex-wrap items-center justify-center gap-x-4 gap-y-1 text-[10px] text-gray-500",children:[{keys:"Arrow keys",action:"Navigate"},{keys:"Click",action:"Select"},{keys:"Shift+Click",action:"Multi-select"},{keys:"Del",action:"Delete"},{keys:"Ctrl+S",action:"Save"},{keys:"Ctrl+Z/Y",action:"Undo/Redo"},{keys:"?",action:"Help"}].map(({keys:e,action:t},r)=>(0,w.jsxs)("div",{className:"flex items-center gap-1 whitespace-nowrap",children:[(0,w.jsx)("span",{className:"text-gray-400",children:e}),(0,w.jsxs)("span",{className:"hidden sm:inline",children:[": ",t]})]},r))})}),(0,w.jsx)("div",{className:"w-24 flex-shrink-0 flex justify-end",children:e&&(0,w.jsxs)("div",{className:"hidden sm:flex items-center gap-1 text-[10px] text-gray-500 font-mono",children:[(0,w.jsx)("span",{className:"text-gray-400",children:"Pixel:"}),(0,w.jsxs)("span",{className:"text-retro-cyan",children:["(",e.x,", ",e.y,")"]})]})})]})}function eH(e,t={}){let{enabled:r=!0,target:a=null}=t,n=(0,j.useRef)(e);(0,j.useEffect)(()=>{n.current=e},[e]);let s=(0,j.useCallback)(e=>{let t=e.target?.tagName?.toLowerCase();if("input"!==t&&"textarea"!==t&&"select"!==t||e.ctrlKey||e.metaKey)for(let t of n.current){let r=e.key.toLowerCase()===t.key.toLowerCase(),a=!!t.ctrl===(e.ctrlKey||e.metaKey),n=!!t.shift===e.shiftKey,s=!!t.alt===e.altKey;if(r&&a&&n&&s){e.preventDefault(),t.action();return}}},[]);(0,j.useEffect)(()=>{if(!r)return;let e=a||window;return e.addEventListener("keydown",s),()=>{e.removeEventListener("keydown",s)}},[r,a,s])}function eK(e){let t=[],r="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);e.ctrl&&t.push(r?"⌘":"Ctrl"),e.alt&&t.push(r?"⌥":"Alt"),e.shift&&t.push(r?"⇧":"Shift");let a=e.key;return t.push(a=" "===a?"Space":"ArrowUp"===a?"↑":"ArrowDown"===a?"↓":"ArrowLeft"===a?"←":"ArrowRight"===a?"→":"Escape"===a?"Esc":"Delete"===a?"Del":"Backspace"===a?"⌫":a.toUpperCase()),t.join(r?"":"+")}function eV(e){return[{key:"z",ctrl:!0,action:e.undo,description:"Undo",context:"Editor"},{key:"z",ctrl:!0,shift:!0,action:e.redo,description:"Redo",context:"Editor"},{key:"y",ctrl:!0,action:e.redo,description:"Redo",context:"Editor"},{key:"s",ctrl:!0,action:e.save,description:"Save",context:"Editor"},{key:"r",action:e.rotateRight,description:"Rotate right",context:"Editor"},{key:"r",shift:!0,action:e.rotateLeft,description:"Rotate left",context:"Editor"},{key:"w",action:e.shiftUp,description:"Shift up",context:"Editor"},{key:"s",action:e.shiftDown,description:"Shift down",context:"Editor"},{key:"a",action:e.shiftLeft,description:"Shift left",context:"Editor"},{key:"d",action:e.shiftRight,description:"Shift right",context:"Editor"},{key:"i",action:e.invert,description:"Invert colors",context:"Editor"},{key:"h",action:e.flipHorizontal,description:"Flip horizontal",context:"Editor"},{key:"v",action:e.flipVertical,description:"Flip vertical",context:"Editor"},{key:"a",ctrl:!0,action:e.selectAll,description:"Select all",context:"Sidebar"},{key:"Delete",action:e.deleteSelected,description:"Delete selected",context:"Sidebar"},{key:"Backspace",action:e.deleteSelected,description:"Delete selected",context:"Sidebar"},{key:"n",ctrl:!0,action:e.addCharacter,description:"Add new character",context:"Editor"},{key:"?",action:e.showHelp,description:"Show keyboard shortcuts",context:"Global"},...e.navigatePrev?[{key:"ArrowUp",action:e.navigatePrev,description:"Previous character",context:"Navigation"}]:[],...e.navigateNext?[{key:"ArrowDown",action:e.navigateNext,description:"Next character",context:"Navigation"}]:[],...e.navigatePageUp?[{key:"PageUp",action:e.navigatePageUp,description:"Jump 16 characters up",context:"Navigation"}]:[],...e.navigatePageDown?[{key:"PageDown",action:e.navigatePageDown,description:"Jump 16 characters down",context:"Navigation"}]:[],...e.navigateFirst?[{key:"Home",action:e.navigateFirst,description:"First character",context:"Navigation"}]:[],...e.navigateLast?[{key:"End",action:e.navigateLast,description:"Last character",context:"Navigation"}]:[],...e.goToCharacter?[{key:"g",action:e.goToCharacter,description:"Go to character",context:"Navigation"}]:[],...e.showAsciiMap?[{key:"m",action:e.showAsciiMap,description:"Show ASCII map",context:"Navigation"}]:[],...e.showTextPreview?[{key:"t",action:e.showTextPreview,description:"Text preview",context:"View"}]:[],...e.showSnapshots?[{key:"s",ctrl:!0,shift:!0,action:e.showSnapshots,description:"Snapshots",context:"Editor"}]:[],...e.exportSet?[{key:"e",action:e.exportSet,description:"Export character set",context:"File"}]:[],...e.importSet?[{key:"i",ctrl:!0,action:e.importSet,description:"Import characters",context:"File"}]:[],...e.shareSet?[{key:"e",ctrl:!0,shift:!0,action:e.shareSet,description:"Share character set",context:"File"}]:[],...e.saveAs?[{key:"s",ctrl:!0,alt:!0,action:e.saveAs,description:"Save as new",context:"File"}]:[],...e.editMetadata?[{key:"F2",action:e.editMetadata,description:"Edit info",context:"File"}]:[],...e.resetChanges?[{key:"r",ctrl:!0,shift:!0,action:e.resetChanges,description:"Reset changes",context:"Editor"}]:[],...e.reorderCharacters?[{key:"o",action:e.reorderCharacters,description:"Reorder characters",context:"Editor"}]:[]]}function eG({isOpen:e,onClose:t,shortcuts:r}){if((0,j.useEffect)(()=>{if(!e)return;let r=e=>{"Escape"===e.key&&(e.preventDefault(),t())};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[e,t]),(0,j.useEffect)(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),!e)return null;let a=r.reduce((e,t)=>{let r=t.context||"General";return e[r]||(e[r]=[]),e[r].push(t),e},{}),n=["Editor","Sidebar","Global"],s=Object.keys(a).sort((e,t)=>{let r=n.indexOf(e),a=n.indexOf(t);return -1===r&&-1===a?e.localeCompare(t):-1===r?1:-1===a?-1:r-a});return(0,w.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,w.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,w.jsxs)("div",{className:"relative w-full max-w-lg bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl overflow-hidden",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-retro-grid/30",children:[(0,w.jsx)("h2",{className:"text-lg font-medium text-white",children:"Keyboard Shortcuts"}),(0,w.jsx)("button",{onClick:t,className:"p-1 text-gray-400 hover:text-white transition-colors","aria-label":"Close",children:(0,w.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,w.jsx)("div",{className:"p-4 max-h-[60vh] overflow-y-auto space-y-6",children:s.map(e=>(0,w.jsxs)("div",{children:[(0,w.jsx)("h3",{className:"text-sm font-medium text-retro-cyan mb-2",children:e}),(0,w.jsx)("div",{className:"space-y-1",children:a[e].map((t,r)=>(0,w.jsxs)("div",{className:"flex items-center justify-between py-1.5 px-2 rounded hover:bg-retro-purple/10",children:[(0,w.jsx)("span",{className:"text-sm text-gray-300",children:t.description}),(0,w.jsx)("kbd",{className:"px-2 py-0.5 text-xs font-mono bg-retro-dark border border-retro-grid/50 rounded text-gray-400",children:eK(t)})]},`${e}-${r}`))})]},e))}),(0,w.jsx)("div",{className:"px-4 py-3 border-t border-retro-grid/30 text-center",children:(0,w.jsxs)("span",{className:"text-xs text-gray-500",children:["Press ",(0,w.jsx)("kbd",{className:"px-1 py-0.5 bg-retro-dark border border-retro-grid/50 rounded text-gray-400",children:"Esc"})," or ",(0,w.jsx)("kbd",{className:"px-1 py-0.5 bg-retro-dark border border-retro-grid/50 rounded text-gray-400",children:"?"})," to close"]})})]})]})}function eX(e,t){let r=e.pixels.length,a=e.pixels[0]?.length||0,n=[];for(let s=0;s<r;s++){let l=[];for(let n=0;n<a;n++){let i,o;"right"===t?(i=a-1-n,o=s):(i=n,o=r-1-s),i>=0&&i<r&&o>=0&&o<a?l.push(e.pixels[i]?.[o]||!1):l.push(!1)}n.push(l)}return{pixels:n}}function eq(e,t,r=!0){let a=e.pixels.length,n=e.pixels[0]?.length||0,s=[];for(let l=0;l<a;l++){let i=[];for(let s=0;s<n;s++){let o=l,c=s;switch(t){case"up":if((o=l+1)>=a&&(o=r?0:a-1,!r)){i.push(!1);continue}break;case"down":if((o=l-1)<0&&(o=r?a-1:0,!r)){i.push(!1);continue}break;case"left":if((c=s+1)>=n&&(c=r?0:n-1,!r)){i.push(!1);continue}break;case"right":if((c=s-1)<0&&(c=r?n-1:0,!r)){i.push(!1);continue}}i.push(e.pixels[o]?.[c]||!1)}s.push(i)}return{pixels:s}}function eY(e,t,r,a){let n=e.pixels.length,s=e.pixels[0]?.length||0,l=0,i=0;a.endsWith("l")?l=0:a.endsWith("c")?l=Math.floor((t-s)/2):a.endsWith("r")&&(l=t-s),a.startsWith("t")?i=0:a.startsWith("m")?i=Math.floor((r-n)/2):a.startsWith("b")&&(i=r-n);let o=[];for(let a=0;a<r;a++){let r=[];for(let o=0;o<t;o++){let t=a-i,c=o-l;t>=0&&t<n&&c>=0&&c<s?r.push(e.pixels[t][c]):r.push(!1)}o.push(r)}return{pixels:o}}function eJ(e){return{pixels:e.pixels.map(e=>e.map(e=>!e))}}function eZ(e){return{pixels:e.pixels.map(e=>[...e].reverse())}}function eQ(e){return{pixels:[...e.pixels].reverse().map(e=>[...e])}}function e0(e,t){return R(e,t)}function e1(e,t){let r=[];for(let a=0;a<t;a++)r.push(Array(e).fill(!0));return{pixels:r}}function e2(e,t,r){return{pixels:e.pixels.map((e,a)=>a===t?e.map((e,t)=>t===r?!e:e):[...e])}}function e4(e,t,r,a){return{pixels:e.pixels.map((e,n)=>n===t?e.map((e,t)=>t===r?a:e):[...e])}}function e5(e,t,r){return e.map((e,a)=>t.has(a)?r(e):e)}function e3(e,t,r,a){let n=Array.from(t).map(t=>e[t]);if(0===n.length)return"same-off";let s=n[0]?.pixels[r]?.[a]||!1;for(let e=1;e<n.length;e++)if((n[e]?.pixels[r]?.[a]||!1)!==s)return"mixed";return s?"same-on":"same-off"}function e6(e,t,r,a){let n="same-on"!==e3(e,t,r,a);return e.map((e,s)=>t.has(s)?e4(e,r,a,n):e)}function e8(e){let t=e.pixels.length,r=e.pixels[0]?.length||0,a=function(e){let t=e.pixels.length,r=e.pixels[0]?.length||0,a=t,n=-1,s=r,l=-1;for(let i=0;i<t;i++)for(let t=0;t<r;t++)e.pixels[i][t]&&(a=Math.min(a,i),n=Math.max(n,i),s=Math.min(s,t),l=Math.max(l,t));return -1===n?null:{minRow:a,maxRow:n,minCol:s,maxCol:l}}(e);if(!a)return e;let n=a.maxCol-a.minCol+1,s=Math.floor((t-(a.maxRow-a.minRow+1))/2),l=Math.floor((r-n)/2)-a.minCol,i=s-a.minRow;if(0===l&&0===i)return e;let o=[];for(let a=0;a<t;a++){let n=[];for(let s=0;s<r;s++){let o=a-i,c=s-l;o>=0&&o<t&&c>=0&&c<r?n.push(e.pixels[o][c]):n.push(!1)}o.push(n)}return{pixels:o}}function e9(e,t,r,a){return 1===t?e:"nearest"===a?function(e,t,r){let a=e.pixels.length,n=e.pixels[0]?.length||0,s=Math.round(n*t),l=Math.round(a*t),i=[];for(let r=0;r<l;r++){let l=[];for(let i=0;i<s;i++){let s=Math.min(Math.floor(r/t),a-1),o=Math.min(Math.floor(i/t),n-1);l.push(e.pixels[s]?.[o]||!1)}i.push(l)}let o=n-s,c=a-l,d=0,u=0;r.endsWith("l")?d=0:r.endsWith("c")?d=Math.floor(o/2):r.endsWith("r")&&(d=o),r.startsWith("t")?u=0:r.startsWith("m")?u=Math.floor(c/2):r.startsWith("b")&&(u=c);let h=[];for(let e=0;e<a;e++){let t=[];for(let r=0;r<n;r++){let a=e-u,n=r-d;a>=0&&a<l&&n>=0&&n<s?t.push(i[a][n]):t.push(!1)}h.push(t)}return{pixels:h}}(e,t,r):function(e,t,r,a=.5){let n=e.pixels.length,s=e.pixels[0]?.length||0,l=Math.round(s*t),i=Math.round(n*t),o=[];for(let r=0;r<i;r++){let n=[];for(let s=0;s<l;s++){let l=r/t,i=(r+1)/t,o=s/t,c=(s+1)/t,d=function(e,t,r,a,n){let s=e.length,l=e[0]?.length||0,i=0,o=0,c=Math.max(0,Math.floor(t)),d=Math.min(s-1,Math.floor(r)),u=Math.max(0,Math.floor(a)),h=Math.min(l-1,Math.floor(n));for(let s=c;s<=d;s++)for(let l=u;l<=h;l++){let c=Math.max(s,t),d=Math.max(l,a),u=(Math.min(s+1,r)-c)*(Math.min(l+1,n)-d);i+=u,e[s][l]&&(o+=u)}return 0===i?0:o/i}(e.pixels,l,i,o,c);n.push(d>=a)}o.push(n)}let c=s-l,d=n-i,u=0,h=0;r.endsWith("l")?u=0:r.endsWith("c")?u=Math.floor(c/2):r.endsWith("r")&&(u=c),r.startsWith("t")?h=0:r.startsWith("m")?h=Math.floor(d/2):r.startsWith("b")&&(h=d);let x=[];for(let e=0;e<n;e++){let t=[];for(let r=0;r<s;r++){let a=e-h,n=r-u;a>=0&&a<i&&n>=0&&n<l?t.push(o[a][n]):t.push(!1)}x.push(t)}return{pixels:x}}(e,t,r)}function e7({pixels:e,label:t,foregroundColor:r="#ffffff",backgroundColor:a="#000000"}){let n=e.length,s=e[0]?.length||0;return(0,w.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,w.jsx)("span",{className:"text-[9px] text-gray-400 uppercase",children:t}),(0,w.jsx)("div",{className:"border border-gray-600",style:{width:3*s,height:3*n,display:"grid",gridTemplateColumns:`repeat(${s}, 3px)`,gridTemplateRows:`repeat(${n}, 3px)`},children:e.flat().map((e,t)=>(0,w.jsx)("div",{style:{backgroundColor:e?r:a,width:3,height:3}},t))})]})}function te({before:e,after:t,label:r,shortcut:a}){return(0,w.jsxs)("div",{className:"flex flex-col gap-1.5 p-1",children:[(0,w.jsxs)("div",{className:"flex items-center gap-1",children:[(0,w.jsx)("span",{className:"text-xs font-medium",children:r}),a&&(0,w.jsx)("span",{className:"text-gray-400 font-mono text-[10px] bg-gray-700/50 px-1.5 py-0.5 rounded",children:a})]}),(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)(e7,{pixels:e,label:"Before"}),(0,w.jsx)("span",{className:"text-gray-500",children:"→"}),(0,w.jsx)(e7,{pixels:t,label:"After"})]})]})}function tt({className:e="w-5 h-5"}){return(0,w.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}function tr({className:e="w-5 h-5"}){return(0,w.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}function ta({className:e="w-5 h-5"}){return(0,w.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}function tn({className:e="w-5 h-5"}){return(0,w.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}function ts({className:e="w-5 h-5"}){return(0,w.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}function tl({className:e="w-5 h-5"}){return(0,w.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{transform:"scaleX(-1)"},children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}function ti({className:e="w-5 h-5"}){return(0,w.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h8M8 12h8m-8 5h8M4 3v18m16-18v18"})})}function to({className:e="w-5 h-5"}){return(0,w.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 8v8M12 8v8m5-8v8M3 4h18M3 20h18"})})}function tc({className:e="w-5 h-5"}){return(0,w.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}function td({className:e="w-5 h-5"}){return(0,w.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("rect",{x:"4",y:"4",width:"16",height:"16",rx:"1",strokeWidth:2})})}function tu({className:e="w-5 h-5"}){return(0,w.jsx)("svg",{className:e,viewBox:"0 0 24 24",children:(0,w.jsx)("rect",{x:"4",y:"4",width:"16",height:"16",rx:"1",fill:"currentColor"})})}function th({className:e="w-5 h-5"}){return(0,w.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}function tx({className:e="w-5 h-5"}){return(0,w.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}function tm({className:e="w-5 h-5"}){return(0,w.jsxs)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,w.jsx)("circle",{cx:"12",cy:"12",r:"3",strokeWidth:2}),(0,w.jsx)("path",{strokeLinecap:"round",strokeWidth:2,d:"M12 2v4m0 12v4M2 12h4m12 0h4"})]})}function tf({className:e="w-5 h-5"}){return(0,w.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4l4 4m0-4H4v4m16-4l-4 4m4 0V4h-4m-12 16l4-4m-4 0v4h4m12 0l-4-4m4 0v4h-4"})})}function tp({onClick:e,disabled:t,tooltip:r,shortcut:a,previewContent:n,children:s,className:l=""}){return(0,w.jsx)(eW.Tooltip,{content:n||r,shortcut:n?void 0:a,position:"left",children:(0,w.jsx)("button",{onClick:e,disabled:t,className:`
          p-2.5 rounded transition-colors touch-target
          ${t?"text-gray-600 cursor-not-allowed":"text-gray-400 hover:text-retro-cyan hover:bg-retro-purple/30"}
          ${l}
        `,children:s})})}function tg(){return(0,w.jsx)("div",{className:"w-full h-px bg-retro-grid/30 my-1"})}function tb({children:e}){return(0,w.jsx)("div",{className:"text-[10px] text-gray-500 uppercase tracking-wider text-center mb-1",children:e})}function ty({character:e,characterWidth:t=8,characterHeight:r=8,onShift:a,onRotate:n,onFlipHorizontal:s,onFlipVertical:l,onInvert:i,onClear:o,onFill:c,onCenter:d,onScale:u,onDelete:h,onCopy:x,disabled:m=!1,className:f=""}){let p=(0,j.useCallback)(()=>a("up"),[a]),g=(0,j.useCallback)(()=>a("down"),[a]),b=(0,j.useCallback)(()=>a("left"),[a]),y=(0,j.useCallback)(()=>a("right"),[a]),v=(0,j.useCallback)(()=>n("left"),[n]),C=(0,j.useCallback)(()=>n("right"),[n]),k=(0,j.useMemo)(()=>{if(!e)return null;let a=e.pixels;return{shiftUp:(0,w.jsx)(te,{before:a,after:eq(e,"up").pixels,label:"Shift Up",shortcut:"W"}),shiftDown:(0,w.jsx)(te,{before:a,after:eq(e,"down").pixels,label:"Shift Down",shortcut:"S"}),shiftLeft:(0,w.jsx)(te,{before:a,after:eq(e,"left").pixels,label:"Shift Left",shortcut:"A"}),shiftRight:(0,w.jsx)(te,{before:a,after:eq(e,"right").pixels,label:"Shift Right",shortcut:"D"}),rotateLeft:(0,w.jsx)(te,{before:a,after:eX(e,"left").pixels,label:"Rotate Left",shortcut:"Shift+R"}),rotateRight:(0,w.jsx)(te,{before:a,after:eX(e,"right").pixels,label:"Rotate Right",shortcut:"R"}),flipHorizontal:(0,w.jsx)(te,{before:a,after:eZ(e).pixels,label:"Flip Horizontal",shortcut:"H"}),flipVertical:(0,w.jsx)(te,{before:a,after:eQ(e).pixels,label:"Flip Vertical",shortcut:"V"}),invert:(0,w.jsx)(te,{before:a,after:eJ(e).pixels,label:"Invert Colors",shortcut:"I"}),center:(0,w.jsx)(te,{before:a,after:e8(e).pixels,label:"Center Content"}),clear:(0,w.jsx)(te,{before:a,after:R(t,r).pixels,label:"Clear"}),fill:(0,w.jsx)(te,{before:a,after:e1(t,r).pixels,label:"Fill"})}},[e,t,r]);return(0,w.jsxs)("div",{className:`
        flex flex-col items-center py-1 px-2 bg-retro-navy/50 border-l border-retro-grid/30 overflow-hidden
        ${f}
      `,children:[(0,w.jsx)(tb,{children:"Shift"}),(0,w.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,w.jsx)(tp,{onClick:p,disabled:m,tooltip:"Shift Up",shortcut:"W",previewContent:k?.shiftUp,children:(0,w.jsx)(tt,{})}),(0,w.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,w.jsx)(tp,{onClick:b,disabled:m,tooltip:"Shift Left",shortcut:"A",previewContent:k?.shiftLeft,children:(0,w.jsx)(ta,{})}),(0,w.jsx)(tp,{onClick:d||(()=>{}),disabled:m||!d,tooltip:"Center Content",previewContent:k?.center,children:(0,w.jsx)(tm,{})}),(0,w.jsx)(tp,{onClick:y,disabled:m,tooltip:"Shift Right",shortcut:"D",previewContent:k?.shiftRight,children:(0,w.jsx)(tn,{})})]}),(0,w.jsx)(tp,{onClick:g,disabled:m,tooltip:"Shift Down",shortcut:"S",previewContent:k?.shiftDown,children:(0,w.jsx)(tr,{})})]}),(0,w.jsx)(tg,{}),(0,w.jsx)(tb,{children:"Rotate"}),(0,w.jsxs)("div",{className:"flex items-center gap-1",children:[(0,w.jsx)(tp,{onClick:v,disabled:m,tooltip:"Rotate Left",shortcut:"Shift+R",previewContent:k?.rotateLeft,children:(0,w.jsx)(ts,{})}),(0,w.jsx)(tp,{onClick:C,disabled:m,tooltip:"Rotate Right",shortcut:"R",previewContent:k?.rotateRight,children:(0,w.jsx)(tl,{})})]}),(0,w.jsx)(tg,{}),(0,w.jsx)(tb,{children:"Flip"}),(0,w.jsxs)("div",{className:"flex items-center gap-1",children:[(0,w.jsx)(tp,{onClick:s,disabled:m,tooltip:"Flip Horizontal",shortcut:"H",previewContent:k?.flipHorizontal,children:(0,w.jsx)(ti,{})}),(0,w.jsx)(tp,{onClick:l,disabled:m,tooltip:"Flip Vertical",shortcut:"V",previewContent:k?.flipVertical,children:(0,w.jsx)(to,{})})]}),(0,w.jsx)(tg,{}),(0,w.jsx)(tb,{children:"Effects"}),(0,w.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,w.jsx)(tp,{onClick:i,disabled:m,tooltip:"Invert Colors",shortcut:"I",previewContent:k?.invert,children:(0,w.jsx)(tc,{})}),(0,w.jsxs)("div",{className:"flex items-center gap-1",children:[(0,w.jsx)(tp,{onClick:o,disabled:m,tooltip:"Clear",previewContent:k?.clear,children:(0,w.jsx)(td,{})}),(0,w.jsx)(tp,{onClick:c,disabled:m,tooltip:"Fill",previewContent:k?.fill,children:(0,w.jsx)(tu,{})})]})]}),u&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(tg,{}),(0,w.jsx)(tb,{children:"Scale"}),(0,w.jsx)(tp,{onClick:u,disabled:m,tooltip:"Scale Character",children:(0,w.jsx)(tf,{})})]}),(x||h)&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(tg,{}),(0,w.jsx)(tb,{children:"Char"}),(0,w.jsxs)("div",{className:"flex items-center gap-1",children:[x&&(0,w.jsx)(tp,{onClick:x,disabled:m,tooltip:"Copy from character set",shortcut:"C",children:(0,w.jsx)(tx,{})}),h&&(0,w.jsx)(tp,{onClick:h,disabled:m,tooltip:"Delete character",shortcut:"Del",className:"hover:text-red-400",children:(0,w.jsx)(th,{})})]})]})]})}function tv({manufacturer:e,system:t,onManufacturerChange:r,onSystemChange:a,disabled:n=!1,className:s=""}){let[l,i]=(0,j.useState)(!1),[o,c]=(0,j.useState)(!1),[d,u]=(0,j.useState)(""),[h,x]=(0,j.useState)(""),m=(0,j.useMemo)(()=>eh.map(e=>e.manufacturer),[]),f=(0,j.useMemo)(()=>{let t;return e?(t=eh.find(t=>t.manufacturer.toLowerCase()===e.toLowerCase()),t?.systems||[]):[]},[e]),p=e&&!m.includes(e),g=t&&!f.includes(t),b=(0,j.useCallback)(e=>{let t=e.target.value;"__custom__"===t?(i(!0),u("")):(r(t),a(""),i(!1))},[r,a]),y=(0,j.useCallback)(()=>{d.trim()&&(r(d.trim()),a(""),i(!1),u(""))},[d,r,a]),v=(0,j.useCallback)(()=>{i(!1),u("")},[]),C=(0,j.useCallback)(e=>{let t=e.target.value;"__custom__"===t?(c(!0),x("")):(a(t),c(!1))},[a]),k=(0,j.useCallback)(()=>{h.trim()&&(a(h.trim()),c(!1),x(""))},[h,a]),N=(0,j.useCallback)(()=>{c(!1),x("")},[]),S=(0,j.useCallback)((e,t)=>{"Enter"===e.key?(e.preventDefault(),t()):"Escape"===e.key&&(e.preventDefault(),l&&v(),o&&N())},[l,o,v,N]),M=`
    w-full px-3 py-2 bg-retro-navy/50 border border-retro-grid/50 rounded-lg
    text-sm text-gray-200 focus:outline-none focus:border-retro-cyan/50
    transition-colors disabled:opacity-50 disabled:cursor-not-allowed
  `,R=`
    flex-1 px-3 py-2 bg-retro-navy/50 border border-retro-grid/50 rounded-lg
    text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:border-retro-cyan/50
    transition-colors
  `,L=`
    px-3 py-2 text-sm rounded-lg transition-colors
  `;return(0,w.jsxs)("div",{className:`space-y-4 ${s}`,children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Manufacturer"}),l?(0,w.jsxs)("div",{className:"flex gap-2",children:[(0,w.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),onKeyDown:e=>S(e,y),placeholder:"Enter manufacturer name...",className:R,autoFocus:!0,disabled:n}),(0,w.jsx)("button",{onClick:y,disabled:n||!d.trim(),className:`${L} bg-retro-cyan/20 text-retro-cyan hover:bg-retro-cyan/30 disabled:opacity-50`,children:"Add"}),(0,w.jsx)("button",{onClick:v,disabled:n,className:`${L} bg-retro-grid/20 text-gray-400 hover:bg-retro-grid/30`,children:"Cancel"})]}):(0,w.jsxs)("select",{value:p?"":e,onChange:b,disabled:n,className:M,children:[(0,w.jsx)("option",{value:"",children:"Select manufacturer..."}),m.map(e=>(0,w.jsx)("option",{value:e,children:e},e)),(0,w.jsx)("option",{value:"__custom__",children:"Other (custom)..."}),p&&(0,w.jsxs)("option",{value:e,disabled:!0,children:[e," (custom)"]})]}),p&&!l&&(0,w.jsxs)("div",{className:"mt-1.5 flex items-center gap-2",children:[(0,w.jsxs)("span",{className:"text-xs text-gray-500",children:["Custom: ",(0,w.jsx)("span",{className:"text-retro-cyan",children:e})]}),(0,w.jsx)("button",{onClick:()=>{r(""),a("")},className:"text-xs text-gray-500 hover:text-retro-pink",disabled:n,children:"Clear"})]})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:"System"}),o?(0,w.jsxs)("div",{className:"flex gap-2",children:[(0,w.jsx)("input",{type:"text",value:h,onChange:e=>x(e.target.value),onKeyDown:e=>S(e,k),placeholder:"Enter system name...",className:R,autoFocus:!0,disabled:n}),(0,w.jsx)("button",{onClick:k,disabled:n||!h.trim(),className:`${L} bg-retro-cyan/20 text-retro-cyan hover:bg-retro-cyan/30 disabled:opacity-50`,children:"Add"}),(0,w.jsx)("button",{onClick:N,disabled:n,className:`${L} bg-retro-grid/20 text-gray-400 hover:bg-retro-grid/30`,children:"Cancel"})]}):(0,w.jsxs)("select",{value:g?"":t,onChange:C,disabled:n||!e,className:M,children:[(0,w.jsx)("option",{value:"",children:e?"Select system...":"Select a manufacturer first..."}),f.map(e=>(0,w.jsx)("option",{value:e,children:e},e)),e&&(0,w.jsx)("option",{value:"__custom__",children:"Other (custom)..."}),g&&(0,w.jsxs)("option",{value:t,disabled:!0,children:[t," (custom)"]})]}),g&&!o&&(0,w.jsxs)("div",{className:"mt-1.5 flex items-center gap-2",children:[(0,w.jsxs)("span",{className:"text-xs text-gray-500",children:["Custom: ",(0,w.jsx)("span",{className:"text-retro-cyan",children:t})]}),(0,w.jsx)("button",{onClick:()=>a(""),className:"text-xs text-gray-500 hover:text-retro-pink",disabled:n,children:"Clear"})]})]})]})}function tw({isOpen:e,onClose:t,metadata:r,onSave:a}){let[n,s]=(0,j.useState)(r.name),[l,i]=(0,j.useState)(r.description),[o,c]=(0,j.useState)(r.source),[d,u]=(0,j.useState)(r.manufacturer),[h,x]=(0,j.useState)(r.system),[m,f]=(0,j.useState)(r.chip),[p,g]=(0,j.useState)(r.locale),[b,y]=(0,j.useState)(r.isPinned??!1),[v,C]=(0,j.useState)(!1),k=(0,j.useMemo)(()=>{if(h){let e=eu.filter(e=>e.usedIn.some(e=>e.toLowerCase()===h.toLowerCase()));if(e.length>0)return e}return eu},[h]);(0,j.useEffect)(()=>{e&&(s(r.name),i(r.description),c(r.source),u(r.manufacturer),x(r.system),f(r.chip),g(r.locale),y(r.isPinned??!1))},[e,r]);let N=async()=>{if(n.trim()){C(!0);try{await a({name:n.trim(),description:l.trim(),source:o.trim()||"yourself",manufacturer:d,system:h,chip:m,locale:p.trim(),isPinned:b}),t()}finally{C(!1)}}};return e?(0,w.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,w.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,w.jsxs)("div",{className:"relative w-full max-w-md bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-retro-grid/30",children:[(0,w.jsx)("h2",{className:"text-lg font-medium text-white",children:"Edit Metadata"}),(0,w.jsx)("button",{onClick:t,className:"p-1 text-gray-400 hover:text-white transition-colors",children:(0,w.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,w.jsxs)("div",{className:"p-4 space-y-4",children:[(0,w.jsxs)("div",{children:[(0,w.jsxs)("label",{className:"block text-sm text-gray-300 mb-1",children:["Name ",(0,w.jsx)("span",{className:"text-retro-pink",children:"*"})]}),(0,w.jsx)("input",{type:"text",value:n,onChange:e=>s(e.target.value),placeholder:"Character set name",className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-retro-cyan",autoFocus:!0})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Description"}),(0,w.jsx)("textarea",{value:l,onChange:e=>i(e.target.value),placeholder:"Optional description",rows:2,className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-retro-cyan resize-none"})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Manufacturer & System"}),(0,w.jsx)(tv,{manufacturer:d,system:h,onManufacturerChange:u,onSystemChange:x})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"ROM Chip (IC)"}),(0,w.jsxs)("select",{value:m,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white focus:outline-none focus:border-retro-cyan",children:[(0,w.jsx)("option",{value:"",children:"Select a chip..."}),k.map(e=>(0,w.jsxs)("option",{value:e.partNumber,children:[e.partNumber," (",e.manufacturer,")"]},e.id))]}),h&&k.length<eu.length&&(0,w.jsxs)("p",{className:"text-[10px] text-gray-500 mt-1",children:["Showing chips compatible with ",h]})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Locale"}),(0,w.jsx)("input",{type:"text",value:p,onChange:e=>g(e.target.value),placeholder:"e.g., English, German, Japanese",className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-retro-cyan"})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Source / Attribution"}),(0,w.jsx)("input",{type:"text",value:o,onChange:e=>c(e.target.value),placeholder:"yourself",className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-retro-cyan"})]}),(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300",children:"Pin to top"}),(0,w.jsx)("p",{className:"text-xs text-gray-500",children:"Pinned items appear first in search results"})]}),(0,w.jsx)("button",{type:"button",onClick:()=>y(!b),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-retro-cyan focus:ring-offset-2 focus:ring-offset-retro-dark ${b?"bg-retro-pink border-retro-pink":"bg-retro-purple/50 border-retro-purple"}`,role:"switch","aria-checked":b,children:(0,w.jsx)("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full shadow ring-0 transition duration-200 ease-in-out ${b?"translate-x-5 bg-white":"translate-x-0 bg-gray-400"}`})})]})]}),(0,w.jsxs)("div",{className:"flex gap-3 p-4 border-t border-retro-grid/30",children:[(0,w.jsx)("button",{onClick:t,className:"flex-1 px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,w.jsx)("button",{onClick:N,disabled:!n.trim()||v,className:"flex-1 px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:v?"Saving...":"Save"})]})]})]}):null}e.s(["EditorHeader",()=>e_],87355),e.s(["EditorFooter",()=>eU],45835),e.s(["createEditorShortcuts",()=>eV,"formatShortcut",()=>eK,"useKeyboardShortcuts",()=>eH],93585),e.s(["KeyboardShortcutsHelp",()=>eG],43237),e.s(["batchTogglePixel",()=>e6,"batchTransform",()=>e5,"centerCharacter",()=>e8,"clearCharacter",()=>e0,"fillCharacter",()=>e1,"flipHorizontal",()=>eZ,"flipVertical",()=>eQ,"getPixelState",()=>e3,"invertCharacter",()=>eJ,"resizeCharacter",()=>eY,"rotateCharacter",()=>eX,"scaleCharacter",()=>e9,"setPixel",()=>e4,"shiftCharacter",()=>eq,"togglePixel",()=>e2],20371),e.s(["TransformToolbar",()=>ty],99401),e.s(["ManufacturerSystemSelect",()=>tv],87188),e.s(["MetadataEditModal",()=>tw],16244);let tj=eo();function tC({value:e,onChange:t,label:r="Anchor Position",description:a}){return(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:r}),a&&(0,w.jsx)("p",{className:"text-xs text-gray-500 mb-3",children:a}),(0,w.jsx)("div",{className:"grid grid-cols-3 gap-1 w-32 mx-auto",children:tj.map(r=>{let a=e===r;return(0,w.jsx)("button",{type:"button",onClick:()=>t(r),className:`
                w-10 h-10 rounded border-2 transition-all
                flex items-center justify-center
                ${a?"border-retro-amber bg-retro-amber/20":"border-retro-grid/50 bg-retro-dark hover:border-retro-grid"}
              `,title:ec(r),children:(0,w.jsx)("div",{className:`
                  w-3 h-3 rounded-sm transition-colors
                  ${a?"bg-retro-amber":"bg-gray-600"}
                `})},r)})})]})}function tk({isOpen:e,onClose:t,currentWidth:r,currentHeight:a,onResize:n}){let[s,l]=(0,j.useState)(r),[i,o]=(0,j.useState)(a),[c,d]=(0,j.useState)("tl"),u=(0,j.useCallback)(()=>{s>0&&i>0&&(n(s,i,c),t())},[s,i,c,n,t]),h=(0,j.useCallback)(e=>{"Escape"===e.key?t():"Enter"===e.key&&u()},[t,u]);if(!e)return null;let x=s!==r||i!==a;return(0,w.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onKeyDown:h,children:[(0,w.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,w.jsxs)("div",{className:"relative w-full max-w-sm bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl p-6",children:[(0,w.jsx)("h2",{className:"text-lg font-medium text-white mb-4",children:"Resize Characters"}),(0,w.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Width"}),(0,w.jsx)("input",{type:"number",min:1,max:32,value:s,onChange:e=>l(Math.max(1,Math.min(32,parseInt(e.target.value)||1))),className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white focus:outline-none focus:border-retro-cyan",autoFocus:!0})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Height"}),(0,w.jsx)("input",{type:"number",min:1,max:32,value:i,onChange:e=>o(Math.max(1,Math.min(32,parseInt(e.target.value)||1))),className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white focus:outline-none focus:border-retro-cyan"})]})]}),(0,w.jsx)("div",{className:"mb-6",children:(0,w.jsx)(tC,{value:c,onChange:d,description:"Select where to anchor existing content when resizing"})}),(0,w.jsx)("p",{className:"text-xs text-gray-500 mb-4 text-center h-4",children:x?s>r||i>a?"New pixels will be added with background color":s<r||i<a?"Some pixels will be cropped":"No changes":"No changes"}),(0,w.jsxs)("div",{className:"flex gap-3",children:[(0,w.jsx)("button",{onClick:t,className:"flex-1 px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,w.jsx)("button",{onClick:u,disabled:!x||s<1||i<1,className:"flex-1 px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Apply"})]})]})]})}function tN({name:e,onNameChange:t,description:r,onDescriptionChange:a,manufacturer:n,onManufacturerChange:s,system:l,onSystemChange:i,locale:o,onLocaleChange:c,source:d,onSourceChange:u,title:h="Character Set Details",subtitle:x="Add information about this character set"}){return(0,w.jsxs)("div",{className:"space-y-6",children:[(0,w.jsxs)("div",{className:"text-center mb-6",children:[(0,w.jsx)("h2",{className:"text-lg font-medium text-gray-200 mb-2",children:h}),(0,w.jsx)("p",{className:"text-sm text-gray-400",children:x})]}),(0,w.jsxs)("div",{className:"card-retro p-6 space-y-6",children:[(0,w.jsxs)("div",{children:[(0,w.jsxs)("label",{htmlFor:"metadata-name",className:"block text-sm font-medium text-gray-300 mb-1.5",children:["Name ",(0,w.jsx)("span",{className:"text-retro-pink",children:"*"})]}),(0,w.jsx)("input",{type:"text",id:"metadata-name",value:e,onChange:e=>t(e.target.value),placeholder:"My Character Set",className:"w-full px-4 py-2 bg-retro-navy/50 border border-retro-grid/50 rounded-lg text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:border-retro-cyan/50"})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{htmlFor:"metadata-description",className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Description"}),(0,w.jsx)("textarea",{id:"metadata-description",value:r,onChange:e=>a(e.target.value),placeholder:"Optional description...",rows:2,className:"w-full px-4 py-2 bg-retro-navy/50 border border-retro-grid/50 rounded-lg text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:border-retro-cyan/50 resize-none"})]}),(0,w.jsx)(tv,{manufacturer:n,system:l,onManufacturerChange:s,onSystemChange:i}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{htmlFor:"metadata-locale",className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Locale"}),(0,w.jsx)("input",{type:"text",id:"metadata-locale",value:o,onChange:e=>c(e.target.value),placeholder:"e.g., English, German, Japanese",className:"w-full px-4 py-2 bg-retro-navy/50 border border-retro-grid/50 rounded-lg text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:border-retro-cyan/50"})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{htmlFor:"metadata-source",className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Source"}),(0,w.jsx)("input",{type:"text",id:"metadata-source",value:d,onChange:e=>u(e.target.value),placeholder:"Where did this ROM come from?",className:"w-full px-4 py-2 bg-retro-navy/50 border border-retro-grid/50 rounded-lg text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:border-retro-cyan/50"})]})]})]})}function tS({currentWidth:e,currentHeight:t,onSelect:r,className:a=""}){return(0,w.jsx)(ev,{currentWidth:e,currentHeight:t,onSelect:r,className:a})}function tM({currentCount:e,onSelect:t,presets:r=el,disabled:a=!1,className:n=""}){let s=(0,j.useRef)(null),[l,i]=(0,j.useState)(r.length),[o,c]=(0,j.useState)(!1),d=(0,j.useRef)(null),u=[...r].sort((e,t)=>t.priority-e.priority),h=(0,j.useCallback)(()=>{s.current&&i(Math.max(2,Math.min(Math.floor((s.current.offsetWidth-56-8+8)/56),r.length)))},[r.length]);(0,j.useEffect)(()=>{h();let e=new ResizeObserver(()=>{h()});return s.current&&e.observe(s.current),()=>e.disconnect()},[h]),(0,j.useEffect)(()=>{function e(e){d.current&&!d.current.contains(e.target)&&c(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let x=function(){let e={};for(let t of ef)e[t.manufacturer]||(e[t.manufacturer]=[]),e[t.manufacturer].push(t);return e}(),m=function(){let e={};for(let t of ey)e[t.manufacturer]||(e[t.manufacturer]=[]),e[t.manufacturer].push(t);return e}(),f=e=>{t(e.count),c(!1)},p=[],g=[],b=new Set(u.slice(0,l).map(e=>e.label));for(let e of r)b.has(e.label)?p.push(e):g.push(e);return(0,w.jsx)("div",{ref:s,className:`relative ${n}`,children:(0,w.jsxs)("div",{className:"flex flex-wrap gap-2",children:[p.map(t=>(0,w.jsx)("button",{type:"button",onClick:()=>f(t),disabled:a,title:t.description?t.examples.length>0?`${t.description} - ${t.examples.join(", ")}`:t.description:t.examples.length>0?t.examples.join(", "):void 0,className:`
              px-3 py-1 text-xs rounded border transition-colors
              ${e===t.count?"border-retro-pink bg-retro-pink/10 text-retro-pink":"border-retro-grid/50 text-gray-400 hover:border-retro-grid"}
              disabled:opacity-50
            `,children:t.label},t.label)),(0,w.jsxs)("div",{ref:d,className:"relative",children:[(0,w.jsxs)("button",{type:"button",onClick:()=>c(!o),disabled:a,className:"px-3 py-1 text-xs rounded border border-retro-grid/50 text-gray-400 hover:border-retro-grid flex items-center gap-1 disabled:opacity-50",children:["More",(0,w.jsx)("svg",{className:`w-3 h-3 transition-transform ${o?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),o&&(0,w.jsxs)("div",{className:"absolute z-50 left-0 top-full mt-1 w-72 max-h-96 overflow-y-auto bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl",children:[g.length>0&&(0,w.jsxs)("div",{className:"p-2 border-b border-retro-grid/30",children:[(0,w.jsx)("div",{className:"text-[10px] text-gray-500 uppercase mb-1",children:"Other Counts"}),(0,w.jsx)("div",{className:"flex flex-wrap gap-1",children:g.map(t=>(0,w.jsx)("button",{onClick:()=>f(t),disabled:a,title:t.description,className:`
                          px-2 py-1 text-xs rounded transition-colors
                          ${e===t.count?"bg-retro-pink/20 text-retro-pink":"text-gray-400 hover:bg-retro-grid/20"}
                          disabled:opacity-50
                        `,children:t.label},t.label))})]}),Object.keys(x).length>0&&(0,w.jsx)("div",{className:"px-2 pt-2 pb-1",children:(0,w.jsx)("div",{className:"text-[10px] text-retro-cyan uppercase font-medium",children:"Systems"})}),Object.entries(x).filter(([,e])=>e.length>0).map(([r,n])=>(0,w.jsxs)("div",{className:"px-2 pb-2",children:[(0,w.jsx)("div",{className:"text-[10px] text-gray-500 uppercase mb-1",children:r}),(0,w.jsx)("div",{className:"flex flex-wrap gap-1",children:n.map(r=>(0,w.jsx)("button",{onClick:()=>{t(r.count),c(!1)},disabled:a,title:`${r.count} characters`,className:`
                            px-2 py-1 text-xs rounded transition-colors
                            ${e===r.count?"bg-retro-amber/20 text-retro-amber":"text-gray-400 hover:bg-retro-grid/20"}
                            disabled:opacity-50
                          `,children:r.system},`${r.system}-${r.count}`))})]},r)),Object.keys(m).length>0&&(0,w.jsx)("div",{className:"border-t border-retro-grid/30"}),Object.keys(m).length>0&&(0,w.jsx)("div",{className:"px-2 pt-2 pb-1",children:(0,w.jsx)("div",{className:"text-[10px] text-retro-cyan uppercase font-medium",children:"Character ROM ICs"})}),Object.entries(m).filter(([,e])=>e.length>0).map(([r,n])=>(0,w.jsxs)("div",{className:"px-2 pb-2",children:[(0,w.jsx)("div",{className:"text-[10px] text-gray-500 uppercase mb-1",children:r}),(0,w.jsx)("div",{className:"flex flex-wrap gap-1",children:n.map(r=>(0,w.jsx)("button",{onClick:()=>{t(r.count),c(!1)},disabled:a,title:r.usedIn.length>0?`${r.count} chars - Used in: ${r.usedIn.join(", ")}`:`${r.count} characters`,className:`
                            px-2 py-1 text-xs rounded transition-colors
                            ${e===r.count?"bg-retro-purple/20 text-retro-purple":"text-gray-400 hover:bg-retro-grid/20"}
                            disabled:opacity-50
                          `,children:r.partNumber},`${r.id}-${r.count}`))})]},`rom-${r}`))]})]})]})})}function tR({currentCount:e,onSelect:t,className:r=""}){return(0,w.jsx)(tM,{currentCount:e,onSelect:t,className:r})}e.s(["ResizeModal",()=>tk],46628),e.s(["MetadataStep",()=>tN],24111),e.s(["SizePresetDropdown",()=>tS],38910),e.s(["CharacterCountPresetSelector",()=>tM],96935),e.s(["CharacterCountPresetDropdown",()=>tR],56859),e.s([],4246),e.s([],45497);let tL="character-sets",tE="snapshots",tA="retrostack-character-sets",tD=new class{db=null;initialized=!1;initPromise=null;async initialize(){if(!this.initialized){if(this.initPromise)return this.initPromise;this.initPromise=this._initialize(),await this.initPromise,this.initialized=!0}}async _initialize(){return!function(){try{return!!window.indexedDB}catch{return!1}}()?void console.log("IndexedDB not available, using localStorage fallback"):new Promise(e=>{let t=indexedDB.open("retrostack-character-editor",5);t.onerror=()=>{console.error("Failed to open IndexedDB, using localStorage fallback"),e()},t.onsuccess=()=>{this.db=t.result,e()},t.onupgradeneeded=e=>{let t=e.target.result,r=e.target.transaction,a=e.oldVersion;if(t.objectStoreNames.contains(tL)){if(a<2){let e=r.objectStore(tL);e.indexNames.contains("by-manufacturer")||e.createIndex("by-manufacturer","metadata.manufacturer",{unique:!1}),e.indexNames.contains("by-system")||e.createIndex("by-system","metadata.system",{unique:!1}),e.openCursor().onsuccess=e=>{let t=e.target.result;if(t){let e=t.value;e.metadata&&void 0===e.metadata.manufacturer&&(e.metadata.manufacturer=""),e.metadata&&void 0===e.metadata.system&&(e.metadata.system=""),t.update(e),t.continue()}}}if(a<3&&(r.objectStore(tL).openCursor().onsuccess=e=>{let t=e.target.result;if(t){let e=t.value;e.metadata&&void 0===e.metadata.isPinned&&(e.metadata.isPinned=!1),t.update(e),t.continue()}}),a<4){let e=r.objectStore(tL);e.indexNames.contains("by-locale")||e.createIndex("by-locale","metadata.locale",{unique:!1}),e.openCursor().onsuccess=e=>{let t=e.target.result;if(t){let e=t.value;e.metadata&&void 0===e.metadata.locale&&(e.metadata.locale=""),t.update(e),t.continue()}}}}else{let e=t.createObjectStore(tL,{keyPath:"metadata.id"});e.createIndex("by-name","metadata.name",{unique:!1}),e.createIndex("by-updated","metadata.updatedAt",{unique:!1}),e.createIndex("by-size","sizeKey",{unique:!1}),e.createIndex("by-manufacturer","metadata.manufacturer",{unique:!1}),e.createIndex("by-system","metadata.system",{unique:!1}),e.createIndex("by-locale","metadata.locale",{unique:!1})}if(!t.objectStoreNames.contains(tE)){let e=t.createObjectStore(tE,{keyPath:"id"});e.createIndex("by-character-set","characterSetId",{unique:!1}),e.createIndex("by-created","createdAt",{unique:!1})}}})}useFallback(){return null===this.db}fallbackGetAll(){try{let e=localStorage.getItem(tA);if(!e)return[];return JSON.parse(e).map(e=>({...e,metadata:{...e.metadata,manufacturer:e.metadata.manufacturer??"",system:e.metadata.system??"",locale:e.metadata.locale??"",isPinned:e.metadata.isPinned??!1}}))}catch{return[]}}fallbackSaveAll(e){try{localStorage.setItem(tA,JSON.stringify(e))}catch(e){throw console.error("Failed to save to localStorage:",e),Error("Storage quota exceeded")}}async getAll(){return(await this.initialize(),this.useFallback())?this.fallbackGetAll():new Promise((e,t)=>{let r=this.db.transaction([tL],"readonly").objectStore(tL).getAll();r.onsuccess=()=>{let t=r.result;t.sort((e,t)=>{let r=+!!e.metadata.isPinned,a=+!!t.metadata.isPinned;return r!==a?a-r:t.metadata.updatedAt-e.metadata.updatedAt}),e(t)},r.onerror=()=>{t(Error("Failed to get character sets"))}})}async getById(e){return(await this.initialize(),this.useFallback())?this.fallbackGetAll().find(t=>t.metadata.id===e)||null:new Promise((t,r)=>{let a=this.db.transaction([tL],"readonly").objectStore(tL).get(e);a.onsuccess=()=>{t(a.result||null)},a.onerror=()=>{r(Error("Failed to get character set"))}})}async save(e){await this.initialize();let t={...e,sizeKey:`${e.config.width}x${e.config.height}`};if(this.useFallback()){let t=this.fallbackGetAll(),r=t.findIndex(t=>t.metadata.id===e.metadata.id);return r>=0?t[r]=e:t.push(e),this.fallbackSaveAll(t),e.metadata.id}return new Promise((r,a)=>{let n=this.db.transaction([tL],"readwrite").objectStore(tL).put(t);n.onsuccess=()=>{r(e.metadata.id)},n.onerror=()=>{a(Error("Failed to save character set"))}})}async saveAs(e,t){let r=A(),a=Date.now(),n={...e,metadata:{...e.metadata,id:r,name:t,createdAt:a,updatedAt:a,isBuiltIn:!1,source:"yourself"}};return await this.save(n),r}async togglePinned(e){await this.initialize();let t=await this.getById(e);if(!t)throw Error("Character set not found");let r=!t.metadata.isPinned,a={...t,metadata:{...t.metadata,isPinned:r}};return await this.save(a),r}async delete(e){if(await this.initialize(),this.useFallback()){let t=this.fallbackGetAll().filter(t=>t.metadata.id!==e);this.fallbackSaveAll(t);return}return new Promise((t,r)=>{let a=this.db.transaction([tL],"readwrite").objectStore(tL).delete(e);a.onsuccess=()=>{t()},a.onerror=()=>{r(Error("Failed to delete character set"))}})}async search(e){let t=await this.getAll(),r=e.toLowerCase();return t.filter(e=>e.metadata.name.toLowerCase().includes(r)||e.metadata.description.toLowerCase().includes(r)||e.metadata.source.toLowerCase().includes(r)||e.metadata.manufacturer.toLowerCase().includes(r)||e.metadata.system.toLowerCase().includes(r)||e.metadata.locale.toLowerCase().includes(r))}async filterBySize(e,t){return(await this.getAll()).filter(r=>(null===e||r.config.width===e)&&(null===t||r.config.height===t))}async filterByManufacturers(e){if(0===e.length)return this.getAll();let t=await this.getAll(),r=e.map(e=>e.toLowerCase());return t.filter(e=>r.includes(e.metadata.manufacturer.toLowerCase()))}async filterBySystems(e){if(0===e.length)return this.getAll();let t=await this.getAll(),r=e.map(e=>e.toLowerCase());return t.filter(e=>r.includes(e.metadata.system.toLowerCase()))}async getAvailableManufacturers(){let e=await this.getAll(),t=new Set;for(let r of e)r.metadata.manufacturer&&t.add(r.metadata.manufacturer);return Array.from(t).sort()}async getAvailableSystems(){let e=await this.getAll(),t=new Set;for(let r of e)r.metadata.system&&t.add(r.metadata.system);return Array.from(t).sort()}async getAvailableSizes(){let e=await this.getAll(),t=new Map;for(let r of e){let e=`${r.config.width}x${r.config.height}`;t.has(e)||t.set(e,{width:r.config.width,height:r.config.height})}return Array.from(t.values()).sort((e,t)=>e.width!==t.width?e.width-t.width:e.height-t.height)}async nameExists(e,t){return(await this.getAll()).some(r=>r.metadata.name.toLowerCase()===e.toLowerCase()&&r.metadata.id!==t)}async count(){return(await this.getAll()).length}async isEmpty(){return 0===(await this.getAll()).length}async clear(){return(await this.initialize(),this.useFallback())?void localStorage.removeItem(tA):new Promise((e,t)=>{let r=this.db.transaction([tL],"readwrite").objectStore(tL).clear();r.onsuccess=()=>{e()},r.onerror=()=>{t(Error("Failed to clear storage"))}})}};async function tI(){return await tD.initialize(),tD.db}var tz=e.i(2163);let tB=[];function tO(){return tB.filter(e=>e.enabled)}let tF=tz.default;function tT(e){let t=Date.now();return{metadata:{id:e.id,name:e.name,description:e.description||`${e.system} character set`,source:e.source||"RetroStack",manufacturer:e.manufacturer,system:e.system,chip:e.chip,locale:e.locale,createdAt:t,updatedAt:t,isBuiltIn:!0},config:{width:e.width,height:e.height,padding:e.bitPadding??"right",bitDirection:e.bitDirection},binaryData:B(function(e){let t=new Uint8Array(e.reduce((e,t)=>e+t.length,0)),r=0;for(let a of e)for(let e of a)t[r++]=e;return t}(e.data))}}let t$=new Map;async function tP(e){if(t$.has(e.url))return t$.get(e.url)??null;try{let t=await fetch(e.url);if(!t.ok)return console.warn(`Failed to fetch external charsets from ${e.name}: ${t.status}`),t$.set(e.url,null),null;let r=await t.json();if(!Array.isArray(r))return console.warn(`Invalid format from ${e.name}: expected array of character sets`),t$.set(e.url,null),null;let a=r.filter(e=>"object"==typeof e&&null!==e&&"string"==typeof e.id&&"string"==typeof e.name&&"number"==typeof e.width&&"number"==typeof e.height&&Array.isArray(e.data));return t$.set(e.url,a),a}catch(t){return console.warn(`Error fetching external charsets from ${e.name}:`,t),t$.set(e.url,null),null}}async function tW(){let e=tO();if(0===e.length)return[];let t=await Promise.all(e.map(tP)),r=[];for(let e of t)if(e)for(let t of e)r.push(t.id);return r}async function t_(e){let t=tO();if(0===t.length)return null;for(let r of(await Promise.all(t.map(tP))))if(r){let t=r.find(t=>t.id===e);if(t)return tT(t)}return null}function tU(){let[e,t]=(0,j.useState)([]),[r,a]=(0,j.useState)(!0),[n,s]=(0,j.useState)(null),[l,i]=(0,j.useState)([]),o=(0,j.useCallback)(async()=>{try{a(!0),s(null),await tD.initialize();let e=await tD.getAll(),r=new Set(e.map(e=>e.metadata.id)),n=tF.map(e=>e.id).filter(e=>!r.has(e));if(n.length>0)for(let e of n){let t=function(e){let t=tF.find(t=>t.id===e);return t?tT(t):null}(e);t&&await tD.save(t)}let l=(await tW()).filter(e=>!r.has(e));if(l.length>0)for(let e of l){let t=await t_(e);t&&await tD.save(t)}let o=n.length>0||l.length>0?await tD.getAll():e;t(o);let c=await tD.getAvailableSizes();i(c)}catch(e){s(e instanceof Error?e.message:"Failed to load library")}finally{a(!1)}},[]);(0,j.useEffect)(()=>{o()},[o]);let c=(0,j.useCallback)(async()=>{await o()},[o]),d=(0,j.useCallback)(async e=>{try{let t=await tD.getById(e);if(!t)return null;return T(t)}catch(e){return console.error("Failed to get character set:",e),null}},[]),u=(0,j.useCallback)(async e=>{try{let t=F(e),r=await tD.save(t);return await c(),r}catch(e){throw Error(e instanceof Error?e.message:"Failed to save character set")}},[c]),h=(0,j.useCallback)(async(e,t)=>{try{let r={...e,metadata:{...e.metadata,id:A(),name:t,createdAt:Date.now(),updatedAt:Date.now(),isBuiltIn:!1,source:"yourself"}},a=F(r),n=await tD.save(a);return await c(),n}catch(e){throw Error(e instanceof Error?e.message:"Failed to save character set")}},[c]),x=(0,j.useCallback)(async(e,t)=>{try{let r=await tD.getById(e);if(!r)throw Error("Character set not found");let a={...r,metadata:{...r.metadata,name:t,updatedAt:Date.now()}};await tD.save(a),await c()}catch(e){throw Error(e instanceof Error?e.message:"Failed to rename character set")}},[c]),m=(0,j.useCallback)(async e=>{try{await tD.delete(e),await c()}catch(e){throw Error(e instanceof Error?e.message:"Failed to delete character set")}},[c]),f=(0,j.useCallback)(async e=>{try{await tD.togglePinned(e),await c()}catch(e){throw Error(e instanceof Error?e.message:"Failed to toggle pinned state")}},[c]),p=(0,j.useCallback)(async t=>t.trim()?tD.search(t):e,[e]),g=(0,j.useCallback)(async(t,r)=>null===t&&null===r?e:tD.filterBySize(t,r),[e]);return{characterSets:e,loading:r,error:n,refresh:c,getById:d,save:u,saveAs:h,rename:x,deleteSet:m,togglePinned:f,search:p,filterBySize:g,availableSizes:l,nameExists:(0,j.useCallback)(async(e,t)=>tD.nameExists(e,t),[])}}function tH(e){return JSON.parse(JSON.stringify(e))}function tK(e){let{state:t,setState:r,resetState:a,undo:n,redo:s,canUndo:l,canRedo:i,history:o,historyIndex:c,jumpToHistory:d,totalHistoryEntries:u,startBatch:h,endBatch:x}=function(e,t=1/0){let[r,a]=(0,j.useState)([]),[n,s]=(0,j.useState)([]),[l,i]=(0,j.useState)({state:e,label:"Initial state",timestamp:Date.now()}),o=(0,j.useRef)(!1),c=(0,j.useRef)(null),d=(0,j.useCallback)((e,r)=>{o.current||(a(e=>{let r=[...e,l];return r.length>t&&(r=r.slice(-t)),r}),s([])),i({state:e,label:r,timestamp:Date.now()})},[l,t]),u=(0,j.useCallback)(()=>{o.current||(c.current=l,o.current=!0)},[l]),h=(0,j.useCallback)(e=>{o.current&&c.current&&(JSON.stringify(c.current.state)!==JSON.stringify(l.state)&&(a(e=>{let r=[...e,c.current];return r.length>t&&(r=r.slice(-t)),r}),s([]),i(t=>({...t,label:e||t.label}))),c.current=null,o.current=!1)},[l,t]),x=(0,j.useCallback)(e=>{a([]),s([]),i({state:e,label:"Initial state",timestamp:Date.now()})},[]),m=(0,j.useCallback)(()=>{a(e=>{if(0===e.length)return e;let t=e[e.length-1],r=e.slice(0,-1);return s(e=>[l,...e]),i(t),r})},[l]),f=(0,j.useCallback)(()=>{s(e=>{if(0===e.length)return e;let t=e[0],r=e.slice(1);return a(e=>[...e,l]),i(t),r})},[l]),p=(0,j.useCallback)(()=>{a([]),s([])},[]),g=(0,j.useMemo)(()=>[...r,l,...n],[r,l,n]),b=r.length+1+n.length,y=r.length,v=(0,j.useCallback)(e=>{let t=Math.max(0,Math.min(e,r.length+1+n.length-1));if(t===r.length)return;let o=[...r,l,...n],c=o[t],d=o.slice(0,t),u=o.slice(t+1);a(d),i(c),s(u)},[r,l,n]);return{state:l.state,setState:d,resetState:x,undo:m,redo:f,canUndo:r.length>0,canRedo:n.length>0,historyLength:r.length+n.length,clearHistory:p,history:g,historyIndex:y,jumpToHistory:v,totalHistoryEntries:b,startBatch:u,endBatch:h,isBatching:o.current}}(e?{characters:e.characters.map(L),config:{...e.config}}:{characters:[],config:{width:8,height:8,padding:"right",bitDirection:"ltr"}}),[m,f]=(0,j.useState)(0),[p,g]=(0,j.useState)(new Set),[b,y]=(0,j.useState)(!1),[,v]=(0,j.useState)(null),w=(0,j.useMemo)(()=>{let e=new Set(p);return e.add(m),e},[m,p]),C=(0,j.useCallback)((e,a)=>{r(e(tH(t)),a),y(!0)},[t,r]),[k,N]=(0,j.useState)(null),S=(0,j.useCallback)((e,t,r=!1)=>{if(r)g(t=>{let r=new Set(t);if(e===m){if(r.size>0){let[e]=r;r.delete(e),r.add(m),f(e)}}else r.has(e)?r.delete(e):r.add(e);return r});else if(t){let t=k??m,r=Math.min(t,e),a=Math.max(t,e),n=new Set;for(let e=r;e<=a;e++)n.add(e);f(e),n.delete(e),g(n)}else f(e),N(e),g(new Set)},[m,k]),M=(0,j.useCallback)(()=>{g(new Set)},[]),E=(0,j.useCallback)(()=>{g(new Set(Array.from({length:t.characters.length},(e,t)=>t)))},[t.characters.length]),A=(0,j.useCallback)((e,t)=>{C(r=>{if(w.size>1)r.characters=e6(r.characters,w,e,t);else{let a=r.characters[m];a&&(r.characters[m]=e2(a,e,t))}return r})},[C,m,w]),D=(0,j.useCallback)((e,t,r)=>{C(a=>{for(let n of w){let s=a.characters[n];s&&(a.characters[n]=e4(s,e,t,r))}return a})},[C,w]),I=(0,j.useCallback)((e,r)=>e3(t.characters,w,e,r),[t.characters,w]),z=(0,j.useCallback)(e=>{C(t=>(t.characters=e5(t.characters,w,t=>eX(t,e)),t))},[C,w]),B=(0,j.useCallback)((e,t=!0)=>{C(r=>(r.characters=e5(r.characters,w,r=>eq(r,e,t)),r))},[C,w]),O=(0,j.useCallback)(()=>{C(e=>(e.characters=e5(e.characters,w,eJ),e))},[C,w]),F=(0,j.useCallback)(()=>{C(e=>(e.characters=e5(e.characters,w,eZ),e))},[C,w]),T=(0,j.useCallback)(()=>{C(e=>(e.characters=e5(e.characters,w,eQ),e))},[C,w]),$=(0,j.useCallback)(()=>{C(e=>{let{width:t,height:r}=e.config;return e.characters=e5(e.characters,w,()=>R(t,r)),e})},[C,w]),P=(0,j.useCallback)(()=>{C(e=>{let{width:t,height:r}=e.config;return e.characters=e5(e.characters,w,()=>({pixels:Array.from({length:r},()=>Array(t).fill(!0))})),e})},[C,w]),W=(0,j.useCallback)(()=>{C(e=>(e.characters=e5(e.characters,w,e8),e))},[C,w]),_=(0,j.useCallback)((e,t,r)=>{C(a=>(a.characters=e5(a.characters,w,a=>e9(a,e,t,r)),a))},[C,w]),U=(0,j.useCallback)(()=>{C(e=>{let{width:t,height:r}=e.config;return e.characters=[...e.characters,R(t,r)],e}),f(t.characters.length),g(new Set)},[C,t.characters.length]),H=(0,j.useCallback)(e=>{0!==e.length&&(C(t=>(t.characters=[...t.characters,...e.map(e=>L(e))],t)),f(t.characters.length),g(new Set))},[C,t.characters.length]),K=(0,j.useCallback)(()=>{t.characters.length<=1||(C(e=>(e.characters=e.characters.filter((e,t)=>!w.has(t)),e)),f(Math.min(m,t.characters.length-w.size-1)),g(new Set))},[C,w,t.characters.length,m]),V=(0,j.useCallback)((e,t)=>{C(r=>{let a=r.characters[e];return a&&t>=0&&t<r.characters.length&&(r.characters[t]=L(a)),r})},[C]),G=(0,j.useCallback)((e,t,r)=>{C(a=>(a.characters=a.characters.map(a=>eY(a,e,t,r)),a.config={...a.config,width:e,height:t},a))},[C]),X=(0,j.useCallback)((e,t)=>{C(r=>(e>=0&&e<r.characters.length&&(r.characters[e]=L(t)),r))},[C]),q=(0,j.useCallback)(e=>{C(t=>(t.characters=e.map(L),t))},[C]),Y=(0,j.useCallback)(()=>{y(!1),v(tH(t))},[t]),J=(0,j.useCallback)(e=>{a({characters:e.characters.map(L),config:{...e.config}}),f(0),N(null),g(new Set),y(!1),v(null)},[a]);return{characters:t.characters,config:t.config,selectedIndex:m,setSelectedIndex:f,batchSelection:p,toggleBatchSelection:S,clearBatchSelection:M,selectAll:E,toggleSelectedPixel:A,setSelectedPixel:D,getSelectedPixelState:I,rotateSelected:z,shiftSelected:B,invertSelected:O,flipSelectedHorizontal:F,flipSelectedVertical:T,clearSelected:$,fillSelected:P,centerSelected:W,scaleSelected:_,selectedIndices:w,addCharacter:U,addCharacters:H,deleteSelected:K,copyCharacter:V,resizeCharacters:G,updateCharacter:X,setCharacters:q,undo:n,redo:s,canUndo:l,canRedo:i,isDirty:b,markSaved:Y,reset:J,history:o,historyIndex:c,jumpToHistory:d,totalHistoryEntries:u,startBatch:h,endBatch:x}}e.s(["useCharacterLibrary",()=>tU],66811),e.s(["useCharacterEditor",()=>tK],83621);let tV="character-editor-autosave";function tG(e){let{characterSetId:t,characters:r,config:a,selectedIndex:n,isDirty:s,enabled:l=!0}=e,[i,o]=(0,j.useState)(null),c=(0,j.useRef)(0),d=(0,j.useRef)(null);(0,j.useEffect)(()=>{if(t)try{let e=localStorage.getItem(tV);if(e){let r=JSON.parse(e);r.characterSetId===t&&r.isDirty&&o(r)}}catch{}},[t]);let u=(0,j.useCallback)(()=>{if(t&&l&&0!==r.length)try{let e=B(z(r,a)),l={characterSetId:t,binaryData:e,config:a,selectedIndex:n,timestamp:Date.now(),isDirty:s};localStorage.setItem(tV,JSON.stringify(l)),c.current=Date.now()}catch(e){console.error("Auto-save failed:",e)}},[t,r,a,n,s,l]);(0,j.useEffect)(()=>{if(l&&s&&t)return d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{u()},Math.max(0,3e4-(Date.now()-c.current))),()=>{d.current&&clearTimeout(d.current)}},[l,s,t,u]),(0,j.useEffect)(()=>{if(!l||!s)return;let e=e=>{u(),e.preventDefault(),e.returnValue=""};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[l,s,u]);let h=(0,j.useCallback)(()=>(o(null),i),[i]);return{hasRecoveryData:null!==i,recoveryData:i,recover:h,discard:(0,j.useCallback)(()=>{o(null);try{localStorage.removeItem(tV)}catch{}},[]),clearAutoSave:(0,j.useCallback)(()=>{try{localStorage.removeItem(tV)}catch{}},[]),saveNow:u}}e.s(["useAutoSave",()=>tG],54750);let tX="snapshots";async function tq(){let e=await tI();if(!e)throw Error("Database not available - storage may be disabled in your browser");return e}async function tY(e){let t=await tq();if((await tJ(e.characterSetId)).length>=10)throw Error("Maximum of 10 snapshots per character set. Delete an existing snapshot first.");return new Promise((r,a)=>{let n=t.transaction([tX],"readwrite").objectStore(tX).put(e);n.onsuccess=()=>r(),n.onerror=()=>a(Error("Failed to save snapshot"))})}async function tJ(e){let t=await tq();return new Promise((r,a)=>{let n=t.transaction([tX],"readonly").objectStore(tX).index("by-character-set").getAll(e);n.onsuccess=()=>{let e=n.result;e.sort((e,t)=>t.createdAt-e.createdAt),r(e)},n.onerror=()=>{a(Error("Failed to get snapshots"))}})}async function tZ(e){let t=await tq();return new Promise((r,a)=>{let n=t.transaction([tX],"readonly").objectStore(tX).get(e);n.onsuccess=()=>{r(n.result||null)},n.onerror=()=>{a(Error("Failed to get snapshot"))}})}async function tQ(e){let t=await tq();return new Promise((r,a)=>{let n=t.transaction([tX],"readwrite").objectStore(tX).delete(e);n.onsuccess=()=>r(),n.onerror=()=>a(Error("Failed to delete snapshot"))})}async function t0(e,t){let r=await tq(),a=await tZ(e);if(!a)throw Error("Snapshot not found");let n={...a,name:t};return new Promise((e,t)=>{let a=r.transaction([tX],"readwrite").objectStore(tX).put(n);a.onsuccess=()=>e(),a.onerror=()=>t(Error("Failed to rename snapshot"))})}function t1(e){let{characterSetId:t,enabled:r=!0}=e,[a,n]=(0,j.useState)([]),[s,l]=(0,j.useState)(!1),[i,o]=(0,j.useState)(null),c=(0,j.useCallback)(async()=>{if(!t||!r)return void n([]);l(!0),o(null);try{let e=await tJ(t);n(e)}catch(e){console.error("Failed to load snapshots:",e),o(e instanceof Error?e.message:"Failed to load snapshots"),n([])}finally{l(!1)}},[t,r]);(0,j.useEffect)(()=>{c()},[c]);let d=(0,j.useCallback)(async(e,r,a)=>{if(!t)return o("No character set ID"),!1;try{let n,s=(n=B(z(r,a)),{id:A(),characterSetId:t,name:e,createdAt:Date.now(),binaryData:n,config:a,characterCount:r.length});return await tY(s),await c(),!0}catch(e){return console.error("Failed to save snapshot:",e),o(e instanceof Error?e.message:"Failed to save snapshot"),!1}},[t,c]),u=(0,j.useCallback)(async e=>{try{let t=a.find(t=>t.id===e);if(!t)return o("Snapshot not found"),null;return I(O(t.binaryData),t.config)}catch(e){return console.error("Failed to restore snapshot:",e),o(e instanceof Error?e.message:"Failed to restore snapshot"),null}},[a]);return{snapshots:a,loading:s,error:i,saveNewSnapshot:d,restore:u,remove:(0,j.useCallback)(async e=>{try{return await tQ(e),await c(),!0}catch(e){return console.error("Failed to delete snapshot:",e),o(e instanceof Error?e.message:"Failed to delete snapshot"),!1}},[c]),rename:(0,j.useCallback)(async(e,t)=>{try{return await t0(e,t),await c(),!0}catch(e){return console.error("Failed to rename snapshot:",e),o(e instanceof Error?e.message:"Failed to rename snapshot"),!1}},[c]),refresh:c,isAtCapacity:a.length>=10,maxSnapshots:10}}e.s(["useSnapshots",()=>t1],69771),e.s([],7259);let t2=["tl","tc","tr","ml","mc","mr","bl","bc","br"];function t4({isOpen:e,onClose:t,currentConfig:r,onImport:a}){let{characterSets:n,loading:s}=tU(),[l,i]=(0,j.useState)("select-set"),[o,c]=(0,j.useState)(null),[d,u]=(0,j.useState)(""),[h,x]=(0,j.useState)(new Set),[m,f]=(0,j.useState)(null),[p,g]=(0,j.useState)("tl");(0,j.useEffect)(()=>{e||(i("select-set"),c(null),u(""),x(new Set),f(null),g("tl"))},[e]);let b=(0,j.useMemo)(()=>o&&n.find(e=>e.metadata.id===o)||null,[n,o]),y=(0,j.useMemo)(()=>{if(!b)return[];try{return T(b).characters}catch{return[]}},[b]),v=(0,j.useMemo)(()=>!!b&&(r.width!==b.config.width||r.height!==b.config.height),[b,r]),C=(0,j.useMemo)(()=>{if(!d.trim())return n;let e=d.toLowerCase();return n.filter(t=>t.metadata.name.toLowerCase().includes(e)||t.metadata.description.toLowerCase().includes(e))},[n,d]),k=(0,j.useCallback)(e=>{c(e.metadata.id)},[]),N=(0,j.useCallback)((e,t,r)=>{x(a=>{let n=new Set(a);if(t&&null!==m){let t=Math.min(m,e),r=Math.max(m,e);for(let e=t;e<=r;e++)n.add(e)}else r?n.has(e)?n.delete(e):n.add(e):(n.clear(),n.add(e));return n}),f(e)},[m]),S=(0,j.useCallback)(()=>{x(new Set(y.map((e,t)=>t)))},[y]),M=(0,j.useCallback)(()=>{x(new Set)},[]),R=(0,j.useCallback)(()=>{"resize"===l?i("select-chars"):"select-chars"===l&&(i("select-set"),x(new Set))},[l]),L=(0,j.useCallback)(()=>{"select-set"===l&&o?i("select-chars"):"select-chars"===l&&h.size>0&&(v?i("resize"):(a(Array.from(h).sort((e,t)=>e-t).map(e=>y[e])),t()))},[l,o,h,v,y,a,t]),E=(0,j.useCallback)(()=>{let e=Array.from(h).sort((e,t)=>e-t).map(e=>y[e]);v&&(e=e.map(e=>eY(e,r.width,r.height,p))),a(e),t()},[h,y,v,r,p,a,t]),A=(0,j.useCallback)(e=>{"Escape"===e.key&&t()},[t]);return e?(0,w.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onKeyDown:A,children:[(0,w.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,w.jsxs)("div",{className:"relative w-full max-w-2xl max-h-[80vh] bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl flex flex-col overflow-hidden",children:[(0,w.jsxs)("div",{className:"flex-shrink-0 p-4 border-b border-retro-grid/30",children:[(0,w.jsx)("h2",{className:"text-lg font-medium text-white",children:"Import Characters"}),(0,w.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["select-set"===l&&"Select a character set to import from","select-chars"===l&&`Select characters to import (${h.size} selected)`,"resize"===l&&"Configure resize settings"]})]}),(0,w.jsxs)("div",{className:"flex-1 overflow-hidden p-4 flex flex-col min-h-0",children:["select-set"===l&&(0,w.jsxs)("div",{className:"flex flex-col flex-1 min-h-0 gap-4",children:[(0,w.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,w.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),placeholder:"Search...",className:"w-full px-3 py-2 pl-9 bg-retro-dark border border-retro-grid/50 rounded text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:border-retro-cyan/50",autoFocus:!0}),(0,w.jsx)("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,w.jsx)("div",{className:"space-y-2 flex-1 overflow-y-auto min-h-0",children:s?(0,w.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):0===C.length?(0,w.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No character sets found"}):C.map(e=>(0,w.jsx)(X,{characterSet:e,selected:o===e.metadata.id,onClick:()=>k(e)},e.metadata.id))}),b&&(0,w.jsxs)("div",{className:"flex-shrink-0 text-xs text-gray-500 text-center pt-2 border-t border-retro-grid/30",children:["Source: ",_(b.config)," (",y.length," chars)",v&&(0,w.jsxs)("span",{className:"text-yellow-500 ml-2",children:["(will be resized to ",_(r),")"]})]})]}),"select-chars"===l&&b&&(0,w.jsxs)("div",{className:"flex flex-col flex-1 min-h-0 gap-4",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between flex-shrink-0",children:[(0,w.jsx)("div",{className:"text-xs text-gray-500",children:"Click to select, Shift+click for range, Ctrl+click to toggle"}),(0,w.jsxs)("div",{className:"flex gap-2",children:[(0,w.jsx)("button",{onClick:S,className:"text-xs text-retro-cyan hover:underline",children:"Select All"}),(0,w.jsx)("button",{onClick:M,className:"text-xs text-gray-400 hover:underline",children:"Clear"})]})]}),(0,w.jsx)("div",{className:"bg-black/30 rounded-lg p-3 flex-1 overflow-y-auto min-h-0",children:(0,w.jsx)("div",{className:"grid gap-1",style:{gridTemplateColumns:`repeat(auto-fill, minmax(${Math.max(3*b.config.width,24)+8}px, 1fr))`},children:y.map((e,t)=>{let r=h.has(t);return(0,w.jsx)("button",{onClick:e=>N(t,e.shiftKey,e.ctrlKey||e.metaKey),className:`
                          p-1 rounded border-2 transition-all
                          ${r?"border-retro-cyan bg-retro-cyan/20":"border-transparent hover:border-retro-grid/50"}
                        `,title:`Character ${t}`,children:(0,w.jsx)(eC.CharacterDisplay,{character:e,mode:"small",smallScale:3})},t)})})})]}),"resize"===l&&b&&(0,w.jsxs)("div",{className:"space-y-6",children:[(0,w.jsxs)("div",{className:"text-center",children:[(0,w.jsx)("p",{className:"text-sm text-gray-300 mb-2",children:"Source dimensions differ from target"}),(0,w.jsxs)("p",{className:"text-xs text-gray-500",children:[_(b.config)," → ",_(r)]})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300 mb-2 text-center",children:"Anchor Position"}),(0,w.jsx)("p",{className:"text-xs text-gray-500 mb-3 text-center",children:"Select where to anchor content when resizing"}),(0,w.jsx)("div",{className:"grid grid-cols-3 gap-1 w-32 mx-auto",children:t2.map(e=>{let t=p===e;return(0,w.jsx)("button",{type:"button",onClick:()=>g(e),className:`
                          w-10 h-10 rounded border-2 transition-all
                          flex items-center justify-center
                          ${t?"border-retro-cyan bg-retro-cyan/20":"border-retro-grid/50 bg-retro-dark hover:border-retro-grid"}
                        `,title:{tl:"Top Left",tc:"Top Center",tr:"Top Right",ml:"Middle Left",mc:"Middle Center",mr:"Middle Right",bl:"Bottom Left",bc:"Bottom Center",br:"Bottom Right"}[e],children:(0,w.jsx)("div",{className:`
                            w-3 h-3 rounded-sm transition-colors
                            ${t?"bg-retro-cyan":"bg-gray-600"}
                          `})},e)})})]}),(0,w.jsxs)("p",{className:"text-xs text-gray-500 text-center",children:[h.size," character",1!==h.size?"s":""," will be imported and resized"]})]})]}),(0,w.jsxs)("div",{className:"flex-shrink-0 p-4 border-t border-retro-grid/30 flex justify-between",children:["select-set"===l?(0,w.jsx)("button",{onClick:t,className:"px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}):(0,w.jsx)("button",{onClick:R,className:"px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Back"}),"resize"===l?(0,w.jsxs)("button",{onClick:E,className:"px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors",children:["Import (",h.size,")"]}):(0,w.jsx)("button",{onClick:L,disabled:"select-set"===l&&!o||"select-chars"===l&&0===h.size,className:"px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"select-chars"!==l||v?"Next":`Import (${h.size})`})]})]})]}):null}function t5({isOpen:e,onClose:t,characters:r,currentIndex:a,onCopy:n}){let[s,l]=(0,j.useState)(null);(0,j.useEffect)(()=>{e||l(null)},[e]);let i=(0,j.useCallback)(e=>{l(e)},[]),o=(0,j.useCallback)(()=>{null!==s&&(n(s),t())},[s,n,t]),c=(0,j.useCallback)(e=>{"Escape"===e.key?t():"Enter"===e.key&&null!==s&&o()},[t,s,o]);return e?(0,w.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onKeyDown:c,children:[(0,w.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,w.jsxs)("div",{className:"relative w-full max-w-lg max-h-[70vh] bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl flex flex-col overflow-hidden",children:[(0,w.jsxs)("div",{className:"flex-shrink-0 p-4 border-b border-retro-grid/30",children:[(0,w.jsx)("h2",{className:"text-lg font-medium text-white",children:"Copy Character"}),(0,w.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Select a character to copy. It will replace the currently selected character(s)."})]}),(0,w.jsxs)("div",{className:"flex-1 overflow-y-auto p-4",children:[(0,w.jsx)("div",{className:"bg-black/30 rounded-lg p-3",children:(0,w.jsx)("div",{className:"grid gap-2",style:{gridTemplateColumns:"repeat(auto-fill, minmax(40px, 1fr))"},children:r.map((e,t)=>{let r=s===t,n=t===a;return(0,w.jsxs)("button",{onClick:()=>i(t),disabled:n,className:`
                      p-1.5 rounded border-2 transition-all relative
                      ${r?"border-retro-cyan bg-retro-cyan/20":n?"border-retro-pink/30 bg-retro-pink/10 opacity-50 cursor-not-allowed":"border-transparent hover:border-retro-grid/50"}
                    `,title:n?"Current selection":`Character ${t}`,children:[(0,w.jsx)(eC.CharacterDisplay,{character:e,mode:"small",smallScale:3}),n&&(0,w.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,w.jsx)("span",{className:"text-[8px] text-retro-pink bg-retro-dark/80 px-1 rounded",children:"current"})})]},t)})})}),null!==s&&(0,w.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-3",children:["Character ",s," selected"]})]}),(0,w.jsxs)("div",{className:"flex-shrink-0 p-4 border-t border-retro-grid/30 flex justify-between",children:[(0,w.jsx)("button",{onClick:t,className:"px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,w.jsx)("button",{onClick:o,disabled:null===s,className:"px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Copy"})]})]})]}):null}e.s(["ImportCharactersModal",()=>t4],78071),e.s(["CopyCharacterModal",()=>t5],35052);var t3=e.i(74080);let t6="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function t8(e){let t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function t9(e){return"nodeType"in e}function t7(e){var t,r;return e?t8(e)?e:t9(e)&&null!=(t=null==(r=e.ownerDocument)?void 0:r.defaultView)?t:window:window}function re(e){let{Document:t}=t7(e);return e instanceof t}function rt(e){return!t8(e)&&e instanceof t7(e).HTMLElement}function rr(e){return e instanceof t7(e).SVGElement}function ra(e){return e?t8(e)?e.document:t9(e)?re(e)?e:rt(e)||rr(e)?e.ownerDocument:document:document:document}let rn=t6?j.useLayoutEffect:j.useEffect;function rs(e){let t=(0,j.useRef)(e);return rn(()=>{t.current=e}),(0,j.useCallback)(function(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return null==t.current?void 0:t.current(...r)},[])}function rl(e,t){void 0===t&&(t=[e]);let r=(0,j.useRef)(e);return rn(()=>{r.current!==e&&(r.current=e)},t),r}function ri(e,t){let r=(0,j.useRef)();return(0,j.useMemo)(()=>{let t=e(r.current);return r.current=t,t},[...t])}function ro(e){let t=rs(e),r=(0,j.useRef)(null),a=(0,j.useCallback)(e=>{e!==r.current&&(null==t||t(e,r.current)),r.current=e},[]);return[r,a]}function rc(e){let t=(0,j.useRef)();return(0,j.useEffect)(()=>{t.current=e},[e]),t.current}let rd={};function ru(e,t){return(0,j.useMemo)(()=>{if(t)return t;let r=null==rd[e]?0:rd[e]+1;return rd[e]=r,e+"-"+r},[e,t])}function rh(e){return function(t){for(var r=arguments.length,a=Array(r>1?r-1:0),n=1;n<r;n++)a[n-1]=arguments[n];return a.reduce((t,r)=>{for(let[a,n]of Object.entries(r)){let r=t[a];null!=r&&(t[a]=r+e*n)}return t},{...t})}}let rx=rh(1),rm=rh(-1);function rf(e){if(!e)return!1;let{KeyboardEvent:t}=t7(e.target);return t&&e instanceof t}function rp(e){if(function(e){if(!e)return!1;let{TouchEvent:t}=t7(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){let{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){let{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return"clientX"in e&&"clientY"in e?{x:e.clientX,y:e.clientY}:null}let rg=Object.freeze({Translate:{toString(e){if(!e)return;let{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;let{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[rg.Translate.toString(e),rg.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:a}=e;return t+" "+r+"ms "+a}}}),rb="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]",ry={display:"none"};function rv(e){let{id:t,value:r}=e;return j.default.createElement("div",{id:t,style:ry},r)}function rw(e){let{id:t,announcement:r,ariaLiveType:a="assertive"}=e;return j.default.createElement("div",{id:t,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":a,"aria-atomic":!0},r)}let rj=(0,j.createContext)(null),rC={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},rk={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function rN(e){var t;let r,{announcements:a=rk,container:n,hiddenTextDescribedById:s,screenReaderInstructions:l=rC}=e,{announce:i,announcement:o}=function(){let[e,t]=(0,j.useState)("");return{announce:(0,j.useCallback)(e=>{null!=e&&t(e)},[]),announcement:e}}(),c=ru("DndLiveRegion"),[d,u]=(0,j.useState)(!1);if((0,j.useEffect)(()=>{u(!0)},[]),t=(0,j.useMemo)(()=>({onDragStart(e){let{active:t}=e;i(a.onDragStart({active:t}))},onDragMove(e){let{active:t,over:r}=e;a.onDragMove&&i(a.onDragMove({active:t,over:r}))},onDragOver(e){let{active:t,over:r}=e;i(a.onDragOver({active:t,over:r}))},onDragEnd(e){let{active:t,over:r}=e;i(a.onDragEnd({active:t,over:r}))},onDragCancel(e){let{active:t,over:r}=e;i(a.onDragCancel({active:t,over:r}))}}),[i,a]),r=(0,j.useContext)(rj),(0,j.useEffect)(()=>{if(!r)throw Error("useDndMonitor must be used within a children of <DndContext>");return r(t)},[t,r]),!d)return null;let h=j.default.createElement(j.default.Fragment,null,j.default.createElement(rv,{id:s,value:l.draggable}),j.default.createElement(rw,{id:c,announcement:o}));return n?(0,t3.createPortal)(h,n):h}function rS(){}function rM(e,t){return(0,j.useMemo)(()=>({sensor:e,options:null!=t?t:{}}),[e,t])}(r=u||(u={})).DragStart="dragStart",r.DragMove="dragMove",r.DragEnd="dragEnd",r.DragCancel="dragCancel",r.DragOver="dragOver",r.RegisterDroppable="registerDroppable",r.SetDroppableDisabled="setDroppableDisabled",r.UnregisterDroppable="unregisterDroppable";let rR=Object.freeze({x:0,y:0});function rL(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function rE(e,t){let{data:{value:r}}=e,{data:{value:a}}=t;return r-a}function rA(e,t){let{data:{value:r}}=e,{data:{value:a}}=t;return a-r}function rD(e){let{left:t,top:r,height:a,width:n}=e;return[{x:t,y:r},{x:t+n,y:r},{x:t,y:r+a},{x:t+n,y:r+a}]}function rI(e,t){if(!e||0===e.length)return null;let[r]=e;return t?r[t]:r}function rz(e,t,r){return void 0===t&&(t=e.left),void 0===r&&(r=e.top),{x:t+.5*e.width,y:r+.5*e.height}}let rB=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e,n=rz(t,t.left,t.top),s=[];for(let e of a){let{id:t}=e,a=r.get(t);if(a){let r=rL(rz(a),n);s.push({id:t,data:{droppableContainer:e,value:r}})}}return s.sort(rE)},rO=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e,n=[];for(let e of a){let{id:a}=e,s=r.get(a);if(s){let r=function(e,t){let r=Math.max(t.top,e.top),a=Math.max(t.left,e.left),n=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height);if(a<n&&r<s){let l=t.width*t.height,i=e.width*e.height,o=(n-a)*(s-r);return Number((o/(l+i-o)).toFixed(4))}return 0}(s,t);r>0&&n.push({id:a,data:{droppableContainer:e,value:r}})}}return n.sort(rA)};function rF(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:rR}let rT=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return r.reduce((e,t)=>({...e,top:e.top+ +t.y,bottom:e.bottom+ +t.y,left:e.left+ +t.x,right:e.right+ +t.x}),{...e})};function r$(e){if(e.startsWith("matrix3d(")){let t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){let t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}let rP={ignoreTransform:!1};function rW(e,t){void 0===t&&(t=rP);let r=e.getBoundingClientRect();if(t.ignoreTransform){let{transform:t,transformOrigin:a}=t7(e).getComputedStyle(e);t&&(r=function(e,t,r){let a=r$(t);if(!a)return e;let{scaleX:n,scaleY:s,x:l,y:i}=a,o=e.left-l-(1-n)*parseFloat(r),c=e.top-i-(1-s)*parseFloat(r.slice(r.indexOf(" ")+1)),d=n?e.width/n:e.width,u=s?e.height/s:e.height;return{width:d,height:u,top:c,right:o+d,bottom:c+u,left:o}}(r,t,a))}let{top:a,left:n,width:s,height:l,bottom:i,right:o}=r;return{top:a,left:n,width:s,height:l,bottom:i,right:o}}function r_(e){return rW(e,{ignoreTransform:!0})}function rU(e,t){let r=[];return e?function a(n){var s,l;let i;if(null!=t&&r.length>=t||!n)return r;if(re(n)&&null!=n.scrollingElement&&!r.includes(n.scrollingElement))return r.push(n.scrollingElement),r;if(!rt(n)||rr(n)||r.includes(n))return r;let o=t7(e).getComputedStyle(n);return(n!==e&&(void 0===(s=o)&&(s=t7(n).getComputedStyle(n)),i=/(auto|scroll|overlay)/,["overflow","overflowX","overflowY"].some(e=>{let t=s[e];return"string"==typeof t&&i.test(t)}))&&r.push(n),void 0===(l=o)&&(l=t7(n).getComputedStyle(n)),"fixed"===l.position)?r:a(n.parentNode)}(e):r}function rH(e){let[t]=rU(e,1);return null!=t?t:null}function rK(e){return t6&&e?t8(e)?e:t9(e)?re(e)||e===ra(e).scrollingElement?window:rt(e)?e:null:null:null}function rV(e){return t8(e)?e.scrollX:e.scrollLeft}function rG(e){return t8(e)?e.scrollY:e.scrollTop}function rX(e){return{x:rV(e),y:rG(e)}}function rq(e){return!!t6&&!!e&&e===document.scrollingElement}function rY(e){let t={x:0,y:0},r=rq(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},a={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},n=e.scrollTop<=t.y,s=e.scrollLeft<=t.x;return{isTop:n,isLeft:s,isBottom:e.scrollTop>=a.y,isRight:e.scrollLeft>=a.x,maxScroll:a,minScroll:t}}(a=h||(h={}))[a.Forward=1]="Forward",a[a.Backward=-1]="Backward";let rJ={x:.2,y:.2};function rZ(e){return e.reduce((e,t)=>rx(e,rX(t)),rR)}function rQ(e,t){if(void 0===t&&(t=rW),!e)return;let{top:r,left:a,bottom:n,right:s}=t(e);rH(e)&&(n<=0||s<=0||r>=window.innerHeight||a>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}let r0=[["x",["left","right"],function(e){return e.reduce((e,t)=>e+rV(t),0)}],["y",["top","bottom"],function(e){return e.reduce((e,t)=>e+rG(t),0)}]];class r1{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=rU(t),a=rZ(r);for(const[t,n,s]of(this.rect={...e},this.width=e.width,this.height=e.height,r0))for(const e of n)Object.defineProperty(this,e,{get:()=>{let n=s(r),l=a[t]-n;return this.rect[e]+l},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class r2{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)})},this.target=e}add(e,t,r){var a;null==(a=this.target)||a.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function r4(e,t){let r=Math.abs(e.x),a=Math.abs(e.y);return"number"==typeof t?Math.sqrt(r**2+a**2)>t:"x"in t&&"y"in t?r>t.x&&a>t.y:"x"in t?r>t.x:"y"in t&&a>t.y}function r5(e){e.preventDefault()}function r3(e){e.stopPropagation()}(n=x||(x={})).Click="click",n.DragStart="dragstart",n.Keydown="keydown",n.ContextMenu="contextmenu",n.Resize="resize",n.SelectionChange="selectionchange",n.VisibilityChange="visibilitychange",(s=m||(m={})).Space="Space",s.Down="ArrowDown",s.Right="ArrowRight",s.Left="ArrowLeft",s.Up="ArrowUp",s.Esc="Escape",s.Enter="Enter",s.Tab="Tab";let r6={start:[m.Space,m.Enter],cancel:[m.Esc],end:[m.Space,m.Enter,m.Tab]},r8=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case m.Right:return{...r,x:r.x+25};case m.Left:return{...r,x:r.x-25};case m.Down:return{...r,y:r.y+25};case m.Up:return{...r,y:r.y-25}}};class r9{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new r2(ra(t)),this.windowListeners=new r2(t7(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(x.Resize,this.handleCancel),this.windowListeners.add(x.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(x.Keydown,this.handleKeyDown))}handleStart(){let{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&rQ(r),t(rR)}handleKeyDown(e){if(rf(e)){let{active:t,context:r,options:a}=this.props,{keyboardCodes:n=r6,coordinateGetter:s=r8,scrollBehavior:l="smooth"}=a,{code:i}=e;if(n.end.includes(i))return void this.handleEnd(e);if(n.cancel.includes(i))return void this.handleCancel(e);let{collisionRect:o}=r.current,c=o?{x:o.left,y:o.top}:rR;this.referenceCoordinates||(this.referenceCoordinates=c);let d=s(e,{active:t,context:r.current,currentCoordinates:c});if(d){let t=rm(d,c),a={x:0,y:0},{scrollableAncestors:n}=r.current;for(let r of n){let n=e.code,{isTop:s,isRight:i,isLeft:o,isBottom:c,maxScroll:u,minScroll:h}=rY(r),x=function(e){if(e===document.scrollingElement){let{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}let{top:t,left:r,right:a,bottom:n}=e.getBoundingClientRect();return{top:t,left:r,right:a,bottom:n,width:e.clientWidth,height:e.clientHeight}}(r),f={x:Math.min(n===m.Right?x.right-x.width/2:x.right,Math.max(n===m.Right?x.left:x.left+x.width/2,d.x)),y:Math.min(n===m.Down?x.bottom-x.height/2:x.bottom,Math.max(n===m.Down?x.top:x.top+x.height/2,d.y))},p=n===m.Right&&!i||n===m.Left&&!o,g=n===m.Down&&!c||n===m.Up&&!s;if(p&&f.x!==d.x){let e=r.scrollLeft+t.x,s=n===m.Right&&e<=u.x||n===m.Left&&e>=h.x;if(s&&!t.y)return void r.scrollTo({left:e,behavior:l});s?a.x=r.scrollLeft-e:a.x=n===m.Right?r.scrollLeft-u.x:r.scrollLeft-h.x,a.x&&r.scrollBy({left:-a.x,behavior:l});break}if(g&&f.y!==d.y){let e=r.scrollTop+t.y,s=n===m.Down&&e<=u.y||n===m.Up&&e>=h.y;if(s&&!t.x)return void r.scrollTo({top:e,behavior:l});s?a.y=r.scrollTop-e:a.y=n===m.Down?r.scrollTop-u.y:r.scrollTop-h.y,a.y&&r.scrollBy({top:-a.y,behavior:l});break}}this.handleMove(e,rx(rm(d,this.referenceCoordinates),a))}}}handleMove(e,t){let{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){let{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){let{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function r7(e){return!!(e&&"distance"in e)}function ae(e){return!!(e&&"delay"in e)}r9.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:a=r6,onActivation:n}=t,{active:s}=r,{code:l}=e.nativeEvent;if(a.start.includes(l)){let t=s.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==n||n({event:e.nativeEvent}),!0)}return!1}}];class at{constructor(e,t,r){var a;void 0===r&&(r=function(e){let{EventTarget:t}=t7(e);return e instanceof t?e:ra(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:n}=e,{target:s}=n;this.props=e,this.events=t,this.document=ra(s),this.documentListeners=new r2(this.document),this.listeners=new r2(r),this.windowListeners=new r2(t7(s)),this.initialCoordinates=null!=(a=rp(n))?a:rR,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){let{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(x.Resize,this.handleCancel),this.windowListeners.add(x.DragStart,r5),this.windowListeners.add(x.VisibilityChange,this.handleCancel),this.windowListeners.add(x.ContextMenu,r5),this.documentListeners.add(x.Keydown,this.handleKeydown),t){if(null!=r&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(ae(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(r7(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){let{active:r,onPending:a}=this.props;a(r,e,this.initialCoordinates,t)}handleStart(){let{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(x.Click,r3,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(x.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;let{activated:r,initialCoordinates:a,props:n}=this,{onMove:s,options:{activationConstraint:l}}=n;if(!a)return;let i=null!=(t=rp(e))?t:rR,o=rm(a,i);if(!r&&l){if(r7(l)){if(null!=l.tolerance&&r4(o,l.tolerance))return this.handleCancel();if(r4(o,l.distance))return this.handleStart()}return ae(l)&&r4(o,l.tolerance)?this.handleCancel():void this.handlePending(l,o)}e.cancelable&&e.preventDefault(),s(i)}handleEnd(){let{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){let{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===m.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}let ar={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class aa extends at{constructor(e){const{event:t}=e;super(e,ar,ra(t.target))}}aa.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:a}=t;return!!r.isPrimary&&0===r.button&&(null==a||a({event:r}),!0)}}];(l=f||(f={}))[l.RightClick=2]="RightClick";(i=p||(p={}))[i.Pointer=0]="Pointer",i[i.DraggableRect=1]="DraggableRect",(o=g||(g={}))[o.TreeOrder=0]="TreeOrder",o[o.ReversedTreeOrder=1]="ReversedTreeOrder";let an={x:{[h.Backward]:!1,[h.Forward]:!1},y:{[h.Backward]:!1,[h.Forward]:!1}};(c=b||(b={}))[c.Always=0]="Always",c[c.BeforeDragging=1]="BeforeDragging",c[c.WhileDragging=2]="WhileDragging",(y||(y={})).Optimized="optimized";let as=new Map;function al(e,t){return ri(r=>e?r||("function"==typeof t?t(e):e):null,[t,e])}function ai(e){let{callback:t,disabled:r}=e,a=rs(t),n=(0,j.useMemo)(()=>{if(r||"undefined"==typeof window||void 0===window.ResizeObserver)return;let{ResizeObserver:e}=window;return new e(a)},[r]);return(0,j.useEffect)(()=>()=>null==n?void 0:n.disconnect(),[n]),n}function ao(e){return new r1(rW(e),e)}function ac(e,t,r){void 0===t&&(t=ao);let[a,n]=(0,j.useState)(null);function s(){n(a=>{if(!e)return null;if(!1===e.isConnected){var n;return null!=(n=null!=a?a:r)?n:null}let s=t(e);return JSON.stringify(a)===JSON.stringify(s)?a:s})}let l=function(e){let{callback:t,disabled:r}=e,a=rs(t),n=(0,j.useMemo)(()=>{if(r||"undefined"==typeof window||void 0===window.MutationObserver)return;let{MutationObserver:e}=window;return new e(a)},[a,r]);return(0,j.useEffect)(()=>()=>null==n?void 0:n.disconnect(),[n]),n}({callback(t){if(e)for(let r of t){let{type:t,target:a}=r;if("childList"===t&&a instanceof HTMLElement&&a.contains(e)){s();break}}}}),i=ai({callback:s});return rn(()=>{s(),e?(null==i||i.observe(e),null==l||l.observe(document.body,{childList:!0,subtree:!0})):(null==i||i.disconnect(),null==l||l.disconnect())},[e]),a}let ad=[];function au(e,t){void 0===t&&(t=[]);let r=(0,j.useRef)(null);return(0,j.useEffect)(()=>{r.current=null},t),(0,j.useEffect)(()=>{let t=e!==rR;t&&!r.current&&(r.current=e),!t&&r.current&&(r.current=null)},[e]),r.current?rm(e,r.current):rR}function ah(e){return(0,j.useMemo)(()=>{let t,r;return e?(t=e.innerWidth,{top:0,left:0,right:t,bottom:r=e.innerHeight,width:t,height:r}):null},[e])}let ax=[];function am(e){if(!e)return null;if(e.children.length>1)return e;let t=e.children[0];return rt(t)?t:e}let af=[{sensor:aa,options:{}},{sensor:r9,options:{}}],ap={current:{}},ag={draggable:{measure:r_},droppable:{measure:r_,strategy:b.WhileDragging,frequency:y.Optimized},dragOverlay:{measure:rW}};class ab extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,r;return null!=(t=null==(r=this.get(e))?void 0:r.node.current)?t:void 0}}let ay={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new ab,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:rS},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:ag,measureDroppableContainers:rS,windowRect:null,measuringScheduled:!1},av={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:rS,draggableNodes:new Map,over:null,measureDroppableContainers:rS},aw=(0,j.createContext)(av),aj=(0,j.createContext)(ay);function aC(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new ab}}}function ak(e,t){switch(t.type){case u.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case u.DragMove:if(null==e.draggable.active)return e;return{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case u.DragEnd:case u.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case u.RegisterDroppable:{let{element:r}=t,{id:a}=r,n=new ab(e.droppable.containers);return n.set(a,r),{...e,droppable:{...e.droppable,containers:n}}}case u.SetDroppableDisabled:{let{id:r,key:a,disabled:n}=t,s=e.droppable.containers.get(r);if(!s||a!==s.key)return e;let l=new ab(e.droppable.containers);return l.set(r,{...s,disabled:n}),{...e,droppable:{...e.droppable,containers:l}}}case u.UnregisterDroppable:{let{id:r,key:a}=t,n=e.droppable.containers.get(r);if(!n||a!==n.key)return e;let s=new ab(e.droppable.containers);return s.delete(r),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function aN(e){let{disabled:t}=e,{active:r,activatorEvent:a,draggableNodes:n}=(0,j.useContext)(aw),s=rc(a),l=rc(null==r?void 0:r.id);return(0,j.useEffect)(()=>{if(!t&&!a&&s&&null!=l){if(!rf(s)||document.activeElement===s.target)return;let e=n.get(l);if(!e)return;let{activatorNode:t,node:r}=e;(t.current||r.current)&&requestAnimationFrame(()=>{for(let e of[t.current,r.current]){if(!e)continue;let t=e.matches(rb)?e:e.querySelector(rb);if(t){t.focus();break}}})}},[a,t,n,l,s]),null}function aS(e,t){let{transform:r,...a}=t;return null!=e&&e.length?e.reduce((e,t)=>t({transform:e,...a}),r):r}let aM=(0,j.createContext)({...rR,scaleX:1,scaleY:1});(d=v||(v={}))[d.Uninitialized=0]="Uninitialized",d[d.Initializing=1]="Initializing",d[d.Initialized=2]="Initialized";let aR=(0,j.memo)(function(e){var t,r,a,n,s,l,i,o;let c,d,x,m,f,y,w,C,{id:k,accessibility:N,autoScroll:S=!0,children:M,sensors:R=af,collisionDetection:L=rO,measuring:E,modifiers:A,...D}=e,[I,z]=(0,j.useReducer)(ak,void 0,aC),[B,O]=function(){let[e]=(0,j.useState)(()=>new Set),t=(0,j.useCallback)(t=>(e.add(t),()=>e.delete(t)),[e]);return[(0,j.useCallback)(t=>{let{type:r,event:a}=t;e.forEach(e=>{var t;return null==(t=e[r])?void 0:t.call(e,a)})},[e]),t]}(),[F,T]=(0,j.useState)(v.Uninitialized),$=F===v.Initialized,{draggable:{active:P,nodes:W,translate:_},droppable:{containers:U}}=I,H=null!=P?W.get(P):null,K=(0,j.useRef)({initial:null,translated:null}),V=(0,j.useMemo)(()=>{var e;return null!=P?{id:P,data:null!=(e=null==H?void 0:H.data)?e:ap,rect:K}:null},[P,H]),G=(0,j.useRef)(null),[X,q]=(0,j.useState)(null),[Y,J]=(0,j.useState)(null),Z=rl(D,Object.values(D)),Q=ru("DndDescribedBy",k),ee=(0,j.useMemo)(()=>U.getEnabled(),[U]),et=(0,j.useMemo)(()=>({draggable:{...ag.draggable,...null==E?void 0:E.draggable},droppable:{...ag.droppable,...null==E?void 0:E.droppable},dragOverlay:{...ag.dragOverlay,...null==E?void 0:E.dragOverlay}}),[null==E?void 0:E.draggable,null==E?void 0:E.droppable,null==E?void 0:E.dragOverlay]),{droppableRects:er,measureDroppableContainers:ea,measuringScheduled:en}=function(e,t){let{dragging:r,dependencies:a,config:n}=t,[s,l]=(0,j.useState)(null),{frequency:i,measure:o,strategy:c}=n,d=(0,j.useRef)(e),u=function(){switch(c){case b.Always:return!1;case b.BeforeDragging:return r;default:return!r}}(),h=rl(u),x=(0,j.useCallback)(function(e){void 0===e&&(e=[]),h.current||l(t=>null===t?e:t.concat(e.filter(e=>!t.includes(e))))},[h]),m=(0,j.useRef)(null),f=ri(t=>{if(u&&!r)return as;if(!t||t===as||d.current!==e||null!=s){let t=new Map;for(let r of e){if(!r)continue;if(s&&s.length>0&&!s.includes(r.id)&&r.rect.current){t.set(r.id,r.rect.current);continue}let e=r.node.current,a=e?new r1(o(e),e):null;r.rect.current=a,a&&t.set(r.id,a)}return t}return t},[e,s,r,u,o]);return(0,j.useEffect)(()=>{d.current=e},[e]),(0,j.useEffect)(()=>{u||x()},[r,u]),(0,j.useEffect)(()=>{s&&s.length>0&&l(null)},[JSON.stringify(s)]),(0,j.useEffect)(()=>{u||"number"!=typeof i||null!==m.current||(m.current=setTimeout(()=>{x(),m.current=null},i))},[i,u,x,...a]),{droppableRects:f,measureDroppableContainers:x,measuringScheduled:null!=s}}(ee,{dragging:$,dependencies:[_.x,_.y],config:et.droppable}),es=ri(e=>{var t;return null==P?null:null!=(t=null!=f?f:e)?t:null},[f=(m=null!=P?W.get(P):void 0)?m.node.current:null,P]),el=(0,j.useMemo)(()=>Y?rp(Y):null,[Y]),ei=(c=(null==X?void 0:X.autoScrollEnabled)===!1,d="object"==typeof S?!1===S.enabled:!1===S,x=$&&!c&&!d,"object"==typeof S?{...S,enabled:x}:{enabled:x}),eo=al(es,et.draggable.measure);!function(e){let{activeNode:t,measure:r,initialRect:a,config:n=!0}=e,s=(0,j.useRef)(!1),{x:l,y:i}="boolean"==typeof n?{x:n,y:n}:n;rn(()=>{if(!l&&!i||!t){s.current=!1;return}if(s.current||!a)return;let e=null==t?void 0:t.node.current;if(!e||!1===e.isConnected)return;let n=rF(r(e),a);if(l||(n.x=0),i||(n.y=0),s.current=!0,Math.abs(n.x)>0||Math.abs(n.y)>0){let t=rH(e);t&&t.scrollBy({top:n.y,left:n.x})}},[t,l,i,a,r])}({activeNode:null!=P?W.get(P):null,config:ei.layoutShiftCompensation,initialRect:eo,measure:et.draggable.measure});let ec=ac(es,et.draggable.measure,eo),ed=ac(es?es.parentElement:null),eu=(0,j.useRef)({activatorEvent:null,active:null,activeNode:es,collisionRect:null,collisions:null,droppableRects:er,draggableNodes:W,draggingNode:null,draggingNodeRect:null,droppableContainers:U,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),eh=U.getNodeFor(null==(t=eu.current.over)?void 0:t.id),ex=function(e){let{measure:t}=e,[r,a]=(0,j.useState)(null),n=ai({callback:(0,j.useCallback)(e=>{for(let{target:r}of e)if(rt(r)){a(e=>{let a=t(r);return e?{...e,width:a.width,height:a.height}:a});break}},[t])}),[s,l]=ro((0,j.useCallback)(e=>{let r=am(e);null==n||n.disconnect(),r&&(null==n||n.observe(r)),a(r?t(r):null)},[t,n]));return(0,j.useMemo)(()=>({nodeRef:s,rect:r,setRef:l}),[r,s,l])}({measure:et.dragOverlay.measure}),em=null!=(r=ex.nodeRef.current)?r:es,ef=$?null!=(a=ex.rect)?a:ec:null,ep=!!(ex.nodeRef.current&&ex.rect),eg=(y=al(s=ep?null:ec),rF(s,y)),eb=ah(em?t7(em):null),ey=(l=$?null!=eh?eh:es:null,w=(0,j.useRef)(l),C=ri(e=>l?e&&e!==ad&&l&&w.current&&l.parentNode===w.current.parentNode?e:rU(l):ad,[l]),(0,j.useEffect)(()=>{w.current=l},[l]),C),ev=function(e,t){void 0===t&&(t=rW);let[r]=e,a=ah(r?t7(r):null),[n,s]=(0,j.useState)(ax);function l(){s(()=>e.length?e.map(e=>rq(e)?a:new r1(t(e),e)):ax)}let i=ai({callback:l});return rn(()=>{null==i||i.disconnect(),l(),e.forEach(e=>null==i?void 0:i.observe(e))},[e]),n}(ey),ew=aS(A,{transform:{x:_.x-eg.x,y:_.y-eg.y,scaleX:1,scaleY:1},activatorEvent:Y,active:V,activeNodeRect:ec,containerNodeRect:ed,draggingNodeRect:ef,over:eu.current.over,overlayNodeRect:ex.rect,scrollableAncestors:ey,scrollableAncestorRects:ev,windowRect:eb}),ej=el?rx(el,_):null,eC=function(e){let[t,r]=(0,j.useState)(null),a=(0,j.useRef)(e),n=(0,j.useCallback)(e=>{let t=rK(e.target);t&&r(e=>e?(e.set(t,rX(t)),new Map(e)):null)},[]);return(0,j.useEffect)(()=>{let t=a.current;if(e!==t){s(t);let l=e.map(e=>{let t=rK(e);return t?(t.addEventListener("scroll",n,{passive:!0}),[t,rX(t)]):null}).filter(e=>null!=e);r(l.length?new Map(l):null),a.current=e}return()=>{s(e),s(t)};function s(e){e.forEach(e=>{let t=rK(e);null==t||t.removeEventListener("scroll",n)})}},[n,e]),(0,j.useMemo)(()=>e.length?t?Array.from(t.values()).reduce((e,t)=>rx(e,t),rR):rZ(e):rR,[e,t])}(ey),ek=au(eC),eN=au(eC,[ec]),eS=rx(ew,ek),eM=ef?rT(ef,ew):null,eR=V&&eM?L({active:V,collisionRect:eM,droppableRects:er,droppableContainers:ee,pointerCoordinates:ej}):null,eL=rI(eR,"id"),[eE,eA]=(0,j.useState)(null),eD=(i=ep?ew:rx(ew,eN),o=null!=(n=null==eE?void 0:eE.rect)?n:null,{...i,scaleX:o&&ec?o.width/ec.width:1,scaleY:o&&ec?o.height/ec.height:1}),eI=(0,j.useRef)(null),ez=(0,j.useCallback)((e,t)=>{let{sensor:r,options:a}=t;if(null==G.current)return;let n=W.get(G.current);if(!n)return;let s=e.nativeEvent,l=new r({active:G.current,activeNode:n,event:s,options:a,context:eu,onAbort(e){if(!W.get(e))return;let{onDragAbort:t}=Z.current,r={id:e};null==t||t(r),B({type:"onDragAbort",event:r})},onPending(e,t,r,a){if(!W.get(e))return;let{onDragPending:n}=Z.current,s={id:e,constraint:t,initialCoordinates:r,offset:a};null==n||n(s),B({type:"onDragPending",event:s})},onStart(e){let t=G.current;if(null==t)return;let r=W.get(t);if(!r)return;let{onDragStart:a}=Z.current,n={activatorEvent:s,active:{id:t,data:r.data,rect:K}};(0,t3.unstable_batchedUpdates)(()=>{null==a||a(n),T(v.Initializing),z({type:u.DragStart,initialCoordinates:e,active:t}),B({type:"onDragStart",event:n}),q(eI.current),J(s)})},onMove(e){z({type:u.DragMove,coordinates:e})},onEnd:i(u.DragEnd),onCancel:i(u.DragCancel)});function i(e){return async function(){let{active:t,collisions:r,over:a,scrollAdjustedTranslate:n}=eu.current,l=null;if(t&&n){let{cancelDrop:i}=Z.current;l={activatorEvent:s,active:t,collisions:r,delta:n,over:a},e===u.DragEnd&&"function"==typeof i&&await Promise.resolve(i(l))&&(e=u.DragCancel)}G.current=null,(0,t3.unstable_batchedUpdates)(()=>{z({type:e}),T(v.Uninitialized),eA(null),q(null),J(null),eI.current=null;let t=e===u.DragEnd?"onDragEnd":"onDragCancel";if(l){let e=Z.current[t];null==e||e(l),B({type:t,event:l})}})}}eI.current=l},[W]),eB=(0,j.useCallback)((e,t)=>(r,a)=>{let n=r.nativeEvent,s=W.get(a);null!==G.current||!s||n.dndKit||n.defaultPrevented||!0===e(r,t.options,{active:s})&&(n.dndKit={capturedBy:t.sensor},G.current=a,ez(r,t))},[W,ez]),eO=(0,j.useMemo)(()=>R.reduce((e,t)=>{let{sensor:r}=t;return[...e,...r.activators.map(e=>({eventName:e.eventName,handler:eB(e.handler,t)}))]},[]),[R,eB]);(0,j.useEffect)(()=>{if(!t6)return;let e=R.map(e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()});return()=>{for(let t of e)null==t||t()}},R.map(e=>{let{sensor:t}=e;return t})),rn(()=>{ec&&F===v.Initializing&&T(v.Initialized)},[ec,F]),(0,j.useEffect)(()=>{let{onDragMove:e}=Z.current,{active:t,activatorEvent:r,collisions:a,over:n}=eu.current;if(!t||!r)return;let s={active:t,activatorEvent:r,collisions:a,delta:{x:eS.x,y:eS.y},over:n};(0,t3.unstable_batchedUpdates)(()=>{null==e||e(s),B({type:"onDragMove",event:s})})},[eS.x,eS.y]),(0,j.useEffect)(()=>{let{active:e,activatorEvent:t,collisions:r,droppableContainers:a,scrollAdjustedTranslate:n}=eu.current;if(!e||null==G.current||!t||!n)return;let{onDragOver:s}=Z.current,l=a.get(eL),i=l&&l.rect.current?{id:l.id,rect:l.rect.current,data:l.data,disabled:l.disabled}:null,o={active:e,activatorEvent:t,collisions:r,delta:{x:n.x,y:n.y},over:i};(0,t3.unstable_batchedUpdates)(()=>{eA(i),null==s||s(o),B({type:"onDragOver",event:o})})},[eL]),rn(()=>{eu.current={activatorEvent:Y,active:V,activeNode:es,collisionRect:eM,collisions:eR,droppableRects:er,draggableNodes:W,draggingNode:em,draggingNodeRect:ef,droppableContainers:U,over:eE,scrollableAncestors:ey,scrollAdjustedTranslate:eS},K.current={initial:ef,translated:eM}},[V,es,eR,eM,W,em,ef,er,U,eE,ey,eS]),function(e){let t,{acceleration:r,activator:a=p.Pointer,canScroll:n,draggingRect:s,enabled:l,interval:i=5,order:o=g.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:u,delta:x,threshold:m}=e,f=function(e){let{delta:t,disabled:r}=e,a=rc(t);return ri(e=>{if(r||!a||!e)return an;let n={x:Math.sign(t.x-a.x),y:Math.sign(t.y-a.y)};return{x:{[h.Backward]:e.x[h.Backward]||-1===n.x,[h.Forward]:e.x[h.Forward]||1===n.x},y:{[h.Backward]:e.y[h.Backward]||-1===n.y,[h.Forward]:e.y[h.Forward]||1===n.y}}},[r,t,a])}({delta:x,disabled:!l}),[b,y]=(t=(0,j.useRef)(null),[(0,j.useCallback)((e,r)=>{t.current=setInterval(e,r)},[]),(0,j.useCallback)(()=>{null!==t.current&&(clearInterval(t.current),t.current=null)},[])]),v=(0,j.useRef)({x:0,y:0}),w=(0,j.useRef)({x:0,y:0}),C=(0,j.useMemo)(()=>{switch(a){case p.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case p.DraggableRect:return s}},[a,s,c]),k=(0,j.useRef)(null),N=(0,j.useCallback)(()=>{let e=k.current;if(!e)return;let t=v.current.x*w.current.x,r=v.current.y*w.current.y;e.scrollBy(t,r)},[]),S=(0,j.useMemo)(()=>o===g.TreeOrder?[...d].reverse():d,[o,d]);(0,j.useEffect)(()=>{if(!l||!d.length||!C)return void y();for(let e of S){if((null==n?void 0:n(e))===!1)continue;let t=u[d.indexOf(e)];if(!t)continue;let{direction:a,speed:s}=function(e,t,r,a,n){let{top:s,left:l,right:i,bottom:o}=r;void 0===a&&(a=10),void 0===n&&(n=rJ);let{isTop:c,isBottom:d,isLeft:u,isRight:x}=rY(e),m={x:0,y:0},f={x:0,y:0},p={height:t.height*n.y,width:t.width*n.x};return!c&&s<=t.top+p.height?(m.y=h.Backward,f.y=a*Math.abs((t.top+p.height-s)/p.height)):!d&&o>=t.bottom-p.height&&(m.y=h.Forward,f.y=a*Math.abs((t.bottom-p.height-o)/p.height)),!x&&i>=t.right-p.width?(m.x=h.Forward,f.x=a*Math.abs((t.right-p.width-i)/p.width)):!u&&l<=t.left+p.width&&(m.x=h.Backward,f.x=a*Math.abs((t.left+p.width-l)/p.width)),{direction:m,speed:f}}(e,t,C,r,m);for(let e of["x","y"])f[e][a[e]]||(s[e]=0,a[e]=0);if(s.x>0||s.y>0){y(),k.current=e,b(N,i),v.current=s,w.current=a;return}}v.current={x:0,y:0},w.current={x:0,y:0},y()},[r,N,n,y,l,i,JSON.stringify(C),JSON.stringify(f),b,d,S,u,JSON.stringify(m)])}({...ei,delta:_,draggingRect:eM,pointerCoordinates:ej,scrollableAncestors:ey,scrollableAncestorRects:ev});let eF=(0,j.useMemo)(()=>({active:V,activeNode:es,activeNodeRect:ec,activatorEvent:Y,collisions:eR,containerNodeRect:ed,dragOverlay:ex,draggableNodes:W,droppableContainers:U,droppableRects:er,over:eE,measureDroppableContainers:ea,scrollableAncestors:ey,scrollableAncestorRects:ev,measuringConfiguration:et,measuringScheduled:en,windowRect:eb}),[V,es,ec,Y,eR,ed,ex,W,U,er,eE,ea,ey,ev,et,en,eb]),eT=(0,j.useMemo)(()=>({activatorEvent:Y,activators:eO,active:V,activeNodeRect:ec,ariaDescribedById:{draggable:Q},dispatch:z,draggableNodes:W,over:eE,measureDroppableContainers:ea}),[Y,eO,V,ec,z,Q,W,eE,ea]);return j.default.createElement(rj.Provider,{value:O},j.default.createElement(aw.Provider,{value:eT},j.default.createElement(aj.Provider,{value:eF},j.default.createElement(aM.Provider,{value:eD},M)),j.default.createElement(aN,{disabled:(null==N?void 0:N.restoreFocus)===!1})),j.default.createElement(rN,{...N,hiddenTextDescribedById:Q}))}),aL=(0,j.createContext)(null),aE="button";function aA(){return(0,j.useContext)(aj)}let aD={timeout:25};function aI(e){let{animation:t,children:r}=e,[a,n]=(0,j.useState)(null),[s,l]=(0,j.useState)(null),i=rc(r);return r||a||!i||n(i),rn(()=>{if(!s)return;let e=null==a?void 0:a.key,r=null==a?void 0:a.props.id;null==e||null==r?n(null):Promise.resolve(t(r,s)).then(()=>{n(null)})},[t,a,s]),j.default.createElement(j.default.Fragment,null,r,a?(0,j.cloneElement)(a,{ref:l}):null)}let az={x:0,y:0,scaleX:1,scaleY:1};function aB(e){let{children:t}=e;return j.default.createElement(aw.Provider,{value:av},j.default.createElement(aM.Provider,{value:az},t))}let aO={position:"fixed",touchAction:"none"},aF=e=>rf(e)?"transform 250ms ease":void 0,aT=(0,j.forwardRef)((e,t)=>{let{as:r,activatorEvent:a,adjustScale:n,children:s,className:l,rect:i,style:o,transform:c,transition:d=aF}=e;if(!i)return null;let u=n?c:{...c,scaleX:1,scaleY:1},h={...aO,width:i.width,height:i.height,top:i.top,left:i.left,transform:rg.Transform.toString(u),transformOrigin:n&&a?function(e,t){let r=rp(e);if(!r)return"0 0";let a={x:(r.x-t.left)/t.width*100,y:(r.y-t.top)/t.height*100};return a.x+"% "+a.y+"%"}(a,i):void 0,transition:"function"==typeof d?d(a):d,...o};return j.default.createElement(r,{className:l,style:h,ref:t},s)}),a$={duration:250,easing:"ease",keyframes:e=>{let{transform:{initial:t,final:r}}=e;return[{transform:rg.Transform.toString(t)},{transform:rg.Transform.toString(r)}]},sideEffects:(t={styles:{active:{opacity:"0"}}},e=>{let{active:r,dragOverlay:a}=e,n={},{styles:s,className:l}=t;if(null!=s&&s.active)for(let[e,t]of Object.entries(s.active))void 0!==t&&(n[e]=r.node.style.getPropertyValue(e),r.node.style.setProperty(e,t));if(null!=s&&s.dragOverlay)for(let[e,t]of Object.entries(s.dragOverlay))void 0!==t&&a.node.style.setProperty(e,t);return null!=l&&l.active&&r.node.classList.add(l.active),null!=l&&l.dragOverlay&&a.node.classList.add(l.dragOverlay),function(){for(let[e,t]of Object.entries(n))r.node.style.setProperty(e,t);null!=l&&l.active&&r.node.classList.remove(l.active)}})},aP=0,aW=j.default.memo(e=>{var t;let{adjustScale:r=!1,children:a,dropAnimation:n,style:s,transition:l,modifiers:i,wrapperElement:o="div",className:c,zIndex:d=999}=e,{activatorEvent:u,active:h,activeNodeRect:x,containerNodeRect:m,draggableNodes:f,droppableContainers:p,dragOverlay:g,over:b,measuringConfiguration:y,scrollableAncestors:v,scrollableAncestorRects:w,windowRect:C}=aA(),k=(0,j.useContext)(aM),N=(t=null==h?void 0:h.id,(0,j.useMemo)(()=>{if(null!=t)return++aP},[t])),S=aS(i,{activatorEvent:u,active:h,activeNodeRect:x,containerNodeRect:m,draggingNodeRect:g.rect,over:b,overlayNodeRect:g.rect,scrollableAncestors:v,scrollableAncestorRects:w,transform:k,windowRect:C}),M=al(x),R=function(e){let{config:t,draggableNodes:r,droppableContainers:a,measuringConfiguration:n}=e;return rs((e,s)=>{if(null===t)return;let l=r.get(e);if(!l)return;let i=l.node.current;if(!i)return;let o=am(s);if(!o)return;let{transform:c}=t7(s).getComputedStyle(s),d=r$(c);if(!d)return;let u="function"==typeof t?t:function(e){let{duration:t,easing:r,sideEffects:a,keyframes:n}={...a$,...e};return e=>{let{active:s,dragOverlay:l,transform:i,...o}=e;if(!t)return;let c={x:l.rect.left-s.rect.left,y:l.rect.top-s.rect.top},d={scaleX:1!==i.scaleX?s.rect.width*i.scaleX/l.rect.width:1,scaleY:1!==i.scaleY?s.rect.height*i.scaleY/l.rect.height:1},u={x:i.x-c.x,y:i.y-c.y,...d},h=n({...o,active:s,dragOverlay:l,transform:{initial:i,final:u}}),[x]=h,m=h[h.length-1];if(JSON.stringify(x)===JSON.stringify(m))return;let f=null==a?void 0:a({active:s,dragOverlay:l,...o}),p=l.node.animate(h,{duration:t,easing:r,fill:"forwards"});return new Promise(e=>{p.onfinish=()=>{null==f||f(),e()}})}}(t);return rQ(i,n.draggable.measure),u({active:{id:e,data:l.data,node:i,rect:n.draggable.measure(i)},draggableNodes:r,dragOverlay:{node:s,rect:n.dragOverlay.measure(o)},droppableContainers:a,measuringConfiguration:n,transform:d})})}({config:n,draggableNodes:f,droppableContainers:p,measuringConfiguration:y}),L=M?g.setRef:void 0;return j.default.createElement(aB,null,j.default.createElement(aI,{animation:R},h&&N?j.default.createElement(aT,{key:N,id:h.id,ref:L,as:o,activatorEvent:u,adjustScale:r,className:c,transition:l,rect:M,style:{zIndex:d,...s},transform:S},a):null))});function a_(e,t,r){let a=e.slice();return a.splice(r<0?a.length+r:r,0,a.splice(t,1)[0]),a}function aU(e){return null!==e&&e>=0}let aH=e=>{let{rects:t,activeIndex:r,overIndex:a,index:n}=e,s=a_(t,a,r),l=t[n],i=s[n];return i&&l?{x:i.left-l.left,y:i.top-l.top,scaleX:i.width/l.width,scaleY:i.height/l.height}:null},aK="Sortable",aV=j.default.createContext({activeIndex:-1,containerId:aK,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:aH,disabled:{draggable:!1,droppable:!1}});function aG(e){let{children:t,id:r,items:a,strategy:n=aH,disabled:s=!1}=e,{active:l,dragOverlay:i,droppableRects:o,over:c,measureDroppableContainers:d}=aA(),u=ru(aK,r),h=null!==i.rect,x=(0,j.useMemo)(()=>a.map(e=>"object"==typeof e&&"id"in e?e.id:e),[a]),m=null!=l,f=l?x.indexOf(l.id):-1,p=c?x.indexOf(c.id):-1,g=(0,j.useRef)(x),b=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(x,g.current),y=-1!==p&&-1===f||b,v="boolean"==typeof s?{draggable:s,droppable:s}:s;rn(()=>{b&&m&&d(x)},[b,x,m,d]),(0,j.useEffect)(()=>{g.current=x},[x]);let w=(0,j.useMemo)(()=>({activeIndex:f,containerId:u,disabled:v,disableTransforms:y,items:x,overIndex:p,useDragOverlay:h,sortedRects:x.reduce((e,t,r)=>{let a=o.get(t);return a&&(e[r]=a),e},Array(x.length)),strategy:n}),[f,u,v.draggable,v.droppable,y,x,p,o,h,n]);return j.default.createElement(aV.Provider,{value:w},t)}let aX=e=>{let{id:t,items:r,activeIndex:a,overIndex:n}=e;return a_(r,a,n).indexOf(t)},aq=e=>{let{containerId:t,isSorting:r,wasDragging:a,index:n,items:s,newIndex:l,previousItems:i,previousContainerId:o,transition:c}=e;return!!c&&!!a&&(i===s||n!==l)&&(!!r||l!==n&&t===o)},aY={duration:200,easing:"ease"},aJ="transform",aZ=rg.Transition.toString({property:aJ,duration:0,easing:"linear"}),aQ={roleDescription:"sortable"};function a0(e){if(!e)return!1;let t=e.data.current;return!!t&&"sortable"in t&&"object"==typeof t.sortable&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable}let a1=[m.Down,m.Right,m.Up,m.Left],a2=(e,t)=>{let{context:{active:r,collisionRect:a,droppableRects:n,droppableContainers:s,over:l,scrollableAncestors:i}}=t;if(a1.includes(e.code)){if(e.preventDefault(),!r||!a)return;let t=[];s.getEnabled().forEach(r=>{if(!r||null!=r&&r.disabled)return;let s=n.get(r.id);if(s)switch(e.code){case m.Down:a.top<s.top&&t.push(r);break;case m.Up:a.top>s.top&&t.push(r);break;case m.Left:a.left>s.left&&t.push(r);break;case m.Right:a.left<s.left&&t.push(r)}});let d=(e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e,n=rD(t),s=[];for(let e of a){let{id:t}=e,a=r.get(t);if(a){let r=rD(a),l=Number((n.reduce((e,t,a)=>e+rL(r[a],t),0)/4).toFixed(4));s.push({id:t,data:{droppableContainer:e,value:l}})}}return s.sort(rE)})({active:r,collisionRect:a,droppableRects:n,droppableContainers:t,pointerCoordinates:null}),u=rI(d,"id");if(u===(null==l?void 0:l.id)&&d.length>1&&(u=d[1].id),null!=u){let e=s.get(r.id),t=s.get(u),l=t?n.get(t.id):null,d=null==t?void 0:t.node.current;if(d&&l&&e&&t){var o,c;let r=rU(d).some((e,t)=>i[t]!==e),n=a4(e,t),s=(o=e,c=t,!!a0(o)&&!!a0(c)&&!!a4(o,c)&&o.data.current.sortable.index<c.data.current.sortable.index),u=r||!n?{x:0,y:0}:{x:s?a.width-l.width:0,y:s?a.height-l.height:0},h={x:l.left,y:l.top};return u.x&&u.y?h:rm(h,u)}}}};function a4(e,t){return!!a0(e)&&!!a0(t)&&e.data.current.sortable.containerId===t.data.current.sortable.containerId}function a5({id:e,character:t,index:r}){let{attributes:a,listeners:n,setNodeRef:s,transform:l,transition:i,isDragging:o}=function(e){var t,r,a,n;let{animateLayoutChanges:s=aq,attributes:l,disabled:i,data:o,getNewIndex:c=aX,id:d,strategy:h,resizeObserverConfig:x,transition:m=aY}=e,{items:f,containerId:p,activeIndex:g,disabled:b,disableTransforms:y,sortedRects:v,overIndex:w,useDragOverlay:C,strategy:k}=(0,j.useContext)(aV),N=(t=i,r=b,"boolean"==typeof t?{draggable:t,droppable:!1}:{draggable:null!=(a=null==t?void 0:t.draggable)?a:r.draggable,droppable:null!=(n=null==t?void 0:t.droppable)?n:r.droppable}),S=f.indexOf(d),M=(0,j.useMemo)(()=>({sortable:{containerId:p,index:S,items:f},...o}),[p,o,S,f]),R=(0,j.useMemo)(()=>f.slice(f.indexOf(d)),[f,d]),{rect:L,node:E,isOver:A,setNodeRef:D}=function(e){let{data:t,disabled:r=!1,id:a,resizeObserverConfig:n}=e,s=ru("Droppable"),{active:l,dispatch:i,over:o,measureDroppableContainers:c}=(0,j.useContext)(aw),d=(0,j.useRef)({disabled:r}),h=(0,j.useRef)(!1),x=(0,j.useRef)(null),m=(0,j.useRef)(null),{disabled:f,updateMeasurementsFor:p,timeout:g}={...aD,...n},b=rl(null!=p?p:a),y=ai({callback:(0,j.useCallback)(()=>{if(!h.current){h.current=!0;return}null!=m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{c(Array.isArray(b.current)?b.current:[b.current]),m.current=null},g)},[g]),disabled:f||!l}),[v,w]=ro((0,j.useCallback)((e,t)=>{y&&(t&&(y.unobserve(t),h.current=!1),e&&y.observe(e))},[y])),C=rl(t);return(0,j.useEffect)(()=>{y&&v.current&&(y.disconnect(),h.current=!1,y.observe(v.current))},[v,y]),(0,j.useEffect)(()=>(i({type:u.RegisterDroppable,element:{id:a,key:s,disabled:r,node:v,rect:x,data:C}}),()=>i({type:u.UnregisterDroppable,key:s,id:a})),[a]),(0,j.useEffect)(()=>{r!==d.current.disabled&&(i({type:u.SetDroppableDisabled,id:a,key:s,disabled:r}),d.current.disabled=r)},[a,s,r,i]),{active:l,rect:x,isOver:(null==o?void 0:o.id)===a,node:v,over:o,setNodeRef:w}}({id:d,data:M,disabled:N.droppable,resizeObserverConfig:{updateMeasurementsFor:R,...x}}),{active:I,activatorEvent:z,activeNodeRect:B,attributes:O,setNodeRef:F,listeners:T,isDragging:$,over:P,setActivatorNodeRef:W,transform:_}=function(e){let{id:t,data:r,disabled:a=!1,attributes:n}=e,s=ru("Draggable"),{activators:l,activatorEvent:i,active:o,activeNodeRect:c,ariaDescribedById:d,draggableNodes:u,over:h}=(0,j.useContext)(aw),{role:x=aE,roleDescription:m="draggable",tabIndex:f=0}=null!=n?n:{},p=(null==o?void 0:o.id)===t,g=(0,j.useContext)(p?aM:aL),[b,y]=ro(),[v,w]=ro(),C=(0,j.useMemo)(()=>l.reduce((e,r)=>{let{eventName:a,handler:n}=r;return e[a]=e=>{n(e,t)},e},{}),[l,t]),k=rl(r);return rn(()=>(u.set(t,{id:t,key:s,node:b,activatorNode:v,data:k}),()=>{let e=u.get(t);e&&e.key===s&&u.delete(t)}),[u,t]),{active:o,activatorEvent:i,activeNodeRect:c,attributes:(0,j.useMemo)(()=>({role:x,tabIndex:f,"aria-disabled":a,"aria-pressed":!!p&&x===aE||void 0,"aria-roledescription":m,"aria-describedby":d.draggable}),[a,x,f,p,m,d.draggable]),isDragging:p,listeners:a?void 0:C,node:b,over:h,setNodeRef:y,setActivatorNodeRef:w,transform:g}}({id:d,data:M,attributes:{...aQ,...l},disabled:N.draggable}),U=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,j.useMemo)(()=>e=>{t.forEach(t=>t(e))},t)}(D,F),H=!!I,K=H&&!y&&aU(g)&&aU(w),V=!C&&$,G=V&&K?_:null,X=K?null!=G?G:(null!=h?h:k)({rects:v,activeNodeRect:B,activeIndex:g,overIndex:w,index:S}):null,q=aU(g)&&aU(w)?c({id:d,items:f,activeIndex:g,overIndex:w}):S,Y=null==I?void 0:I.id,J=(0,j.useRef)({activeId:Y,items:f,newIndex:q,containerId:p}),Z=f!==J.current.items,Q=s({active:I,containerId:p,isDragging:$,isSorting:H,id:d,index:S,items:f,newIndex:J.current.newIndex,previousItems:J.current.items,previousContainerId:J.current.containerId,transition:m,wasDragging:null!=J.current.activeId}),ee=function(e){let{disabled:t,index:r,node:a,rect:n}=e,[s,l]=(0,j.useState)(null),i=(0,j.useRef)(r);return rn(()=>{if(!t&&r!==i.current&&a.current){let e=n.current;if(e){let t=rW(a.current,{ignoreTransform:!0}),r={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(r.x||r.y)&&l(r)}}r!==i.current&&(i.current=r)},[t,r,a,n]),(0,j.useEffect)(()=>{s&&l(null)},[s]),s}({disabled:!Q,index:S,node:E,rect:L});return(0,j.useEffect)(()=>{H&&J.current.newIndex!==q&&(J.current.newIndex=q),p!==J.current.containerId&&(J.current.containerId=p),f!==J.current.items&&(J.current.items=f)},[H,q,p,f]),(0,j.useEffect)(()=>{if(Y===J.current.activeId)return;if(null!=Y&&null==J.current.activeId){J.current.activeId=Y;return}let e=setTimeout(()=>{J.current.activeId=Y},50);return()=>clearTimeout(e)},[Y]),{active:I,activeIndex:g,attributes:O,data:M,rect:L,index:S,newIndex:q,items:f,isOver:A,isSorting:H,isDragging:$,listeners:T,node:E,overIndex:w,over:P,setNodeRef:U,setActivatorNodeRef:W,setDroppableNodeRef:D,setDraggableNodeRef:F,transform:null!=ee?ee:X,transition:ee||Z&&J.current.newIndex===S?aZ:(!V||rf(z))&&m&&(H||Q)?rg.Transition.toString({...m,property:aJ}):void 0}}({id:e}),c={transform:rg.Transform.toString(l),transition:i};return(0,w.jsxs)("div",{ref:s,style:c,...a,...n,className:`
        p-1.5 rounded border-2 transition-all cursor-grab active:cursor-grabbing
        ${o?"border-retro-cyan bg-retro-cyan/20 opacity-50":"border-retro-grid/30 hover:border-retro-grid/50"}
      `,title:`Character ${r}`,children:[(0,w.jsx)(eC.CharacterDisplay,{character:t,mode:"small",smallScale:3}),(0,w.jsx)("div",{className:"text-[8px] text-gray-500 text-center mt-0.5",children:r})]})}function a3({character:e}){return(0,w.jsx)("div",{className:"p-1.5 rounded border-2 border-retro-cyan bg-retro-navy shadow-lg",children:(0,w.jsx)(eC.CharacterDisplay,{character:e,mode:"small",smallScale:3})})}function a6({isOpen:e,onClose:t,characters:r,onReorder:a}){let[n,s]=(0,j.useState)([]),[l,i]=(0,j.useState)(null);(0,j.useEffect)(()=>{e&&s([...r])},[e,r]);let o=(0,j.useMemo)(()=>n.map((e,t)=>`char-${t}`),[n]),c=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,j.useMemo)(()=>[...t].filter(e=>null!=e),[...t])}(rM(aa,{activationConstraint:{distance:8}}),rM(r9,{coordinateGetter:a2})),d=(0,j.useMemo)(()=>l&&n[parseInt(l.replace("char-",""),10)]||null,[l,n]),u=(0,j.useCallback)(e=>{i(e.active.id)},[]),h=(0,j.useCallback)(e=>{let{active:t,over:r}=e;if(i(null),r&&t.id!==r.id){let e=parseInt(t.id.replace("char-",""),10),a=parseInt(r.id.replace("char-",""),10);s(t=>a_(t,e,a))}},[]),x=(0,j.useCallback)(()=>{a(n),t()},[n,a,t]),m=(0,j.useCallback)(e=>{"Escape"===e.key&&t()},[t]),f=(0,j.useMemo)(()=>n.length!==r.length||n.some((e,t)=>e!==r[t]),[n,r]);return e?(0,w.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onKeyDown:m,children:[(0,w.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,w.jsxs)("div",{className:"relative w-full max-w-3xl max-h-[80vh] bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl flex flex-col overflow-hidden",children:[(0,w.jsxs)("div",{className:"flex-shrink-0 p-4 border-b border-retro-grid/30",children:[(0,w.jsx)("h2",{className:"text-lg font-medium text-white",children:"Reorder Characters"}),(0,w.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Drag and drop characters to reorder them"})]}),(0,w.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:(0,w.jsxs)(aR,{sensors:c,collisionDetection:rB,onDragStart:u,onDragEnd:h,children:[(0,w.jsx)(aG,{items:o,strategy:aH,children:(0,w.jsx)("div",{className:"grid gap-2 bg-black/30 rounded-lg p-3",style:{gridTemplateColumns:"repeat(auto-fill, minmax(50px, 1fr))"},children:n.map((e,t)=>(0,w.jsx)(a5,{id:o[t],character:e,index:t},o[t]))})}),(0,w.jsx)(aW,{children:d&&(0,w.jsx)(a3,{character:d})})]})}),(0,w.jsxs)("div",{className:"flex-shrink-0 p-4 border-t border-retro-grid/30 flex justify-between",children:[(0,w.jsx)("button",{onClick:t,className:"px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,w.jsx)("button",{onClick:x,disabled:!f,className:"px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Apply"})]})]})]}):null}e.s(["ReorderModal",()=>a6],55361);let a8=[{label:"0.25x",value:.25},{label:"0.5x",value:.5},{label:"0.75x",value:.75},{label:"1.5x",value:1.5},{label:"2x",value:2},{label:"3x",value:3},{label:"4x",value:4}],a9=[{id:"nearest",label:"Nearest Neighbor",description:"Fast, sharp edges"},{id:"threshold",label:"Threshold-based",description:"Smoother, considers pixel coverage"}];function a7({isOpen:e,onClose:t,onScale:r,characters:a,selectedIndices:n,config:s,foregroundColor:l="#ffffff",backgroundColor:i="#000000"}){let[o,c]=(0,j.useState)(2),[d,u]=(0,j.useState)("mc"),[h,x]=(0,j.useState)("nearest"),m=(0,j.useMemo)(()=>Array.from(n).slice(0,16).map(e=>a[e]).filter(e=>void 0!==e),[a,n]),f=(0,j.useMemo)(()=>m.map(e=>e9(e,o,d,h)),[m,o,d,h]),p=Math.max(0,n.size-16),g=(0,j.useCallback)(()=>{r(o,d,h),t()},[o,d,h,r,t]),b=(0,j.useCallback)(e=>{"Escape"===e.key?t():"Enter"===e.key&&g()},[t,g]);if(!e)return null;let y=Math.min(4,m.length);return(0,w.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onKeyDown:b,children:[(0,w.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,w.jsxs)("div",{className:"relative w-full max-w-lg bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl p-6",children:[(0,w.jsx)("h2",{className:"text-lg font-medium text-white mb-4",children:"Scale Characters"}),(0,w.jsx)("div",{className:"mb-6",children:(0,w.jsxs)("div",{className:"flex gap-4",children:[(0,w.jsxs)("div",{className:"flex-1",children:[(0,w.jsx)("label",{className:"block text-xs text-gray-500 mb-2",children:"Before"}),(0,w.jsx)("div",{className:"bg-retro-dark rounded border border-retro-grid/30 p-2 min-h-[80px] flex items-center justify-center",children:(0,w.jsx)("div",{className:"grid gap-1",style:{gridTemplateColumns:`repeat(${y}, ${2*s.width}px)`},children:m.map((e,t)=>(0,w.jsx)(eC.CharacterDisplay,{character:e,mode:"small",smallScale:2,foregroundColor:l,backgroundColor:i,interactive:!1},t))})}),p>0&&(0,w.jsxs)("p",{className:"text-[10px] text-gray-500 mt-1 text-center",children:["+",p," more"]})]}),(0,w.jsxs)("div",{className:"flex-1",children:[(0,w.jsx)("label",{className:"block text-xs text-gray-500 mb-2",children:"After"}),(0,w.jsx)("div",{className:"bg-retro-dark rounded border border-retro-grid/30 p-2 min-h-[80px] flex items-center justify-center",children:(0,w.jsx)("div",{className:"grid gap-1",style:{gridTemplateColumns:`repeat(${y}, ${2*s.width}px)`},children:f.map((e,t)=>(0,w.jsx)(eC.CharacterDisplay,{character:e,mode:"small",smallScale:2,foregroundColor:l,backgroundColor:i,interactive:!1},t))})}),p>0&&(0,w.jsxs)("p",{className:"text-[10px] text-gray-500 mt-1 text-center",children:["+",p," more"]})]})]})}),(0,w.jsxs)("div",{className:"mb-4",children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Scale Factor"}),(0,w.jsxs)("div",{className:"flex flex-wrap gap-2 items-center",children:[a8.map(e=>(0,w.jsx)("button",{type:"button",onClick:()=>c(e.value),className:`
                  px-3 py-1.5 text-sm rounded border transition-all
                  ${o===e.value?"border-retro-pink bg-retro-pink/20 text-retro-pink":"border-retro-grid/50 bg-retro-dark text-gray-400 hover:border-retro-grid hover:text-white"}
                `,children:e.label},e.value)),(0,w.jsxs)("div",{className:"flex items-center gap-1.5 ml-2",children:[(0,w.jsx)("span",{className:"text-xs text-gray-500",children:"or"}),(0,w.jsx)("input",{type:"number",min:.1,max:10,step:.1,value:o,onChange:e=>{let t=parseFloat(e.target.value);!isNaN(t)&&t>0&&t<=10&&c(Math.round(100*t)/100)},className:"w-20 px-2 py-1.5 text-sm bg-retro-dark border border-retro-grid/50 rounded text-white text-center focus:outline-none focus:border-retro-pink"}),(0,w.jsx)("span",{className:"text-xs text-gray-500",children:"x"})]})]})]}),(0,w.jsx)("div",{className:"mb-4",children:(0,w.jsx)(tC,{value:d,onChange:u,description:"Select where to anchor content when scaling"})}),(0,w.jsxs)("div",{className:"mb-4",children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Algorithm"}),(0,w.jsx)("div",{className:"flex gap-2",children:a9.map(e=>(0,w.jsxs)("button",{type:"button",onClick:()=>x(e.id),className:`
                  flex-1 px-3 py-2 text-sm rounded border transition-all text-left
                  ${h===e.id?"border-retro-cyan bg-retro-cyan/20 text-retro-cyan":"border-retro-grid/50 bg-retro-dark text-gray-400 hover:border-retro-grid hover:text-white"}
                `,children:[(0,w.jsx)("div",{className:"font-medium",children:e.label}),(0,w.jsx)("div",{className:"text-xs text-gray-500 mt-0.5",children:e.description})]},e.id))})]}),(0,w.jsx)("p",{className:"text-xs text-gray-500 mb-4 text-center h-4",children:o>1?"Content will be enlarged and clipped to fit":o<1?"Content will be reduced":"No scaling applied"}),(0,w.jsxs)("div",{className:"flex gap-3",children:[(0,w.jsx)("button",{onClick:t,className:"flex-1 px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,w.jsx)("button",{onClick:g,disabled:1===o||o<=0||o>10,className:"flex-1 px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Apply"})]})]})]})}function ne({isOpen:e,onClose:t,totalCharacters:r,currentIndex:a,onGoTo:n}){let[s,l]=(0,j.useState)(""),[i,o]=(0,j.useState)(null);(0,j.useEffect)(()=>{e&&(l(""),o(null))},[e]),(0,j.useEffect)(()=>{o(function(e){let t=e.trim().toLowerCase();if(!t)return null;if(t.startsWith("0x")){let e=parseInt(t.slice(2),16);return isNaN(e)?null:e}if(t.startsWith("$")){let e=parseInt(t.slice(1),16);return isNaN(e)?null:e}if(t.endsWith("h")){let e=parseInt(t.slice(0,-1),16);return isNaN(e)?null:e}let r=parseInt(t,10);return isNaN(r)?null:r}(s))},[s]);let c=null!==i&&i>=0&&i<r,d=(0,j.useCallback)(()=>{c&&null!==i&&(n(i),t())},[c,i,n,t]),u=(0,j.useCallback)(e=>{"Escape"===e.key?t():"Enter"===e.key&&d()},[t,d]);if(!e)return null;let h=null!==i&&eP(i),x=null!==i?e$(i):null;return(0,w.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onKeyDown:u,children:[(0,w.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,w.jsxs)("div",{className:"relative w-full max-w-xs bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl p-6",children:[(0,w.jsx)("h2",{className:"text-lg font-medium text-white mb-4",children:"Go to Character"}),(0,w.jsxs)("div",{className:"mb-4",children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Character Index"}),(0,w.jsx)("input",{type:"text",value:s,onChange:e=>l(e.target.value),placeholder:"e.g. 65, 0x41, $41",className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white focus:outline-none focus:border-retro-cyan font-mono",autoFocus:!0}),(0,w.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Enter decimal (65) or hex (0x41, $41)"})]}),(0,w.jsxs)("div",{className:"mb-4 p-3 bg-retro-dark/50 rounded border border-retro-grid/30 min-h-[60px]",children:[null===i&&s&&(0,w.jsx)("p",{className:"text-xs text-red-400",children:"Invalid number format"}),null!==i&&!c&&(0,w.jsxs)("p",{className:"text-xs text-red-400",children:["Index out of range (0-",r-1,")"]}),c&&null!==i&&(0,w.jsxs)("div",{className:"space-y-1",children:[(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)("span",{className:"text-xs text-gray-400",children:"Decimal:"}),(0,w.jsx)("span",{className:"text-sm text-retro-cyan font-mono",children:i})]}),(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)("span",{className:"text-xs text-gray-400",children:"Hex:"}),(0,w.jsxs)("span",{className:"text-sm text-retro-cyan font-mono",children:["0x",i.toString(16).toUpperCase().padStart(2,"0")]})]}),h&&(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)("span",{className:"text-xs text-gray-400",children:"ASCII:"}),(0,w.jsxs)("span",{className:"text-sm text-retro-pink font-mono",children:["'",String.fromCharCode(i),"'"]})]}),x&&(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)("span",{className:"text-xs text-gray-400",children:"Control:"}),(0,w.jsx)("span",{className:"text-sm text-retro-pink",children:x})]})]}),!s&&(0,w.jsxs)("p",{className:"text-xs text-gray-500",children:["Current: ",a," (0x",a.toString(16).toUpperCase().padStart(2,"0"),")"]})]}),(0,w.jsxs)("div",{className:"flex gap-3",children:[(0,w.jsx)("button",{onClick:t,className:"flex-1 px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,w.jsx)("button",{onClick:d,disabled:!c,className:"flex-1 px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Go"})]})]})]})}function nt({character:e,index:t,isSelected:r,onClick:a,foregroundColor:n,backgroundColor:s}){let l=e.pixels.length,i=e.pixels[0]?.length||0,o=eP(t),c=e$(t),d=(0,j.useMemo)(()=>{let e=[`#${t}`,`0x${t.toString(16).toUpperCase().padStart(2,"0")}`];return o?e.push(`'${String.fromCharCode(t)}'`):c&&e.push(c),e.join(" | ")},[t,o,c]);return(0,w.jsxs)("button",{onClick:a,className:`
        relative p-0.5 rounded transition-all
        hover:bg-retro-cyan/20 hover:ring-1 hover:ring-retro-cyan/50
        ${r?"bg-retro-cyan/30 ring-2 ring-retro-cyan":""}
      `,title:d,children:[(0,w.jsx)("div",{className:"grid",style:{gridTemplateColumns:`repeat(${i}, 2px)`,gridTemplateRows:`repeat(${l}, 2px)`,width:2*i,height:2*l},children:e.pixels.flat().map((e,t)=>(0,w.jsx)("div",{style:{backgroundColor:e?n:s,width:2,height:2}},t))}),(0,w.jsx)("span",{className:"absolute inset-0 flex items-center justify-center text-[6px] font-mono text-white opacity-0 hover:opacity-100 bg-black/60 rounded",children:t.toString(16).toUpperCase().padStart(2,"0")})]})}function nr({isOpen:e,onClose:t,characters:r,selectedIndex:a,onSelect:n,foregroundColor:s="#ffffff",backgroundColor:l="#000000"}){let i=(0,j.useCallback)(e=>{"Escape"===e.key&&t()},[t]),o=(0,j.useCallback)(e=>{n(e),t()},[n,t]),c=Math.ceil(r.length/16);return e?(0,w.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onKeyDown:i,children:[(0,w.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,w.jsxs)("div",{className:"relative w-full max-w-2xl max-h-[90vh] bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl flex flex-col",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-retro-grid/30",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("h2",{className:"text-lg font-medium text-white",children:"Character Map"}),(0,w.jsxs)("p",{className:"text-xs text-gray-400",children:[r.length," characters • Click to select • Hover for details"]})]}),(0,w.jsx)("button",{onClick:t,className:"p-1 text-gray-400 hover:text-white transition-colors",children:(0,w.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,w.jsxs)("div",{className:"flex p-4 pb-0 gap-1",children:[(0,w.jsx)("div",{className:"w-8"})," ",(0,w.jsx)("div",{className:"flex gap-0.5",children:Array.from({length:16}).map((e,t)=>(0,w.jsx)("div",{className:"w-[18px] text-center text-[8px] font-mono text-gray-500",children:t.toString(16).toUpperCase()},t))})]}),(0,w.jsx)("div",{className:"flex-1 overflow-auto p-4 pt-2",children:(0,w.jsx)("div",{className:"flex flex-col gap-0.5",children:Array.from({length:c}).map((e,t)=>{let n=16*t;return(0,w.jsxs)("div",{className:"flex gap-1",children:[(0,w.jsx)("div",{className:"w-8 flex items-center justify-end pr-1 text-[9px] font-mono text-gray-500",children:(16*t).toString(16).toUpperCase().padStart(2,"0")}),(0,w.jsx)("div",{className:"flex gap-0.5",children:Array.from({length:16}).map((e,t)=>{let i=n+t;return i>=r.length?(0,w.jsx)("div",{className:"w-[18px] h-[18px] bg-retro-dark/30 rounded"},t):(0,w.jsx)(nt,{character:r[i],index:i,isSelected:i===a,onClick:()=>o(i),foregroundColor:s,backgroundColor:l},t)})})]},t)})})}),(0,w.jsxs)("div",{className:"p-3 border-t border-retro-grid/30 flex items-center justify-between text-xs text-gray-400",children:[(0,w.jsxs)("div",{className:"flex items-center gap-4",children:[(0,w.jsxs)("span",{className:"flex items-center gap-1",children:[(0,w.jsx)("span",{className:"w-3 h-3 rounded bg-retro-cyan/30 ring-1 ring-retro-cyan"}),(0,w.jsx)("span",{children:"Selected"})]}),(0,w.jsxs)("span",{children:["Current: #",a," (0x",a.toString(16).toUpperCase().padStart(2,"0"),")",eP(a)&&(0,w.jsxs)("span",{className:"ml-1 text-retro-pink",children:["'",String.fromCharCode(a),"'"]})]})]}),(0,w.jsx)("span",{className:"font-mono",children:"Press M to toggle"})]})]})]}):null}e.s(["ScaleModal",()=>a7],48026),e.s(["GoToCharacterModal",()=>ne],64721),e.s(["AsciiMapModal",()=>nr],53444);let na=[{label:"Quick Fox",text:"The quick brown fox jumps over the lazy dog."},{label:"Hello World",text:"HELLO WORLD!\nHello World!\nhello world!"},{label:"Numbers",text:"0123456789\nABCDEF abcdef"},{label:"Symbols",text:"!@#$%^&*()_+-=[]{}\\|;':\",./<>?"},{label:"ASCII Art",text:"+------------------+\n|  RETRO COMPUTER  |\n+------------------+"}],nn=[{value:1,label:"1x"},{value:2,label:"2x"},{value:3,label:"3x"},{value:4,label:"4x"}];function ns({character:e,scale:t,foregroundColor:r,backgroundColor:a}){let n=(0,j.useRef)(null);return((0,j.useEffect)(()=>{let s=n.current;if(!s||!e)return;let l=s.getContext("2d");if(!l)return;let i=e.pixels[0]?.length||8,o=e.pixels.length;s.width=i*t,s.height=o*t,l.fillStyle=a,l.fillRect(0,0,s.width,s.height),l.fillStyle=r;for(let r=0;r<o;r++)for(let a=0;a<i;a++)e.pixels[r]?.[a]&&l.fillRect(a*t,r*t,t,t)},[e,t,r,a]),e)?(0,w.jsx)("canvas",{ref:n,className:"block"}):(0,w.jsx)("div",{style:{width:8*t,height:8*t,backgroundColor:a}})}function nl({isOpen:e,onClose:t,characters:r,config:a,colors:n}){let[s,l]=(0,j.useState)(na[0].text),[i,o]=(0,j.useState)(2),[c,d]=(0,j.useState)(n),u=(0,j.useRef)(null);(0,j.useEffect)(()=>{d(n)},[n]),(0,j.useEffect)(()=>{e&&u.current&&u.current.focus()},[e]),(0,j.useEffect)(()=>{if(!e)return;let r=e=>{"Escape"===e.key&&(e.preventDefault(),t())};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[e,t]);let h=(0,j.useMemo)(()=>s.split("\n").map(e=>{let t=[];for(let a of e){let e=a.charCodeAt(0);e>=0&&e<r.length?t.push(r[e]):t.push(r[32]||r[0]||null)}return t}),[s,r]);return e?(0,w.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,w.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,w.jsxs)("div",{className:"relative w-full max-w-4xl max-h-[90vh] bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl flex flex-col",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-retro-grid/30",children:[(0,w.jsx)("h2",{className:"text-lg font-medium text-white",children:"Text Preview"}),(0,w.jsx)("button",{onClick:t,className:"p-1 text-gray-400 hover:text-white transition-colors","aria-label":"Close",children:(0,w.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,w.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:(0,w.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Enter text to preview"}),(0,w.jsx)("textarea",{ref:u,value:s,onChange:e=>l(e.target.value),rows:6,className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white font-mono placeholder-gray-500 focus:outline-none focus:border-retro-cyan resize-none",placeholder:"Type your text here..."})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Sample texts"}),(0,w.jsx)("div",{className:"flex flex-wrap gap-2",children:na.map(e=>(0,w.jsx)("button",{onClick:()=>l(e.text),className:"px-2 py-1 text-xs bg-retro-dark border border-retro-grid/30 rounded text-gray-400 hover:text-retro-cyan hover:border-retro-cyan/50 transition-colors",children:e.label},e.label))})]}),(0,w.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Scale"}),(0,w.jsx)("div",{className:"flex gap-1",children:nn.map(e=>(0,w.jsx)("button",{onClick:()=>o(e.value),className:`px-3 py-1 text-xs rounded transition-colors ${i===e.value?"bg-retro-cyan/20 border border-retro-cyan text-retro-cyan":"bg-retro-dark border border-retro-grid/30 text-gray-400 hover:text-white"}`,children:e.label},e.value))})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Character Set"}),(0,w.jsxs)("div",{className:"text-xs text-gray-500",children:[a.width,"x",a.height," pixels, ",r.length," chars"]})]})]})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Preview"}),(0,w.jsx)("div",{className:"p-4 rounded border border-retro-grid/30 overflow-auto max-h-[400px]",style:{backgroundColor:c.background},children:0===h.length||1===h.length&&0===h[0].length?(0,w.jsx)("div",{className:"text-xs text-gray-500 italic",children:"Type something to see the preview..."}):(0,w.jsx)("div",{className:"space-y-0",children:h.map((e,t)=>(0,w.jsx)("div",{className:"flex flex-wrap",style:{minHeight:a.height*i},children:0===e.length?(0,w.jsx)("div",{style:{height:a.height*i,width:a.width*i}}):e.map((e,t)=>(0,w.jsx)(ns,{character:e,scale:i,foregroundColor:c.foreground,backgroundColor:c.background},t))},t))})}),(0,w.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:[s.length," characters, ",h.length," lines"]})]})]})}),(0,w.jsxs)("div",{className:"flex items-center justify-between gap-3 p-4 border-t border-retro-grid/30",children:[(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)("span",{className:"text-sm text-gray-400",children:"Colors:"}),(0,w.jsx)(eF,{colors:c,onColorsChange:d,dropUp:!0})]}),(0,w.jsxs)("div",{className:"flex items-center gap-3",children:[(0,w.jsx)("button",{onClick:()=>l(""),className:"px-4 py-2 text-sm text-gray-400 hover:text-white transition-colors",children:"Clear"}),(0,w.jsx)("button",{onClick:t,className:"px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors",children:"Close"})]})]})]})]}):null}e.s(["TextPreviewModal",()=>nl],1164)},59544,e=>{"use strict";var t=e.i(43476),r=e.i(71645);let a={pink:"btn-neon btn-neon-pink",cyan:"btn-neon btn-neon-cyan",violet:"btn-neon btn-neon-violet",ghost:"bg-transparent text-retro-cyan hover:text-retro-pink transition-colors"},n={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},s=(0,r.forwardRef)(({className:e="",variant:r="pink",size:s="md",children:l,href:i,...o},c)=>{let d=`inline-flex items-center justify-center font-ui font-semibold uppercase tracking-wider rounded transition-all duration-300 ${a[r]} ${n[s]} ${e}`;return i?(0,t.jsx)("a",{href:i,className:d,children:l}):(0,t.jsx)("button",{ref:c,className:d,...o,children:l})});s.displayName="Button",e.s(["Button",0,s])},46940,e=>{e.v(e.b(["static/chunks/06e3b2fb0ac1877f.js","static/chunks/turbopack-4a64e7ba3cb40909.js"]))},3813,16205,84227,62312,28827,56809,40979,26089,80795,75052,63427,91797,e=>{"use strict";e.i(89043),e.i(49738);var t=e.i(32267);e.i(29493),e.i(38794),e.i(4941),e.i(93949),e.i(25544),e.i(73581),e.i(60441),e.i(42187),e.i(87355),e.i(45835),e.i(95879),e.i(43237),e.i(99401),e.i(59160),e.i(16244),e.i(46628),e.i(87188),e.i(24111),e.i(38910),e.i(56859),e.i(33140),e.i(96935),e.i(88734),e.i(1978),e.i(4246),e.i(45497),e.i(78071),e.i(35052),e.i(55361),e.i(48026),e.i(64721),e.i(53444),e.i(1164);var r=e.i(43476),a=e.i(71645),n=e.i(59544);function s(){return{charWidth:8,charHeight:8,offsetX:0,offsetY:0,gapX:0,gapY:0,forceColumns:0,forceRows:0,threshold:128,invert:!1,maxCharacters:256}}async function l(e){return new Promise((t,r)=>{let a=new Image,n=URL.createObjectURL(e);a.onload=()=>{URL.revokeObjectURL(n);let e=document.createElement("canvas");e.width=a.width,e.height=a.height;let s=e.getContext("2d");s?(s.fillStyle="white",s.fillRect(0,0,e.width,e.height),s.drawImage(a,0,0),t(s.getImageData(0,0,e.width,e.height))):r(Error("Failed to create canvas context"))},a.onerror=()=>{URL.revokeObjectURL(n),r(Error("Failed to load image"))},a.src=n})}function i(e,t){let{charWidth:r,charHeight:a,offsetX:n,offsetY:s,gapX:l,gapY:i,forceColumns:o,forceRows:c,threshold:d,invert:u,maxCharacters:h=256}=t,x=e.width-n,m=e.height-s,f=r+l,p=a+i,g=o>0?o:Math.floor(x/f),b=c>0?c:Math.floor(m/p),y=[];for(let t=0;t<b&&y.length<h;t++)for(let l=0;l<g&&y.length<h;l++){let i=function(e,t,r,a,n,s,l){let i=[];for(let o=0;o<n;o++){let n=[];for(let i=0;i<a;i++){let a=t+i,c=r+o;if(a<0||a>=e.width||c<0||c>=e.height){n.push(!1);continue}let d=function(e,t,r){let a=(r*e.width+t)*4,n=e.data[a],s=e.data[a+1],l=e.data[a+2];return 0===e.data[a+3]?255:Math.round(.299*n+.587*s+.114*l)}(e,a,c)<s;l&&(d=!d),n.push(d)}i.push(n)}return{pixels:i}}(e,n+l*f,s+t*p,r,a,d,u);y.push(i)}return{characters:y,columns:g,rows:b,imageWidth:e.width,imageHeight:e.height}}function o(e,t){let r=[];for(let[a,n]of[[8,8],[8,16],[6,8],[8,10],[8,12],[16,16]]){let s=Math.floor(e/a),l=Math.floor(t/n);if(s>0&&l>0){let e=s*l;128===e||256===e||96===e||64===e||16===e?r.unshift({width:a,height:n,columns:s,rows:l}):e>=16&&e<=512&&r.push({width:a,height:n,columns:s,rows:l})}}if(0===r.length){let a=Math.floor(e/8),n=Math.floor(t/8);r.push({width:8,height:8,columns:a,rows:n})}return r}function c(e){return["image/png","image/jpeg","image/gif","image/webp"].includes(e.type)}function d(){return".png, .jpg, .jpeg, .gif, .webp"}function u(){return{charWidth:8,charHeight:8,startCode:32,endCode:126,fontSize:8,threshold:128,centerGlyphs:!0,baselineOffset:0}}async function h(t){let r;try{r=await e.A(42281)}catch{throw Error("Font import requires the opentype.js library. Please install it with: npm install opentype.js")}return new Promise((e,a)=>{let n=new FileReader;n.onload=t=>{try{let a=t.target?.result,n=r.parse(a);e(n)}catch(e){a(Error(`Failed to parse font: ${e}`))}},n.onerror=()=>a(Error("Failed to read font file")),n.readAsArrayBuffer(t)})}function x(e,t){let r=[];for(let a=0;a<t;a++)r.push(Array(e).fill(!1));return{pixels:r}}function m(e){return!!["font/ttf","font/otf","font/woff","font/woff2","application/x-font-ttf","application/x-font-otf","application/font-woff","application/font-woff2"].includes(e.type)||["ttf","otf","woff","woff2"].includes(e.name.toLowerCase().split(".").pop()||"")}function f(){return".ttf, .otf, .woff, .woff2"}function p(e,t){let r=[];for(let a=e;a<=t&&r.length<20;a++)a>=32&&a<=126?r.push(String.fromCharCode(a)):a<32?r.push("·"):r.push(String.fromCharCode(a));return t-e>=20&&r.push("..."),r}e.s(["detectCharacterDimensions",()=>o,"getDefaultImageImportOptions",()=>s,"getSupportedImageExtensions",()=>d,"isValidImageFile",()=>c,"loadImageData",()=>l,"parseImageToCharacters",()=>i],16205),e.i(7506);class g{worker=null;pendingRequests=new Map;workerSupported=null;isSupported(){if(null!==this.workerSupported)return this.workerSupported;try{this.workerSupported="undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas}catch{this.workerSupported=!1}return this.workerSupported}getWorker(){return this.worker||(this.worker=new Worker(e.r(46940),{type:"module",type:void 0}),this.worker.onmessage=e=>{let t=e.data,r=this.pendingRequests.get(t.id);if(r)switch(t.type){case"progress":r.onProgress?.(t.processed,t.total);break;case"result":this.pendingRequests.delete(t.id),r.resolve({characters:t.characters,fontFamily:t.fontFamily,importedCount:t.importedCount,missingCount:t.missingCount});break;case"error":this.pendingRequests.delete(t.id),r.reject(Error(t.error));break;case"cancelled":this.pendingRequests.delete(t.id),r.reject(Error("Cancelled"))}},this.worker.onerror=e=>{for(let[t,r]of this.pendingRequests)r.reject(Error(`Worker error: ${e.message}`)),this.pendingRequests.delete(t);this.worker=null,this.workerSupported=!1}),this.worker}parse(e,t,r){let a=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;return{promise:new Promise((n,s)=>{this.pendingRequests.set(a,{resolve:n,reject:s,onProgress:r});let l=this.getWorker(),i={type:"parse",id:a,fontData:e,options:{charWidth:t.charWidth,charHeight:t.charHeight,startCode:t.startCode,endCode:t.endCode,fontSize:t.fontSize,threshold:t.threshold,centerGlyphs:t.centerGlyphs,baselineOffset:t.baselineOffset}};l.postMessage(i,[e])}),cancel:()=>{let e=this.pendingRequests.get(a);e&&(this.pendingRequests.delete(a),this.worker?.postMessage({type:"cancel",id:a}),e.reject(Error("Cancelled")))}}}terminate(){this.worker&&(this.worker.terminate(),this.worker=null),this.pendingRequests.clear()}}let b=new g;async function y(e,t,r,a){let n=await h(e);if(r.aborted)throw Error("Cancelled");let s=n.names?.fontFamily?.en||n.names?.fullName?.en||"Unknown Font",l=[],i=0,o=0,c=t.endCode-t.startCode+1,d=e=>"undefined"!=typeof requestIdleCallback?requestIdleCallback(e,{timeout:50}):window.setTimeout(e,0);return new Promise((e,u)=>{let h,m=t.startCode,f=()=>{if(r.aborted)return void u(Error("Cancelled"));let p=Math.min(m+8,t.endCode+1);for(let e=m;e<p;e++){let r=function(e,t,r){let{charWidth:a,charHeight:n,fontSize:s,threshold:l,centerGlyphs:i,baselineOffset:o}=r,c=document.createElement("canvas");c.width=a,c.height=n;let d=c.getContext("2d");if(!d)return x(a,n);d.fillStyle="white",d.fillRect(0,0,a,n);let u=e.charToGlyph(String.fromCharCode(t));if(!u||0===u.index)return x(a,n);let h=s/e.unitsPerEm,m=u.advanceWidth*h,f=(e.ascender-e.descender)*h,p=0,g=n- -(e.descender*h*1)+o;if(i){p=(a-m)/2;let t=(n-f)/2;g=n- -(e.descender*h*1)-t+o}d.fillStyle="black";let b=u.getPath(p,g,s);b.fill="black",b.draw(d);let y=d.getImageData(0,0,a,n),v=[];for(let e=0;e<n;e++){let t=[];for(let r=0;r<a;r++){let n=(e*a+r)*4,s=.299*y.data[n]+.587*y.data[n+1]+.114*y.data[n+2];t.push(s<l)}v.push(t)}return{pixels:v}}(n,e,t);l.push(r),r.pixels.some(e=>e.some(e=>e))?i++:e>=33&&o++}let g=(m=p)-t.startCode;a?.(g,c),m<=t.endCode?h=d(f):e({characters:l,fontFamily:s,importedCount:i,missingCount:o})};h=d(f),r.addEventListener("abort",()=>{var e;e=h,"undefined"!=typeof cancelIdleCallback?cancelIdleCallback(e):clearTimeout(e),u(Error("Cancelled"))})})}class v{abortController=null;workerCancel=null;cancelled=!1;fileReader=null;async parse(e,t,r){if(this.cancelled=!1,b.isSupported())try{let a=await this.readFileAsArrayBuffer(e);if(this.cancelled)throw Error("Cancelled");let{promise:n,cancel:s}=b.parse(a,t,r);this.workerCancel=s;let l=await n;return this.workerCancel=null,l}catch(e){if(e instanceof Error&&"Cancelled"!==e.message)console.warn("Worker parsing failed, falling back to main thread:",e);else throw e}if(this.cancelled)throw Error("Cancelled");this.abortController=new AbortController;let a=await y(e,t,this.abortController.signal,r);return this.abortController=null,a}cancel(){this.cancelled=!0,this.fileReader&&(this.fileReader.abort(),this.fileReader=null),this.workerCancel&&(this.workerCancel(),this.workerCancel=null),this.abortController&&(this.abortController.abort(),this.abortController=null)}isCancelled(){return this.cancelled}isActive(){return null!==this.fileReader||null!==this.workerCancel||null!==this.abortController}readFileAsArrayBuffer(e){return new Promise((t,r)=>{if(this.cancelled)return void r(Error("Cancelled"));let a=new FileReader;this.fileReader=a,a.onload=e=>{this.fileReader=null,this.cancelled?r(Error("Cancelled")):t(e.target?.result)},a.onerror=()=>{this.fileReader=null,r(Error("Failed to read file"))},a.onabort=()=>{this.fileReader=null,r(Error("Cancelled"))},a.readAsArrayBuffer(e)})}}e.s(["FontParseController",()=>v,"getCharacterRangePreview",()=>p,"getDefaultFontImportOptions",()=>u,"getSupportedFontExtensions",()=>f,"isValidFontFile",()=>m],84227),e.i(47509);var w=e.i(33712),j=e.i(38152);function C(){return{charWidth:8,charHeight:8,padding:"right",bitDirection:"ltr"}}function k(e,t){let r=function(e){if(!e.trim())return{bytes:[],format:"hex",invalidCount:0,error:"No input provided"};let t=e.match(/0x[0-9a-fA-F]{1,2}|\$[0-9a-fA-F]{1,2}|0b[01]{1,8}|\b\d{1,3}\b/g);if(!t||0===t.length)return{bytes:[],format:"hex",invalidCount:0,error:"No valid byte values found in input"};let r=[],a=0,n={hex:0,decimal:0,binary:0,mixed:0};for(let e of t){var s;let t=function(e){let t;return isNaN(t=e.startsWith("0x")||e.startsWith("0X")?parseInt(e.slice(2),16):e.startsWith("$")?parseInt(e.slice(1),16):e.startsWith("0b")||e.startsWith("0B")?parseInt(e.slice(2),2):parseInt(e,10))||t<0||t>255?null:t}(e),l=(s=e).startsWith("0x")||s.startsWith("0X")||s.startsWith("$")?"hex":s.startsWith("0b")||s.startsWith("0B")?"binary":/^\d+$/.test(s)?"decimal":null;null!==t?(r.push(t),l&&n[l]++):a++}if(0===r.length)return{bytes:[],format:"hex",invalidCount:a,error:"No valid byte values found (all values were out of range 0-255)"};let l="hex",i=n.hex+n.decimal+n.binary;return n.hex>0&&0===n.decimal&&0===n.binary?l="hex":n.decimal>0&&0===n.hex&&0===n.binary?l="decimal":n.binary>0&&0===n.hex&&0===n.decimal?l="binary":i>0&&(l="mixed"),{bytes:r,format:l,invalidCount:a}}(e);if(r.error||0===r.bytes.length)return{bytes:new Uint8Array(0),characters:[],config:(0,w.createDefaultConfig)(),detectedFormat:r.format,invalidCount:r.invalidCount,error:r.error};let a=new Uint8Array(r.bytes),n={width:t.charWidth,height:t.charHeight,padding:t.padding,bitDirection:t.bitDirection},s=(0,j.parseCharacterRom)(a,n);return{bytes:a,characters:s,config:n,detectedFormat:r.format,invalidCount:r.invalidCount}}function N(e){if(e.error)return e.error;let t=`${e.bytes.length} bytes detected (${{hex:"hexadecimal",decimal:"decimal",binary:"binary",mixed:"mixed formats"}[e.detectedFormat]})`;return e.characters.length>0&&(t+=` → ${e.characters.length} character${1!==e.characters.length?"s":""}`),e.invalidCount>0&&(t+=` (${e.invalidCount} invalid value${1!==e.invalidCount?"s":""} skipped)`),t}e.s(["getDefaultTextImportOptions",()=>C,"getParseResultSummary",()=>N,"parseTextToCharacters",()=>k],62312);var S=e.i(92921);function M({isOpen:e,onClose:s,snapshots:l,loading:i,error:o,isAtCapacity:c,maxSnapshots:d,currentCharacters:u,currentConfig:h,foregroundColor:x,backgroundColor:m,onSave:f,onRestore:p,onDelete:g,onRename:b,onRestoreApply:y}){let[v,w]=(0,a.useState)(""),[j,C]=(0,a.useState)(!1),[k,N]=(0,a.useState)(null),[M,R]=(0,a.useState)(null),[L,E]=(0,a.useState)(null),[A,D]=(0,a.useState)(""),[I,z]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(e){let e=new Date().toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"});w(`Snapshot - ${e}`),N(null),R(null),E(null),z(null)}},[e]);let B=(0,a.useCallback)(async()=>{if(!v.trim())return;C(!0);let e=await f(v.trim());if(C(!1),e){let e=new Date().toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"});w(`Snapshot - ${e}`)}},[v,f]),O=(0,a.useCallback)(async e=>{if(k===e){N(null),R(null);return}N(e);let t=await p(e);t&&R(t)},[k,p]),F=(0,a.useCallback)(()=>{if(M&&k){let e=l.find(e=>e.id===k);y(M,e?.name),s()}},[M,k,l,y,s]),T=(0,a.useCallback)(async e=>{await g(e),k===e&&(N(null),R(null)),z(null)},[g,k]),$=(0,a.useCallback)(e=>{E(e.id),D(e.name)},[]),P=(0,a.useCallback)(async()=>{L&&A.trim()&&await b(L,A.trim()),E(null),D("")},[L,A,b]);return e?(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:s}),(0,r.jsxs)("div",{className:"relative w-full max-w-4xl max-h-[90vh] bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl flex flex-col overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-retro-grid/30",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-white",children:"Snapshots"}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-0.5",children:["Save and restore character set states (",l.length,"/",d,")"]})]}),(0,r.jsx)("button",{onClick:s,className:"p-1 text-gray-400 hover:text-white transition-colors",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-hidden flex flex-col md:flex-row",children:[(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 border-r border-retro-grid/30",children:[(0,r.jsxs)("div",{className:"mb-4 p-3 bg-retro-dark/50 rounded border border-retro-grid/30",children:[(0,r.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Create New Snapshot"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",value:v,onChange:e=>w(e.target.value),placeholder:"Snapshot name",className:"flex-1 px-2 py-1.5 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-retro-cyan",onKeyDown:e=>{"Enter"===e.key&&v.trim()&&!c&&B()}}),(0,r.jsx)(n.Button,{onClick:B,disabled:!v.trim()||j||c||!!o,variant:"cyan",size:"sm",children:j?"Saving...":"Save"})]}),c&&(0,r.jsx)("p",{className:"text-xs text-orange-400 mt-1",children:"Maximum snapshots reached. Delete one to save a new one."})]}),o?(0,r.jsxs)("div",{className:"p-4 bg-red-500/10 border border-red-500/30 rounded text-center",children:[(0,r.jsx)("svg",{className:"w-8 h-8 mx-auto mb-2 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,r.jsx)("p",{className:"text-sm text-red-400 mb-1",children:"Failed to load snapshots"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:o})]}):i?(0,r.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,r.jsx)("div",{className:"w-6 h-6 border-2 border-retro-cyan border-t-transparent rounded-full animate-spin"})}):0===l.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,r.jsx)("svg",{className:"w-12 h-12 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),(0,r.jsx)("p",{className:"text-sm",children:"No snapshots yet"}),(0,r.jsx)("p",{className:"text-xs mt-1",children:"Create one to save your progress"})]}):(0,r.jsx)("div",{className:"space-y-2",children:l.map(e=>(0,r.jsx)("div",{className:`p-3 rounded border transition-colors cursor-pointer ${k===e.id?"bg-retro-cyan/10 border-retro-cyan":"bg-retro-dark/30 border-retro-grid/30 hover:border-retro-grid/50"}`,onClick:()=>O(e.id),children:(0,r.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[L===e.id?(0,r.jsx)("input",{type:"text",value:A,onChange:e=>D(e.target.value),className:"w-full px-2 py-1 bg-retro-dark border border-retro-cyan rounded text-sm text-white focus:outline-none",autoFocus:!0,onClick:e=>e.stopPropagation(),onKeyDown:e=>{"Enter"===e.key?P():"Escape"===e.key&&E(null)},onBlur:P}):(0,r.jsx)("h3",{className:"text-sm text-white font-medium truncate",children:e.name}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,r.jsx)("span",{className:"text-xs text-gray-500",children:(0,S.formatTimestamp)(e.createdAt)}),(0,r.jsx)("span",{className:"text-xs text-gray-600",children:"|"}),(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:[e.characterCount," chars"]}),(0,r.jsx)("span",{className:"text-xs text-gray-600",children:"|"}),(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:[e.config.width,"x",e.config.height]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),$(e)},className:"p-1 text-gray-500 hover:text-white transition-colors",title:"Rename",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),I===e.id?(0,r.jsxs)("div",{className:"flex items-center gap-1",onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("button",{onClick:()=>T(e.id),className:"px-2 py-0.5 text-xs bg-red-500/20 border border-red-500 rounded text-red-400 hover:bg-red-500/30",children:"Delete"}),(0,r.jsx)("button",{onClick:()=>z(null),className:"px-2 py-0.5 text-xs border border-retro-grid/50 rounded text-gray-400 hover:text-white",children:"Cancel"})]}):(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),z(e.id)},className:"p-1 text-gray-500 hover:text-red-400 transition-colors",title:"Delete",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},e.id))})]}),(0,r.jsxs)("div",{className:"w-full md:w-72 p-4 bg-retro-dark/30 flex flex-col",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-400 mb-3",children:"Preview"}),k&&M?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex-1 overflow-auto bg-retro-dark rounded border border-retro-grid/30 p-2 mb-3",children:[(0,r.jsx)(t.CharacterPreviewGrid,{characters:M.slice(0,64),config:h,foregroundColor:x,backgroundColor:m,smallScale:2,maxCharacters:64}),M.length>64&&(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-2 text-center",children:["+",M.length-64," more characters"]})]}),(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsx)(n.Button,{onClick:F,variant:"cyan",size:"sm",className:"flex-1",children:"Restore This Snapshot"})}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"This will replace your current work"})]}):(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("svg",{className:"w-12 h-12 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),(0,r.jsx)("p",{className:"text-sm",children:"Select a snapshot to preview"})]})})]})]}),(0,r.jsx)("div",{className:"p-4 border-t border-retro-grid/30 bg-retro-dark/30",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-xs text-gray-400 mb-1",children:"Current State"}),(0,r.jsx)(t.CharacterPreviewGrid,{characters:u.slice(0,16),config:h,foregroundColor:x,backgroundColor:m,smallScale:2,maxCharacters:16})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:[(0,r.jsxs)("p",{children:[u.length," characters"]}),(0,r.jsxs)("p",{children:[h.width,"x",h.height," px"]})]})]})})]})]}):null}function R({history:e,currentIndex:t,onJump:n,canRedo:s=!1,totalEntries:l}){let i=(0,a.useRef)(null),[o,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(null),[h,x]=(0,a.useState)(0),m=l??e.length,f=m-1,p=(0,a.useCallback)(e=>0===f?50:e/f*100,[f]),g=(0,a.useCallback)(e=>{if(!i.current||0===f)return 0;let t=i.current.getBoundingClientRect(),r=Math.round((e-t.left)/t.width*f);return Math.max(0,Math.min(f,r))},[f]),b=(0,a.useCallback)(e=>{c(!0),n(g(e.clientX)),e.target.setPointerCapture(e.pointerId)},[g,n]),y=(0,a.useCallback)(e=>{if(o)n(g(e.clientX));else if(u(g(e.clientX)),i.current){let t=i.current.getBoundingClientRect();x(e.clientX-t.left)}},[o,g,n]),v=(0,a.useCallback)(()=>{c(!1)},[]),w=(0,a.useCallback)(()=>{u(null)},[]),j=(0,a.useCallback)(t=>t<0||t>=e.length?null:e[t]?.label||`State ${t}`,[e]),C=(0,a.useCallback)(e=>{"ArrowLeft"===e.key&&t>0?(e.preventDefault(),n(t-1)):"ArrowRight"===e.key&&t<f?(e.preventDefault(),n(t+1)):"Home"===e.key?(e.preventDefault(),n(0)):"End"===e.key&&(e.preventDefault(),n(f))},[t,f,n]);if(e.length<=1&&!s)return(0,r.jsx)("div",{className:"h-10 flex-shrink-0 bg-retro-navy/50 border-t border-retro-grid/30 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-[10px] text-gray-500",children:"No history yet"})});let k=p(t),N=null!==d?j(d):null,S=j(t);return(0,r.jsxs)("div",{className:"h-10 flex-shrink-0 bg-retro-navy/50 border-t border-retro-grid/30 flex items-center px-4 gap-3",children:[(0,r.jsxs)("div",{className:"text-[10px] text-gray-400 w-12 flex-shrink-0 font-mono",children:[t+1,"/",m]}),(0,r.jsxs)("div",{ref:i,className:"flex-1 h-6 relative cursor-pointer select-none",onPointerDown:b,onPointerMove:y,onPointerUp:v,onPointerLeave:w,onKeyDown:C,tabIndex:0,role:"slider","aria-valuemin":0,"aria-valuemax":f,"aria-valuenow":t,"aria-label":"History timeline",children:[(0,r.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 left-0 right-0 h-1 bg-retro-grid/30 rounded-full"}),(0,r.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 left-0 h-1 bg-retro-cyan/50 rounded-full transition-[width] duration-75",style:{width:`${k}%`}}),e.map((e,a)=>{let n=p(a),s=a===t,l=a<t,i=a>t;return(0,r.jsx)("div",{className:`absolute top-1/2 -translate-y-1/2 w-1 h-3 rounded-full transition-all duration-75 ${s?"bg-retro-cyan":l?"bg-retro-cyan/40":i?"bg-retro-pink/40":"bg-retro-grid/40"}`,style:{left:`${n}%`,transform:"translateX(-50%) translateY(-50%)"}},a)}),(0,r.jsx)("div",{className:`absolute top-1/2 -translate-y-1/2 w-4 h-4 rounded-full border-2 transition-all duration-75 ${o?"bg-retro-cyan border-white scale-110":"bg-retro-navy border-retro-cyan hover:bg-retro-cyan/20"}`,style:{left:`${k}%`,transform:"translateX(-50%) translateY(-50%)"}}),N&&!o&&(0,r.jsx)("div",{className:"absolute bottom-full mb-2 px-2 py-1 bg-retro-dark border border-retro-grid/50 rounded text-[10px] text-white whitespace-nowrap pointer-events-none z-10",style:{left:h,transform:"translateX(-50%)"},children:N})]}),(0,r.jsx)("div",{className:"text-[10px] text-gray-400 w-32 flex-shrink-0 truncate text-right",title:S||void 0,children:S||"—"})]})}function L(e,t,r,a){let n=(0,j.serializeCharacterRom)(r,a),s=(0,j.binaryToBase64)(n);return btoa(encodeURIComponent(JSON.stringify({v:1,n:e,d:t,c:[a.width,a.height,a.padding,a.bitDirection],b:s})).replace(/%([0-9A-F]{2})/g,(e,t)=>String.fromCharCode(parseInt(t,16))))}function E(e){try{let t=decodeURIComponent(atob(e).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join("")),r=JSON.parse(t);if(1!==r.v)throw Error("Unsupported share format version");let a={width:r.c[0],height:r.c[1],padding:r.c[2],bitDirection:r.c[3]},n=(0,j.base64ToBinary)(r.b),s=(0,j.parseCharacterRom)(n,a);return{name:r.n,description:r.d,characters:s,config:a}}catch(e){throw Error(`Failed to decode shared character set: ${e}`)}}function A(e){let t=`${window.location.origin}/tools/character-rom-editor/shared`;return`${t}#${e}`}function D(){let e=window.location.hash;return e?e.slice(1):null}function I(e){return e.length<=2e3?"ok":e.length<=8e3?"warning":"error"}function z(e,t,r){let a=Math.ceil(e*Math.ceil(t*r/8)*1.37)+100+100;return a<=2e3?{canShare:!0,estimatedLength:a,status:"ok",message:"Character set can be shared"}:a<=8e3?{canShare:!0,estimatedLength:a,status:"warning",message:"URL may be too long for some platforms. Consider reducing characters."}:{canShare:!1,estimatedLength:a,status:"error",message:`Character set is too large to share (${e} characters). Maximum shareable size depends on character dimensions.`}}function B({isOpen:e,onClose:t,name:s,description:l,characters:i,config:o}){let[c,d]=(0,a.useState)(null),[u,h]=(0,a.useState)(!1),[x,m]=(0,a.useState)(null),f=z(i.length,o.width,o.height);(0,a.useEffect)(()=>{if(!e||!f.canShare)return void d(null);try{let e=L(s,l,i,o),t=A(e);d(t),m(null)}catch(e){m(e instanceof Error?e.message:"Failed to generate share URL"),d(null)}},[e,s,l,i,o,f.canShare]);let p=(0,a.useCallback)(async()=>{if(c)try{await navigator.clipboard.writeText(c),h(!0),setTimeout(()=>h(!1),2e3)}catch{let e=document.createElement("textarea");e.value=c,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),h(!0),setTimeout(()=>h(!1),2e3)}},[c]);if(!e)return null;let g=c?I(c):"error";return(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,r.jsxs)("div",{className:"relative w-full max-w-lg bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-retro-grid/30",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-white",children:"Share Character Set"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:"Share via URL - no account needed"})]}),(0,r.jsx)("button",{onClick:t,className:"p-1 text-gray-400 hover:text-white transition-colors",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("div",{className:"mb-4 p-3 bg-retro-dark/50 rounded border border-retro-grid/30",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded bg-retro-cyan/10 flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-retro-cyan",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("h3",{className:"text-sm text-white font-medium truncate",children:s}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[i.length," characters | ",o.width,"x",o.height," px"]})]})]})}),!f.canShare&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/30 rounded",children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-red-400 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-red-400",children:f.message}),(0,r.jsx)("p",{className:"text-xs text-red-400/70 mt-1",children:"Try exporting to a file instead, or reduce the number of characters."})]})]})}),f.canShare&&"warning"===g&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-yellow-500/10 border border-yellow-500/30 rounded",children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-yellow-400 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-yellow-400",children:"Long URL Warning"}),(0,r.jsx)("p",{className:"text-xs text-yellow-400/70 mt-1",children:"This URL may not work on all platforms (email, social media). Consider exporting to a file for reliability."})]})]})}),x&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/30 rounded",children:(0,r.jsx)("p",{className:"text-sm text-red-400",children:x})}),c&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Share URL"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("div",{className:"flex-1 relative",children:[(0,r.jsx)("input",{type:"text",value:c,readOnly:!0,className:"w-full px-3 py-2 pr-16 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white font-mono truncate focus:outline-none focus:border-retro-cyan",onClick:e=>e.target.select()}),(0,r.jsxs)("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-500",children:[c.length," chars"]})]}),(0,r.jsx)(n.Button,{onClick:p,variant:"cyan",size:"sm",className:"whitespace-nowrap",children:u?"Copied!":"Copy"})]})]}),(0,r.jsxs)("div",{className:"mt-4 p-3 bg-retro-dark/30 rounded border border-retro-grid/20",children:[(0,r.jsx)("h4",{className:"text-xs font-medium text-gray-400 mb-2",children:"How sharing works"}),(0,r.jsxs)("ul",{className:"text-xs text-gray-500 space-y-1",children:[(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-retro-cyan",children:"1."}),"Your character set is encoded into the URL"]}),(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-retro-cyan",children:"2."}),"Anyone with the link can view and import it"]}),(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-retro-cyan",children:"3."}),"No data is stored on any server"]})]})]})]}),(0,r.jsx)("div",{className:"flex justify-end gap-2 p-4 border-t border-retro-grid/30 bg-retro-dark/30",children:(0,r.jsx)(n.Button,{onClick:t,variant:"ghost",size:"sm",children:"Close"})})]})]})}e.s(["SnapshotsModal",()=>M],28827),e.s(["HistorySlider",()=>R],56809),e.s(["canShare",()=>z,"createShareUrl",()=>A,"decodeCharacterSet",()=>E,"encodeCharacterSet",()=>L,"getHashFromUrl",()=>D,"getUrlLengthStatus",()=>I],40979),e.s(["ShareModal",()=>B],26089),e.i(7259);var O=e.i(66811);function F({isOpen:e,onClose:t,onSelectSet:n,excludeId:s}){let{characterSets:l,loading:i}=(0,O.useCharacterLibrary)(),[o,c]=(0,a.useState)("");(0,a.useEffect)(()=>{e||c("")},[e]);let d=(0,a.useMemo)(()=>l.filter(e=>{if(s&&e.metadata.id===s)return!1;if(o){let t=o.toLowerCase();return e.metadata.name.toLowerCase().includes(t)||e.metadata.description?.toLowerCase().includes(t)||e.metadata.manufacturer?.toLowerCase().includes(t)||e.metadata.system?.toLowerCase().includes(t)}return!0}),[l,s,o]),u=(0,a.useCallback)(e=>{try{let r=(0,j.deserializeCharacterSet)(e);n(r),t()}catch(e){console.error("Failed to deserialize character set:",e)}},[n,t]),h=(0,a.useCallback)(()=>{c(""),t()},[t]);return e?(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:h}),(0,r.jsxs)("div",{className:"relative w-full max-w-2xl max-h-[80vh] bg-retro-dark border border-retro-grid/50 rounded-xl shadow-2xl flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-retro-grid/30",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-white",children:"Select Overlay Character Set"}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-0.5",children:"Choose a character set to overlay for tracing"})]}),(0,r.jsx)("button",{onClick:h,className:"p-1 text-gray-400 hover:text-white transition-colors","aria-label":"Close",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsx)("div",{className:"p-4 border-b border-retro-grid/30",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"text",value:o,onChange:e=>c(e.target.value),placeholder:"Search character sets...",className:"w-full px-4 py-2 pl-10 bg-retro-navy/50 border border-retro-grid/50 rounded-lg text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:border-retro-cyan/50",autoFocus:!0}),(0,r.jsx)("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),(0,r.jsx)("div",{className:"flex-1 overflow-auto p-4",children:i?(0,r.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,r.jsx)("div",{className:"w-6 h-6 border-2 border-retro-cyan border-t-transparent rounded-full animate-spin"})}):0===d.length?(0,r.jsx)("div",{className:"text-center py-8 text-gray-500",children:o?"No character sets match your search":"No character sets available"}):(0,r.jsx)("div",{className:"grid gap-2",children:d.map(e=>(0,r.jsx)(T,{characterSet:e,onSelect:()=>u(e)},e.metadata.id))})})]})]}):null}function T({characterSet:e,onSelect:t}){let a=e.metadata,n=e.config,s=Math.ceil(n.width/8)*n.height,l=e.binaryData?Math.ceil(3*e.binaryData.length/4):0,i=s>0?Math.floor(l/s):0;return(0,r.jsxs)("button",{onClick:t,className:"w-full flex items-center gap-3 p-3 rounded-lg border border-retro-grid/30 hover:border-retro-amber/50 hover:bg-retro-amber/5 text-left transition-colors",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-black/50 rounded flex-shrink-0 flex items-center justify-center",children:(0,r.jsxs)("span",{className:"text-xs text-gray-400 font-mono",children:[n.width,"x",n.height]})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-sm text-white truncate",children:a.name}),a.isBuiltIn&&(0,r.jsx)("span",{className:"px-1.5 py-0.5 text-[10px] bg-retro-purple/30 text-retro-pink rounded",children:"Built-in"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-0.5 text-xs text-gray-500",children:[(0,r.jsxs)("span",{children:[i," chars"]}),a.manufacturer&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:"·"}),(0,r.jsx)("span",{className:"truncate",children:a.manufacturer})]}),a.system&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:"·"}),(0,r.jsx)("span",{className:"truncate",children:a.system})]}),a.chip&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:"·"}),(0,r.jsx)("span",{className:"truncate",children:a.chip})]})]})]}),(0,r.jsx)("svg",{className:"w-5 h-5 text-retro-amber/50 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}function $({x:e,y:t,items:n,onClose:s}){let l=(0,a.useRef)(null);(0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&s()},t=e=>{l.current&&!l.current.contains(e.target)&&s()};return document.addEventListener("keydown",e),document.addEventListener("mousedown",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("mousedown",t)}},[s]),(0,a.useEffect)(()=>{if(!l.current)return;let e=l.current.getBoundingClientRect(),t=window.innerWidth,r=window.innerHeight;e.right>t-8&&(l.current.style.left=`${t-e.width-8}px`),e.bottom>r-8&&(l.current.style.top=`${r-e.height-8}px`)},[e,t]);let i=(0,a.useCallback)(e=>{e.disabled||(e.onClick(),s())},[s]);return(0,r.jsx)("div",{ref:l,className:"fixed z-[100] min-w-[160px] py-1 bg-retro-navy/95 backdrop-blur-sm border border-retro-grid/50 rounded-lg shadow-xl",style:{left:e,top:t},children:n.map((e,t)=>e.divider?(0,r.jsx)("div",{className:"h-px bg-retro-grid/30 my-1"},t):(0,r.jsxs)("button",{onClick:()=>i(e),disabled:e.disabled,className:`
              w-full px-3 py-1.5 text-left text-sm flex items-center justify-between gap-4
              transition-colors
              ${e.disabled?"text-gray-600 cursor-not-allowed":e.danger?"text-red-400 hover:bg-red-500/20":"text-gray-200 hover:bg-retro-cyan/20 hover:text-retro-cyan"}
            `,children:[(0,r.jsx)("span",{children:e.label}),e.shortcut&&(0,r.jsx)("span",{className:"text-[10px] text-gray-500 font-mono",children:e.shortcut})]},t))})}function P(){let[e,t]=(0,a.useState)(null);return{contextMenu:e,showContextMenu:(0,a.useCallback)((e,r,a)=>{t({x:e,y:r,index:a})},[]),hideContextMenu:(0,a.useCallback)(()=>{t(null)},[])}}function W({currentStep:e,totalSteps:t,labels:a}){return(0,r.jsx)("div",{className:"flex items-center justify-center gap-2 mb-8",children:Array.from({length:t},(n,s)=>{let l=s+1,i=l===e,o=l<e;return(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:`
                flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium
                transition-colors
                ${i?"bg-retro-cyan text-retro-dark":o?"bg-retro-cyan/30 text-retro-cyan":"bg-retro-grid/30 text-gray-500"}
              `,children:o?(0,r.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})}):l}),(0,r.jsx)("span",{className:`
                ml-2 text-sm hidden sm:inline
                ${i?"text-retro-cyan":o?"text-gray-400":"text-gray-500"}
              `,children:a[s]}),l<t&&(0,r.jsx)("div",{className:`
                  w-8 sm:w-12 h-0.5 mx-2 sm:mx-4
                  ${o?"bg-retro-cyan/50":"bg-retro-grid/30"}
                `})]},l)})})}e.s(["OverlaySearchModal",()=>F],80795),e.s(["CharacterContextMenu",()=>$,"useContextMenu",()=>P],75052),e.s(["ImportStepIndicator",()=>W],63427);var _=e.i(37902);function U({isActive:e,currentStep:t,stepIndex:s,totalSteps:l,isFirstStep:i,isLastStep:o,onNext:c,onPrev:d,onSkip:u}){let h=(0,a.useCallback)(e=>{"Escape"===e.key?u():"ArrowRight"===e.key||"Enter"===e.key?c():"ArrowLeft"===e.key&&d()},[c,d,u]);return e&&t?(0,r.jsxs)("div",{onKeyDown:h,tabIndex:0,className:"jsx-9adf730429c9eab6 fixed inset-0 z-[100] flex items-center justify-center p-4",children:[(0,r.jsx)("div",{onClick:u,className:"jsx-9adf730429c9eab6 absolute inset-0 bg-black/80 backdrop-blur-sm"}),(0,r.jsxs)("div",{className:"jsx-9adf730429c9eab6 relative w-full max-w-md bg-retro-navy border border-retro-cyan/50 rounded-lg shadow-2xl overflow-hidden animate-fade-in",children:[(0,r.jsx)("div",{className:"jsx-9adf730429c9eab6 flex gap-1 p-2 bg-retro-dark/30",children:Array.from({length:l}).map((e,t)=>(0,r.jsx)("div",{className:`jsx-9adf730429c9eab6 flex-1 h-1 rounded-full transition-colors ${t<=s?"bg-retro-cyan":"bg-retro-grid"}`},t))}),(0,r.jsxs)("div",{className:"jsx-9adf730429c9eab6 p-6",children:[(0,r.jsxs)("div",{className:"jsx-9adf730429c9eab6 flex items-center justify-between mb-4",children:[(0,r.jsxs)("span",{className:"jsx-9adf730429c9eab6 text-xs text-retro-cyan font-medium uppercase tracking-wide",children:["Step ",s+1," of ",l]}),(0,r.jsx)("button",{onClick:u,className:"jsx-9adf730429c9eab6 text-xs text-gray-500 hover:text-white transition-colors",children:"Skip tour"})]}),(0,r.jsx)("h2",{className:"jsx-9adf730429c9eab6 text-xl font-medium text-white mb-3",children:t.title}),(0,r.jsx)("p",{className:"jsx-9adf730429c9eab6 text-gray-300 leading-relaxed",children:t.description}),(0,r.jsxs)("div",{className:"jsx-9adf730429c9eab6 flex justify-center my-6",children:[0===s&&(0,r.jsx)("div",{className:"jsx-9adf730429c9eab6 w-20 h-20 rounded-full bg-retro-cyan/10 border border-retro-cyan/30 flex items-center justify-center",children:(0,r.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-9adf730429c9eab6 w-10 h-10 text-retro-cyan",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z",className:"jsx-9adf730429c9eab6"})})}),1===s&&(0,r.jsx)("div",{className:"jsx-9adf730429c9eab6 w-20 h-20 rounded-full bg-retro-pink/10 border border-retro-pink/30 flex items-center justify-center",children:(0,r.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-9adf730429c9eab6 w-10 h-10 text-retro-pink",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10",className:"jsx-9adf730429c9eab6"})})}),2===s&&(0,r.jsx)("div",{className:"jsx-9adf730429c9eab6 w-20 h-20 rounded-full bg-retro-violet/10 border border-retro-violet/30 flex items-center justify-center",children:(0,r.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-9adf730429c9eab6 w-10 h-10 text-retro-violet",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12",className:"jsx-9adf730429c9eab6"})})}),3===s&&(0,r.jsx)("div",{className:"jsx-9adf730429c9eab6 w-20 h-20 rounded-full bg-green-500/10 border border-green-500/30 flex items-center justify-center",children:(0,r.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-9adf730429c9eab6 w-10 h-10 text-green-400",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z",className:"jsx-9adf730429c9eab6"})})}),4===s&&(0,r.jsx)("div",{className:"jsx-9adf730429c9eab6 w-20 h-20 rounded-full bg-orange-500/10 border border-orange-500/30 flex items-center justify-center",children:(0,r.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-9adf730429c9eab6 w-10 h-10 text-orange-400",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15",className:"jsx-9adf730429c9eab6"})})}),5===s&&(0,r.jsx)("div",{className:"jsx-9adf730429c9eab6 w-20 h-20 rounded-full bg-blue-500/10 border border-blue-500/30 flex items-center justify-center",children:(0,r.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-9adf730429c9eab6 w-10 h-10 text-blue-400",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4",className:"jsx-9adf730429c9eab6"})})}),6===s&&(0,r.jsx)("div",{className:"jsx-9adf730429c9eab6 w-20 h-20 rounded-full bg-purple-500/10 border border-purple-500/30 flex items-center justify-center",children:(0,r.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-9adf730429c9eab6 w-10 h-10 text-purple-400",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z",className:"jsx-9adf730429c9eab6"})})}),7===s&&(0,r.jsx)("div",{className:"jsx-9adf730429c9eab6 w-20 h-20 rounded-full bg-retro-cyan/10 border border-retro-cyan/30 flex items-center justify-center",children:(0,r.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-9adf730429c9eab6 w-10 h-10 text-retro-cyan",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 13l4 4L19 7",className:"jsx-9adf730429c9eab6"})})})]})]}),(0,r.jsxs)("div",{className:"jsx-9adf730429c9eab6 flex items-center justify-between p-4 border-t border-retro-grid/30 bg-retro-dark/30",children:[(0,r.jsx)(n.Button,{onClick:d,disabled:i,variant:"ghost",size:"sm",children:"Previous"}),(0,r.jsx)(n.Button,{onClick:c,variant:"cyan",size:"sm",children:o?"Get Started":"Next"})]})]}),(0,r.jsx)(_.default,{id:"9adf730429c9eab6",children:"@keyframes fade-in{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.animate-fade-in.jsx-9adf730429c9eab6{animation:.2s ease-out fade-in}"})]}):null}e.s(["OnboardingTour",()=>U],91797),e.s([],3813)}]);