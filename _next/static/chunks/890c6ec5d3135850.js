(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,a)=>{t.exports=e.r(76562)},59544,e=>{"use strict";var t=e.i(43476),a=e.i(71645);let r={pink:"btn-neon btn-neon-pink",cyan:"btn-neon btn-neon-cyan",violet:"btn-neon btn-neon-violet",ghost:"bg-transparent text-retro-cyan hover:text-retro-pink transition-colors"},n={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},i=(0,a.forwardRef)(({className:e="",variant:a="pink",size:i="md",children:l,href:o,...s},c)=>{let u=`inline-flex items-center justify-center font-ui font-semibold uppercase tracking-wider rounded transition-all duration-300 ${r[a]} ${n[i]} ${e}`;return o?(0,t.jsx)("a",{href:o,className:u,children:l}):(0,t.jsx)("button",{ref:c,className:u,...s,children:l})});i.displayName="Button",e.s(["Button",0,i])},20446,e=>{"use strict";var t=e.i(43476),a=e.i(71645);function r({pixels:e,scale:r=1,showGrid:n=!1,gridColor:i="#333333",gridThickness:l=1,foregroundColor:o="#ffffff",backgroundColor:s="#000000",onPixelClick:c,onPixelDrag:u,onDragEnd:d,onPixelHover:f,onPixelLeave:h,className:m="",interactive:g=!0,mixedPixels:E,mixedColor:y="#666666"}){let A=(0,a.useRef)(null),[w,R]=(0,a.useState)(!1),b=(0,a.useRef)(null),C=e.length,p=e[0]?.length||0,S=n?l:0,_=p*r+(n?(p+1)*l:0),T=C*r+(n?(C+1)*l:0);(0,a.useEffect)(()=>{let t=A.current;if(!t)return;let a=t.getContext("2d");if(a){a.fillStyle=n?i:s,a.fillRect(0,0,_,T);for(let t=0;t<C;t++)for(let i=0;i<p;i++){let c=n?i*(r+l)+l:i*r,u=n?t*(r+l)+l:t*r,d=`${t},${i}`,f=E?.has(d),h=e[t]?.[i]||!1;if(f){let e=Math.floor(r/2);a.fillStyle=o,a.fillRect(c,u,e,e),a.fillRect(c+e,u+e,r-e,r-e),a.fillStyle=s,a.fillRect(c+e,u,r-e,e),a.fillRect(c,u+e,e,r-e)}else a.fillStyle=h?o:s,a.fillRect(c,u,r,r)}}},[e,r,n,i,l,o,s,_,T,p,C,E,y]);let v=(0,a.useCallback)(e=>{let t,a,i=A.current;if(!i)return null;let o=i.getBoundingClientRect();if("touches"in e){if(0===e.touches.length)return null;t=e.touches[0].clientX,a=e.touches[0].clientY}else t=e.clientX,a=e.clientY;let s=t-o.left,c=a-o.top,u=i.width/o.width,d=i.height/o.height,f=r+(n?l:0),h=Math.floor((s*u-S)/f),m=Math.floor((c*d-S)/f);return m>=0&&m<C&&h>=0&&h<p?{row:m,col:h}:null},[r,n,l,S,C,p]),O=(0,a.useCallback)(e=>{if(!g)return;2===e.button&&e.preventDefault();let t=v(e);t&&c&&(c(t.row,t.col,2===e.button),b.current=t,R(!0))},[g,v,c]),I=(0,a.useCallback)(e=>{g&&e.preventDefault()},[g]),k=(0,a.useCallback)(e=>{if(!g)return;let t=v(e);t&&f&&f(t.row,t.col),w&&u&&t&&(!b.current||b.current.row!==t.row||b.current.col!==t.col)&&(u(t.row,t.col),b.current=t)},[g,w,v,u,f]),x=(0,a.useCallback)(()=>{w&&(R(!1),b.current=null,d?.())},[w,d]),D=(0,a.useCallback)(()=>{w&&(R(!1),b.current=null,d?.()),h?.()},[w,d,h]),M=(0,a.useRef)(g),L=(0,a.useRef)(c),P=(0,a.useRef)(u),N=(0,a.useRef)(d),B=(0,a.useRef)(w);return(0,a.useEffect)(()=>{M.current=g},[g]),(0,a.useEffect)(()=>{L.current=c},[c]),(0,a.useEffect)(()=>{P.current=u},[u]),(0,a.useEffect)(()=>{N.current=d},[d]),(0,a.useEffect)(()=>{B.current=w},[w]),(0,a.useEffect)(()=>{let e=A.current;if(!e)return;let t=t=>{if(0===t.touches.length)return null;let a=e.getBoundingClientRect(),i=t.touches[0].clientX,o=t.touches[0].clientY,s=i-a.left,c=o-a.top,u=e.width/a.width,d=e.height/a.height,f=r+(n?l:0),h=Math.floor((s*u-S)/f),m=Math.floor((c*d-S)/f);return m>=0&&m<C&&h>=0&&h<p?{row:m,col:h}:null},a=e=>{if(!M.current)return;e.preventDefault();let a=t(e);a&&L.current&&(L.current(a.row,a.col),b.current=a,R(!0))},i=e=>{if(!M.current||!B.current||!P.current)return;e.preventDefault();let a=t(e);a&&(!b.current||b.current.row!==a.row||b.current.col!==a.col)&&(P.current(a.row,a.col),b.current=a)},o=()=>{B.current&&(R(!1),b.current=null,N.current?.())};return e.addEventListener("touchstart",a,{passive:!1}),e.addEventListener("touchmove",i,{passive:!1}),e.addEventListener("touchend",o),()=>{e.removeEventListener("touchstart",a),e.removeEventListener("touchmove",i),e.removeEventListener("touchend",o)}},[r,n,l,S,C,p]),(0,t.jsx)("canvas",{ref:A,width:_,height:T,className:`${g?"cursor-crosshair":""} ${m}`,style:{imageRendering:"pixelated",touchAction:"none"},onMouseDown:O,onMouseMove:k,onMouseUp:x,onMouseLeave:D,onContextMenu:I})}e.s(["PixelGrid",()=>r])},33712,e=>{"use strict";function t(e){return Math.ceil(e/8)}function a(e){return t(e.width)*e.height}function r(e){let t=e.binaryData,r=0;t.endsWith("==")?r=2:t.endsWith("=")&&(r=1);let n=3*t.length/4-r,i=a(e.config);return i>0?Math.floor(n/i):0}function n(e,t){let a=[];for(let r=0;r<t;r++)a.push(Array(e).fill(!1));return{pixels:a}}function i(e){return{pixels:e.pixels.map(e=>[...e])}}function l(){return{width:8,height:8,padding:"right",bitDirection:"ltr"}}function o(){return crypto.randomUUID()}e.s(["bytesPerCharacter",()=>a,"bytesPerLine",()=>t,"cloneCharacter",()=>i,"createDefaultConfig",()=>l,"createEmptyCharacter",()=>n,"generateId",()=>o,"getCharacterCount",()=>r])},94136,e=>{"use strict";var t=e.i(33712);function a(e,a){let{width:r,height:n,padding:i,bitDirection:l}=a,o=(0,t.bytesPerLine)(r),s=new Uint8Array(n*o);for(let t=0;t<n;t++){let a=8*o,n=a-r,c=Array(a).fill(!1);if("left"===i)for(let a=0;a<r;a++)c[n+a]=e.pixels[t]?.[a]||!1;else for(let a=0;a<r;a++)c[a]=e.pixels[t]?.[a]||!1;for(let e=0;e<o;e++){let a=0;for(let t=0;t<8;t++)c[8*e+t]&&(a|=1<<("ltr"===l?7-t:t));s[t*o+e]=a}}return s}function r(e,a){let r=e instanceof Uint8Array?e:new Uint8Array(e),n=(0,t.bytesPerCharacter)(a),i=Math.floor(r.length/n),l=[];for(let e=0;e<i;e++){let i=r.slice(e*n,(e+1)*n);l.push(function(e,a){let{width:r,height:n,padding:i,bitDirection:l}=a,o=(0,t.bytesPerLine)(r),s=[];for(let t=0;t<n;t++){let a=[],n=t*o,c=[];for(let t=0;t<o;t++){let a=e[n+t]||0;for(let e=0;e<8;e++){let t=(a&1<<("ltr"===l?7-e:e))!=0;c.push(t)}}let u=8*o,d=u-r;if("left"===i)for(let e=d;e<u;e++)a.push(c[e]);else for(let e=0;e<r;e++)a.push(c[e]);s.push(a)}return{pixels:s}}(i,a))}return l}function n(e,r){let n=(0,t.bytesPerCharacter)(r),i=new Uint8Array(e.length*n);for(let t=0;t<e.length;t++){let l=a(e[t],r);i.set(l,t*n)}return i}function i(e){let t="";for(let a=0;a<e.length;a++)t+=String.fromCharCode(e[a]);return btoa(t)}function l(e){let t=atob(e),a=new Uint8Array(t.length);for(let e=0;e<t.length;e++)a[e]=t.charCodeAt(e);return a}function o(e){let t=n(e.characters,e.config);return{metadata:e.metadata,config:e.config,binaryData:i(t)}}function s(e){let t=r(l(e.binaryData),e.config);return{metadata:e.metadata,config:e.config,characters:t}}function c(e,t,a){return new Blob([n(e,{...t,...a}).buffer],{type:"application/octet-stream"})}function u(e,t){let a=URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)}e.s(["base64ToBinary",()=>l,"binaryToBase64",()=>i,"characterToBytes",()=>a,"createDownloadBlob",()=>c,"deserializeCharacterSet",()=>s,"downloadBlob",()=>u,"parseCharacterRom",()=>r,"serializeCharacterRom",()=>n,"serializeCharacterSet",()=>o])},60951,e=>{"use strict";e.s(["CHARACTER_EDITOR_SNAPSHOTS_STORE",0,"character-editor-snapshots","CHARACTER_EDITOR_STORAGE_KEY_AUTOSAVE",0,"retrostack-character-editor-autosave","CHARACTER_EDITOR_STORAGE_KEY_COLOR_PRESET",0,"retrostack-character-editor-color-preset","CHARACTER_EDITOR_STORAGE_KEY_CUSTOM_COLORS",0,"retrostack-character-editor-custom-colors","CHARACTER_EDITOR_STORAGE_KEY_FALLBACK",0,"retrostack-character-editor-sets","CHARACTER_EDITOR_STORAGE_KEY_ONBOARDING",0,"retrostack-character-editor-onboarding","CHARACTER_EDITOR_STORAGE_KEY_SORT_DIRECTION",0,"retrostack-character-editor-sort-direction","CHARACTER_EDITOR_STORAGE_KEY_SORT_FIELD",0,"retrostack-character-editor-sort-field","CHARACTER_EDITOR_STORE_NAME",0,"character-editor-sets","DB_NAME",0,"retrostack-web","DB_VERSION",0,6])},92832,e=>{"use strict";var t=e.i(33712),a=e.i(60951);function r(){return{getItem(e){try{return localStorage.getItem(e)}catch{return null}},setItem(e,t){try{localStorage.setItem(e,t)}catch(e){console.error("Failed to write to localStorage:",e)}},removeItem(e){try{localStorage.removeItem(e)}catch{}}}}let n=new class{db=null;initialized=!1;initPromise=null;kvStorage;constructor(e){this.kvStorage=e??r()}async initialize(){if(!this.initialized){if(this.initPromise)return this.initPromise;this.initPromise=this._initialize(),await this.initPromise,this.initialized=!0}}async _initialize(){return!function(){try{return!!window.indexedDB}catch{return!1}}()?void console.log("IndexedDB not available, using localStorage fallback"):new Promise(e=>{let t=indexedDB.open(a.DB_NAME,a.DB_VERSION);t.onerror=()=>{console.error("Failed to open IndexedDB, using localStorage fallback"),e()},t.onsuccess=()=>{this.db=t.result,e()},t.onupgradeneeded=e=>{let t=e.target.result,r=e.target.transaction,n=e.oldVersion;if(t.objectStoreNames.contains(a.CHARACTER_EDITOR_STORE_NAME)){if(n<2){let e=r.objectStore(a.CHARACTER_EDITOR_STORE_NAME);e.indexNames.contains("by-manufacturer")||e.createIndex("by-manufacturer","metadata.manufacturer",{unique:!1}),e.indexNames.contains("by-system")||e.createIndex("by-system","metadata.system",{unique:!1}),e.openCursor().onsuccess=e=>{let t=e.target.result;if(t){let e=t.value;e.metadata&&void 0===e.metadata.manufacturer&&(e.metadata.manufacturer=""),e.metadata&&void 0===e.metadata.system&&(e.metadata.system=""),t.update(e),t.continue()}}}if(n<3&&(r.objectStore(a.CHARACTER_EDITOR_STORE_NAME).openCursor().onsuccess=e=>{let t=e.target.result;if(t){let e=t.value;e.metadata&&void 0===e.metadata.isPinned&&(e.metadata.isPinned=!1),t.update(e),t.continue()}}),n<4){let e=r.objectStore(a.CHARACTER_EDITOR_STORE_NAME);e.indexNames.contains("by-locale")||e.createIndex("by-locale","metadata.locale",{unique:!1}),e.openCursor().onsuccess=e=>{let t=e.target.result;if(t){let e=t.value;e.metadata&&void 0===e.metadata.locale&&(e.metadata.locale=""),t.update(e),t.continue()}}}}else{let e=t.createObjectStore(a.CHARACTER_EDITOR_STORE_NAME,{keyPath:"metadata.id"});e.createIndex("by-name","metadata.name",{unique:!1}),e.createIndex("by-updated","metadata.updatedAt",{unique:!1}),e.createIndex("by-size","sizeKey",{unique:!1}),e.createIndex("by-manufacturer","metadata.manufacturer",{unique:!1}),e.createIndex("by-system","metadata.system",{unique:!1}),e.createIndex("by-locale","metadata.locale",{unique:!1})}if(!t.objectStoreNames.contains(a.CHARACTER_EDITOR_SNAPSHOTS_STORE)){let e=t.createObjectStore(a.CHARACTER_EDITOR_SNAPSHOTS_STORE,{keyPath:"id"});e.createIndex("by-character-set","characterSetId",{unique:!1}),e.createIndex("by-created","createdAt",{unique:!1})}}})}useFallback(){return null===this.db}fallbackGetAll(){try{let e=this.kvStorage.getItem(a.CHARACTER_EDITOR_STORAGE_KEY_FALLBACK);if(!e)return[];return JSON.parse(e).map(e=>({...e,metadata:{...e.metadata,manufacturer:e.metadata.manufacturer??"",system:e.metadata.system??"",locale:e.metadata.locale??"",isPinned:e.metadata.isPinned??!1}}))}catch{return[]}}fallbackSaveAll(e){try{this.kvStorage.setItem(a.CHARACTER_EDITOR_STORAGE_KEY_FALLBACK,JSON.stringify(e))}catch(e){throw console.error("Failed to save to fallback storage:",e),Error("Storage quota exceeded")}}async getAll(){return(await this.initialize(),this.useFallback())?this.fallbackGetAll():new Promise((e,t)=>{let r=this.db.transaction([a.CHARACTER_EDITOR_STORE_NAME],"readonly").objectStore(a.CHARACTER_EDITOR_STORE_NAME).getAll();r.onsuccess=()=>{let t=r.result;t.sort((e,t)=>{let a=+!!e.metadata.isPinned,r=+!!t.metadata.isPinned;return a!==r?r-a:t.metadata.updatedAt-e.metadata.updatedAt}),e(t)},r.onerror=()=>{t(Error("Failed to get character sets"))}})}async getById(e){return(await this.initialize(),this.useFallback())?this.fallbackGetAll().find(t=>t.metadata.id===e)||null:new Promise((t,r)=>{let n=this.db.transaction([a.CHARACTER_EDITOR_STORE_NAME],"readonly").objectStore(a.CHARACTER_EDITOR_STORE_NAME).get(e);n.onsuccess=()=>{t(n.result||null)},n.onerror=()=>{r(Error("Failed to get character set"))}})}async save(e){await this.initialize();let t={...e,sizeKey:`${e.config.width}x${e.config.height}`};if(this.useFallback()){let t=this.fallbackGetAll(),a=t.findIndex(t=>t.metadata.id===e.metadata.id);return a>=0?t[a]=e:t.push(e),this.fallbackSaveAll(t),e.metadata.id}return new Promise((r,n)=>{let i=this.db.transaction([a.CHARACTER_EDITOR_STORE_NAME],"readwrite").objectStore(a.CHARACTER_EDITOR_STORE_NAME).put(t);i.onsuccess=()=>{r(e.metadata.id)},i.onerror=()=>{n(Error("Failed to save character set"))}})}async saveAs(e,a){let r=(0,t.generateId)(),n=Date.now(),i={...e,metadata:{...e.metadata,id:r,name:a,createdAt:n,updatedAt:n,isBuiltIn:!1,source:"yourself"}};return await this.save(i),r}async togglePinned(e){await this.initialize();let t=await this.getById(e);if(!t)throw Error("Character set not found");let a=!t.metadata.isPinned,r={...t,metadata:{...t.metadata,isPinned:a}};return await this.save(r),a}async delete(e){if(await this.initialize(),this.useFallback()){let t=this.fallbackGetAll().filter(t=>t.metadata.id!==e);this.fallbackSaveAll(t);return}return new Promise((t,r)=>{let n=this.db.transaction([a.CHARACTER_EDITOR_STORE_NAME],"readwrite").objectStore(a.CHARACTER_EDITOR_STORE_NAME).delete(e);n.onsuccess=()=>{t()},n.onerror=()=>{r(Error("Failed to delete character set"))}})}async search(e){let t=await this.getAll(),a=e.toLowerCase();return t.filter(e=>e.metadata.name.toLowerCase().includes(a)||e.metadata.description.toLowerCase().includes(a)||e.metadata.source.toLowerCase().includes(a)||e.metadata.manufacturer.toLowerCase().includes(a)||e.metadata.system.toLowerCase().includes(a)||e.metadata.locale.toLowerCase().includes(a))}async filterBySize(e,t){return(await this.getAll()).filter(a=>(null===e||a.config.width===e)&&(null===t||a.config.height===t))}async filterByManufacturers(e){if(0===e.length)return this.getAll();let t=await this.getAll(),a=e.map(e=>e.toLowerCase());return t.filter(e=>a.includes(e.metadata.manufacturer.toLowerCase()))}async filterBySystems(e){if(0===e.length)return this.getAll();let t=await this.getAll(),a=e.map(e=>e.toLowerCase());return t.filter(e=>a.includes(e.metadata.system.toLowerCase()))}async getAvailableManufacturers(){let e=await this.getAll(),t=new Set;for(let a of e)a.metadata.manufacturer&&t.add(a.metadata.manufacturer);return Array.from(t).sort()}async getAvailableSystems(){let e=await this.getAll(),t=new Set;for(let a of e)a.metadata.system&&t.add(a.metadata.system);return Array.from(t).sort()}async getAvailableSizes(){let e=await this.getAll(),t=new Map;for(let a of e){let e=`${a.config.width}x${a.config.height}`;t.has(e)||t.set(e,{width:a.config.width,height:a.config.height})}return Array.from(t.values()).sort((e,t)=>e.width!==t.width?e.width-t.width:e.height-t.height)}async nameExists(e,t){return(await this.getAll()).some(a=>a.metadata.name.toLowerCase()===e.toLowerCase()&&a.metadata.id!==t)}async count(){return(await this.getAll()).length}async isEmpty(){return 0===(await this.getAll()).length}async clear(){return(await this.initialize(),this.useFallback())?void this.kvStorage.removeItem(a.CHARACTER_EDITOR_STORAGE_KEY_FALLBACK):new Promise((e,t)=>{let r=this.db.transaction([a.CHARACTER_EDITOR_STORE_NAME],"readwrite").objectStore(a.CHARACTER_EDITOR_STORE_NAME).clear();r.onsuccess=()=>{e()},r.onerror=()=>{t(Error("Failed to clear storage"))}})}};async function i(){await n.initialize();let e=n.db;return e&&!e.objectStoreNames.contains(a.CHARACTER_EDITOR_SNAPSHOTS_STORE)?(console.warn("Database missing snapshots store, triggering recreation..."),e.close(),await new Promise(e=>{let t=indexedDB.deleteDatabase(a.DB_NAME);t.onsuccess=()=>e(),t.onerror=()=>e(),t.onblocked=()=>e()}),n.db=null,n.initialized=!1,n.initPromise=null,await n.initialize(),n.db):e}e.s(["characterStorage",0,n,"createLocalStorageWrapper",()=>r,"getSharedDatabase",()=>i],92832)},66811,e=>{"use strict";var t=e.i(71645),a=e.i(33712),r=e.i(92832),n=e.i(94136),i=e.i(28167);let l=[];function o(){return l.filter(e=>e.enabled)}let s=i.default;function c(e){let t=Date.now();return{metadata:{id:e.id,name:e.name,description:e.description||`${e.system} character set`,source:e.source||"RetroStack",manufacturer:e.manufacturer,system:e.system,chip:e.chip,locale:e.locale,createdAt:t,updatedAt:t,isBuiltIn:!0},config:{width:e.width,height:e.height,padding:e.bitPadding??"right",bitDirection:e.bitDirection},binaryData:(0,n.binaryToBase64)(function(e){let t=new Uint8Array(e.reduce((e,t)=>e+t.length,0)),a=0;for(let r of e)for(let e of r)t[a++]=e;return t}(e.data))}}let u=new Map;async function d(e){if(u.has(e.url))return u.get(e.url)??null;try{let t=await fetch(e.url);if(!t.ok)return console.warn(`Failed to fetch external charsets from ${e.name}: ${t.status}`),u.set(e.url,null),null;let a=await t.json();if(!Array.isArray(a))return console.warn(`Invalid format from ${e.name}: expected array of character sets`),u.set(e.url,null),null;let r=a.filter(e=>"object"==typeof e&&null!==e&&"string"==typeof e.id&&"string"==typeof e.name&&"number"==typeof e.width&&"number"==typeof e.height&&Array.isArray(e.data));return u.set(e.url,r),r}catch(t){return console.warn(`Error fetching external charsets from ${e.name}:`,t),u.set(e.url,null),null}}async function f(){let e=o();if(0===e.length)return[];let t=await Promise.all(e.map(d)),a=[];for(let e of t)if(e)for(let t of e)a.push(t.id);return a}async function h(e){let t=o();if(0===t.length)return null;for(let a of(await Promise.all(t.map(d))))if(a){let t=a.find(t=>t.id===e);if(t)return c(t)}return null}function m(e){let i=(0,t.useMemo)(()=>e?.storage??r.characterStorage,[e?.storage]),[l,o]=(0,t.useState)([]),[u,d]=(0,t.useState)(!0),[m,g]=(0,t.useState)(null),[E,y]=(0,t.useState)([]),A=(0,t.useCallback)(async()=>{try{d(!0),g(null),await i.initialize();let e=await i.getAll(),t=new Set(e.map(e=>e.metadata.id)),a=s.map(e=>e.id).filter(e=>!t.has(e));if(a.length>0)for(let e of a){let t=function(e){let t=s.find(t=>t.id===e);return t?c(t):null}(e);t&&await i.save(t)}let r=(await f()).filter(e=>!t.has(e));if(r.length>0)for(let e of r){let t=await h(e);t&&await i.save(t)}let n=a.length>0||r.length>0?await i.getAll():e;o(n);let l=await i.getAvailableSizes();y(l)}catch(e){g(e instanceof Error?e.message:"Failed to load library")}finally{d(!1)}},[i]);(0,t.useEffect)(()=>{A()},[A]);let w=(0,t.useCallback)(async()=>{await A()},[A]),R=(0,t.useCallback)(async e=>{try{let t=await i.getById(e);if(!t)return null;return(0,n.deserializeCharacterSet)(t)}catch(e){return console.error("Failed to get character set:",e),null}},[i]),b=(0,t.useCallback)(async e=>{try{let t=(0,n.serializeCharacterSet)(e),a=await i.save(t);return await w(),a}catch(e){throw Error(e instanceof Error?e.message:"Failed to save character set")}},[i,w]),C=(0,t.useCallback)(async(e,t)=>{try{let r={...e,metadata:{...e.metadata,id:(0,a.generateId)(),name:t,createdAt:Date.now(),updatedAt:Date.now(),isBuiltIn:!1,source:"yourself"}},l=(0,n.serializeCharacterSet)(r),o=await i.save(l);return await w(),o}catch(e){throw Error(e instanceof Error?e.message:"Failed to save character set")}},[i,w]),p=(0,t.useCallback)(async(e,t)=>{try{let a=await i.getById(e);if(!a)throw Error("Character set not found");let r={...a,metadata:{...a.metadata,name:t,updatedAt:Date.now()}};await i.save(r),await w()}catch(e){throw Error(e instanceof Error?e.message:"Failed to rename character set")}},[i,w]),S=(0,t.useCallback)(async(e,t)=>{try{let a=await i.getById(e);if(!a)throw Error("Character set not found");let r={...a,metadata:{...a.metadata,...t,updatedAt:Date.now()}};await i.save(r),await w()}catch(e){throw Error(e instanceof Error?e.message:"Failed to update metadata")}},[i,w]),_=(0,t.useCallback)(async e=>{try{await i.delete(e),await w()}catch(e){throw Error(e instanceof Error?e.message:"Failed to delete character set")}},[i,w]),T=(0,t.useCallback)(async e=>{try{await i.togglePinned(e),await w()}catch(e){throw Error(e instanceof Error?e.message:"Failed to toggle pinned state")}},[i,w]),v=(0,t.useCallback)(async e=>e.trim()?i.search(e):l,[i,l]),O=(0,t.useCallback)(async(e,t)=>null===e&&null===t?l:i.filterBySize(e,t),[i,l]);return{characterSets:l,loading:u,error:m,refresh:w,getById:R,save:b,saveAs:C,rename:p,updateMetadata:S,deleteSet:_,togglePinned:T,search:v,filterBySize:O,availableSizes:E,nameExists:(0,t.useCallback)(async(e,t)=>i.nameExists(e,t),[i])}}e.s(["useCharacterLibrary",()=>m],66811)},7540,e=>{"use strict";var t=e.i(71645);function a(){let[e,a]=(0,t.useState)(!1),r=(0,t.useCallback)(()=>{a(!1)},[]),n=(0,t.useCallback)(()=>{a(!0)},[]),i=(0,t.useCallback)(()=>{a(e=>!e)},[]),l=function(e,a=!0){let r=(0,t.useRef)(null);return(0,t.useEffect)(()=>{if(!a)return;let t=t=>{r.current&&!r.current.contains(t.target)&&e()},n=t=>{"Escape"===t.key&&e()};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),document.addEventListener("keydown",n),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t),document.removeEventListener("keydown",n)}},[e,a]),r}(r,e);return{isOpen:e,ref:l,toggle:i,open:n,close:r}}e.s(["useDropdown",()=>a],7540)},19208,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(20446);function n({characters:e,config:n,maxCharacters:i=32,maxWidth:l=128,maxHeight:o=64,scale:s=1,foregroundColor:c="#ffffff",backgroundColor:u="#000000",className:d="",forceColumns:f,showCharacterBorders:h=!1,characterBorderColor:m="rgba(100, 100, 100, 0.5)"}){let{displayChars:g,columns:E,rows:y}=(0,a.useMemo)(()=>{let t=n.width*s,a=n.height*s;if(f){let t=Math.min(i,e.length),a=Math.ceil(t/f),r=Math.min(f*a,t);return{displayChars:e.slice(0,r),columns:f,rows:a}}let r=Math.floor(l/t),c=Math.floor(o/a),u=[64,32,16,8,4].find(e=>e<=r)||Math.min(r,4);u=Math.max(u,1);let d=Math.min(i,e.length),h=Math.ceil(d/u);if(h>c){let t=Math.ceil(d/(u=r)),a=Math.min(u*Math.min(t,c),d);return{displayChars:e.slice(0,a),columns:u,rows:Math.min(t,c)}}return{displayChars:e.slice(0,d),columns:u,rows:h}},[e,n,i,l,o,f,s]),A=(0,a.useMemo)(()=>{let{width:e,height:t}=n,a=E*e,r=Array.from({length:y*t},()=>Array(a).fill(!1));return g.forEach((a,n)=>{let i=n%E*e,l=Math.floor(n/E)*t;for(let n=0;n<t;n++)for(let t=0;t<e;t++)a.pixels[n]?.[t]&&(r[l+n][i+t]=!0)}),r},[g,n,E,y]),w=e.length-g.length,R=n.width*s,b=n.height*s;return(0,t.jsxs)("div",{className:`relative inline-block ${d}`,children:[(0,t.jsx)(r.PixelGrid,{pixels:A,scale:s,showGrid:!1,foregroundColor:c,backgroundColor:u,interactive:!1}),h&&E>0&&y>0&&(0,t.jsx)("div",{className:"absolute inset-0 pointer-events-none",style:{display:"grid",gridTemplateColumns:`repeat(${E}, ${R}px)`,gridTemplateRows:`repeat(${y}, ${b}px)`},children:g.map((e,a)=>(0,t.jsx)("div",{style:{border:`1px solid ${m}`,boxSizing:"border-box"}},a))}),w>0&&(0,t.jsxs)("div",{className:"absolute bottom-0 right-0 bg-retro-dark/90 text-[9px] text-gray-400 px-1 rounded-tl font-mono",children:["+",w]})]})}e.s(["CharacterPreview",()=>n])}]);